(function(e){function t(t){for(var i,o,n=t[0],r=t[1],d=t[2],c=0,p=[];c<n.length;c++)o=n[c],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&p.push(s[o][0]),s[o]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);u&&u(t);while(p.length)p.shift()();return l.push.apply(l,d||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],i=!0,o=1;o<a.length;o++){var r=a[o];0!==s[r]&&(i=!1)}i&&(l.splice(t--,1),e=n(n.s=a[0]))}return e}var i={},s={index:0},l=[];function o(e){return n.p+"js/"+({}[e]||e)+"."+{"chunk-747dda57":"549d675a"}[e]+".js"}function n(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.e=function(e){var t=[],a=s[e];if(0!==a)if(a)t.push(a[2]);else{var i=new Promise((function(t,i){a=s[e]=[t,i]}));t.push(a[2]=i);var l,r=document.createElement("script");r.charset="utf-8",r.timeout=120,n.nc&&r.setAttribute("nonce",n.nc),r.src=o(e);var d=new Error;l=function(t){r.onerror=r.onload=null,clearTimeout(c);var a=s[e];if(0!==a){if(a){var i=t&&("load"===t.type?"missing":t.type),l=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+i+": "+l+")",d.name="ChunkLoadError",d.type=i,d.request=l,a[1](d)}s[e]=void 0}};var c=setTimeout((function(){l({type:"timeout",target:r})}),12e4);r.onerror=r.onload=l,document.head.appendChild(r)}return Promise.all(t)},n.m=e,n.c=i,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n.oe=function(e){throw console.error(e),e};var r=window["webpackJsonp"]=window["webpackJsonp"]||[],d=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=d;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0404":function(e,t,a){},"0692":function(e,t,a){"use strict";a.r(t);a("14d9");var i=a("2b0e"),s=a("a925"),l=a("bc3a"),o=a.n(l),n=a("b2d6"),r=a.n(n),d=a("f0d9"),c=a.n(d),u=a("c87b"),p=a.n(u),m=a("a5e7"),_=a("69d3"),h=a("1954"),f=a("d7e7");i["default"].use(s["a"]);const b={en_US:{...r.a,..._["default"]},zh_CN:{...c.a,...m["default"]},zh_TW:{...p.a,...h["default"]}},g=new s["a"]({locale:localStorage.getItem("lang")||"zh",messages:b});g.setLocale=function(e){this.options={locale:e,messages:b}};const v=["en_US","zh_CN","zh_TW"];function y(e){return g.locale=e,o.a.defaults.headers.common["Accept-Language"]=e,document.querySelector("html").setAttribute("lang",e),localStorage.setItem("lang",e),f["a"].$emit("refresh_workflow"),e}i["default"].prototype.$setLang=function(e){if(g.locale!==e){if(!v.includes(e)){let t=e.replace("_","-");return a("2e98")("./"+t).then(t=>(g.mergeLocaleMessage(e,t.default),v.push(e),y(e)))}return Promise.resolve(y(e))}return Promise.resolve(e)},t["default"]=g},"0765":function(e,t,a){"use strict";a("b277")},"0ba4":function(e,t,a){"use strict";a("0feb")},"0c4f":function(e,t,a){},"0f9a":function(e,t,a){},"0feb":function(e,t,a){},1481:function(e,t,a){"use strict";a("60b9")},"18de":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",[t("el-button",{staticClass:"el-button el-button--default el-button--mini is-plain pointer",on:{click:e.back}},[t("i",{staticClass:"el-icon-back"}),e._v("    "+e._s(e.$t("back"))+" ")]),t("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(e.$t("Switch_Discovery_Rule")))]),t("div",{staticClass:"container-switch-discovery"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"sort-change":function(t){return e.sortChange(t)},"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(a){return t("el-table-column",{attrs:{prop:a.dbProp,label:e.$t(a.label),align:"left",sortable:a.sort}})})),t("el-table-column",{attrs:{prop:"syncStatus",label:e.$t("sync_status"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[-1!=a.row.syncStatus.indexOf("ING")?t("i",{staticClass:"el-icon-loading"}):e._e(),e._v(" "+e._s(e.$t(a.row.syncStatus))+" ")]}}])}),t("el-table-column",{attrs:{prop:"number",label:e.$t("founded_machine_number"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return["0"!=a.row.number?t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.showMachine(a.row)}}},[e._v(" "+e._s(a.row.number)+" ")]):e._e(),"0"==a.row.number?t("span",[e._v(e._s(a.row.number))]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"lastSyncTimestamp",label:e.$t("last_sync_timestamp"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.lastSyncTimestamp))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}}),t("RSButton",{attrs:{type:"sync",tip:e.$t("sync")},on:{click:function(t){return e.handleEdit(a.row,"sync")}}})]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_switch-discovery"):e.$t("add_switch-discovery"),visible:e.editDialogVisible,direction:"rtl",modal:!0,wrapperClosable:!1,appendToBody:!0,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"form",attrs:{model:e.editObj,rules:e.rules,"label-width":"50px","label-position":e.labelPosition}},[t("el-form-item",{attrs:{label:e.$t("name"),prop:"name"}},[t("el-input",{attrs:{autocomplete:"off",maxlength:"30"},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),t("el-form-item",{attrs:{label:e.$t("start_ip"),prop:"startIp"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.startIp,callback:function(t){e.$set(e.editObj,"startIp",t)},expression:"editObj.startIp"}})],1),t("el-form-item",{attrs:{label:e.$t("end_ip"),prop:"endIp"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.endIp,callback:function(t){e.$set(e.editObj,"endIp",t)},expression:"editObj.endIp"}})],1),t("el-form-item",{attrs:{label:e.$t("mask"),prop:"mask"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.mask,callback:function(t){e.$set(e.editObj,"mask",t)},expression:"editObj.mask"}})],1),t("el-form-item",{attrs:{label:e.$t("detect_params"),prop:"params"}},[t("el-switch",{model:{value:e.editObj.config,callback:function(t){e.$set(e.editObj,"config",t)},expression:"editObj.config"}},[e._v(e._s(e.$t("set_detect_params")))]),e.editObj.config?t("table",{staticClass:"test-protocol"},[t("tr",[t("td",[e._v(e._s(e.$t("protocol")))]),t("td",[e._v(e._s(e.$t("possible_params")))]),t("td",[t("RSButton",{attrs:{type:"add",tip:e.$t("add_protocol_param")},on:{click:e.addTestProtocol}})],1)]),e._l(e.editObj.credentialParam,(function(a,i){return t("tr",[t("td",[t("el-select",{model:{value:a.protocol,callback:function(t){e.$set(a,"protocol",t)},expression:"p.protocol"}},e._l(e.protocols,(function(a){return t("el-option",{attrs:{value:a.name,label:e.$t(a.name)}})})),1)],1),t("td",[t("el-form",{ref:"protocolForm",refInFor:!0,attrs:{rules:e.protocolRules,model:a}},e._l(e.findProtocol(a),(function(i){return a&&a.protocol?t("el-form-item",{attrs:{label:e.$t(i.label),prop:i.prop}},["password"==i.type?t("el-input",{attrs:{type:i.type,"show-password":""},model:{value:a[i.prop],callback:function(t){e.$set(a,i.prop,t)},expression:"p[param.prop]"}}):e._e(),"password"!=i.type?t("el-input",{attrs:{type:i.type},model:{value:a[i.prop],callback:function(t){e.$set(a,i.prop,t)},expression:"p[param.prop]"}}):e._e()],1):e._e()})),1)],1),t("td",{staticStyle:{"vertical-align":"center"}},[t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.delTestProtocol(i)}}})],1)])}))],2):e._e()],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)],1)},s=[],l=(a("14d9"),a("b35c")),o=a("30d1"),n=a("f395"),r=a("619f");let d=a("2ef0");var c={data(){return{websocket:null,protocols:[{name:"SNMP",params:[{type:"text",prop:"community",label:"community"},{type:"number",prop:"port",label:"port"}]}],activeName:"switch-discovery",rules:{name:[{validator:o["j"],trigger:"blur",vue:this}],startIp:[{validator:o["e"],trigger:"blur",vue:this}],endIp:[{validator:o["e"],trigger:"blur",vue:this}],mask:[{validator:o["f"],trigger:"blur",vue:this}]},protocolRules:{userName:[{validator:o["j"],trigger:"blur",vue:this}],pwd:[{validator:o["j"],trigger:"blur",vue:this}],community:[{validator:o["j"],trigger:"blur",vue:this}],port:[{validator:o["j"],trigger:"blur",vue:this}]},queryVO:{searchKey:null},query:{name:"",pageIndex:1,pageSize:10},tableData:[],loadingList:[],multipleSelection:[],delList:[],editVisible:!1,labelPosition:"top",pageTotal:0,idx:-1,id:-1,loading:!1,columns:[{label:"name",prop:"name",dbProp:"name",sort:!1},{label:"start_ip",prop:"start_ip",dbProp:"startIp",sort:!1},{label:"end_ip",prop:"end_ip",dbProp:"endIp",sort:!1},{label:"mask",prop:"mask",dbProp:"mask"}],editDialogVisible:!1,editType:"edit",editObj:{name:null},allOs:[],allOsVersion:[],allEndPoints:[],fileName:null}},computed:{action:function(){return"/switch-discovery/upload?fileName="+this.fileName}},components:{},mounted(){this.websocket||(this.websocket=new n["a"],this.websocket.openSocket("switch-discovery",this.notify),this.getData())},destroyed(){this.websocket&&this.websocket.close()},methods:{sortChange(e){e.order?this.queryVO.sort=Object(r["b"])(e.prop)+" "+e.order.replace("ending",""):delete this.queryVO.sort,this.getData()},notify(e){this.getData(),this.$notify({title:this.$t("server_message"),message:this.$t("scan_over")})},showMachine(e){e.number&&(this.$emit("queryByRuleId",e.id),this.back())},back(){this.$emit("back"),this.websocket&&this.websocket.close()},delTestProtocol(e){this.editObj.credentialParam.splice(e,1)},addTestProtocol(){this.editObj.credentialParam||(this.editObj.credentialParam=[]),this.editObj.credentialParam.push({protocol:"SNMP"})},findProtocol(e){return e.protocol?d.find(this.protocols,t=>t.name==e.protocol).params:[]},getData(){this.loadingList=!0,l["a"].post("/switch-discovery/list/"+this.query.pageIndex+"/"+this.query.pageSize,this.queryVO,e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},refreshChildData(){this.$refs.device.getData()},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},confirmEdit(){if(this.validateResult=!0,this.$refs.form.validate(e=>{e||(this.validateResult=!1)}),this.$refs.protocolForm&&this.$refs.protocolForm.forEach(e=>{e.validate(e=>{e||(this.validateResult=!1)})}),!this.validateResult)return void this.$message.error(this.$t("validate_error"));let e=JSON.parse(JSON.stringify(this.editObj));Object(r["a"])(e.mask)?(e.credentialParam=JSON.stringify(this.editObj.credentialParam),this.loading=!0,"edit"==this.editType?l["a"].put("/switch-discovery/update",e,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("edit_success")),this.getData(),this.loading=!1}):l["a"].post("/switch-discovery/add",e,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("add_success")),this.getData(),this.loading=!1})):this.$message.error(this.$t("netmask_validate_error"))},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=d.map(this.delList,e=>e.id);return e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{l["a"].post("/switch-discovery/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData()):this.$message.success(this.$t("delete_fail"))}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select_switch-discovery")+"!")},handleEdit(e,t){if("edit"==t)this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e)),this.editObj.credentialParam=this.editObj.credentialParam?JSON.parse(this.editObj.credentialParam):[],this.resetFields();else if("del"==t)this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{l["a"].delete("/switch-discovery/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})});else if("sync"==t)l["a"].post("/switch-discovery/sync",[e.id],e=>{this.$message.success(this.$t("opt_success")),this.getData()});else{this.editDialogVisible=!0,this.editType=t;let e=d.find(this.allEndPoints,e=>"main_endpoint"==e.type);this.resetFields(),this.editObj={endpointId:e?e.id:null,url:null,config:!0,credentialParam:[{protocol:"SNMP"}]}}},resetFields(){this.$refs.form&&this.$refs.form.resetFields()},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},u=c,p=(a("d069"),a("2877")),m=Object(p["a"])(u,i,s,!1,null,"1a13238b",null);t["a"]=m.exports},1954:function(e,t,a){"use strict";a.r(t),t["default"]={cancel:"取消",Networks:"網酪","hostname_must_not_have_invalid_word!":"hostname 命名不合法！",Configuration:"配置",fs_type:"分區格式",proc_socket:"處理器插槽",del:"刪除",Languages:"語言",cannt_be_null:"慘數不能為空",hostname:"HOSTNAME",ExecutionLog:"部署日誌",password:"密碼",add_network:"添加網酪",Endpoint:"Endpoint",controller_id:"控制器號","param_cannot_be_null!":"慘數不能為空！","delete_success!":"刪除成功",english:"英語",mem_mod_size:"內存容量",disk_detail:"磁盤詳情",ERROR:"失敗",edit_success:"編輯成功",nic_number:"網卡編號",pls_input_email:"請輸入郵箱",user_settable:"配置",edit:"編輯",edit_system_parameter:"編輯系統慘數",Images:"鏡像",Workflow:"工作流",delete_fail:"刪除失敗",batch_del:"批量刪除",size:"容量",en_US:"English",detail:"詳情",drive:"插槽號",param_value:"慘數值",role:"角色",user_name:"用戶名",bare_metal:"裸金屬",pls_input_vlan_id:"請輸入vlanId",add_outband:"添加帶外",add_workflow:"添加工作流",network_card:"網卡",endpoint:"代理節點",pls_select_bare_metal:"請選擇將執行工作流的裸金屬服務器",start_ip:"起始 IP",edit_execution_log:"編輯部署日誌",pls_input_start_ip:"請輸入開始ip",disabled:"否",sn:"序列號",close:"關閉",email:"郵箱",discovering:"發現中",brands:"支持的品牌",validate_error:"慘數校驗錯誤",SUCCESS:"成功",delete_success:"刪除成功",refresh:"刷新","origin-password":"原密碼",Run:"執行",confirm:"確定",discoveryed_devices:"已發現網酪設備",pls_input_user_name:"請輸入用護名",root_pwd:"ROOT 密碼",pls_select_workflow:"請選擇工作流",network_devices:"網卡ip設置",deploying:"部署中",raid_disk:"RAID磁盤",operation:"操作",vlan_id:"VlanId",pls_select_discovery:"請選擇發現規則",pls_select_image:"請選擇鏡像",obms:"帶外信息",sync_time:"同步時間",confirm_to_del:"確認刪除 ？","edit_discovery-devices":"編輯已發現設備",edit_discovery:"編輯發現規則",pls_input_password:"請輸入密碼",chinese:"中文",view:"查看",management_ip:"帶外 IP",proc_num_threads:"線程數",memory_detail:"內存詳情",onrack:"已上架",username_pwd_error_login_fail:"用護名/密碼錯誤",info:"信息",add:"添加",endIp:"結束 IP",image:"鏡像",create_time:"創建時間",vlanId:"VlanId",pls_select_:"請選擇",please_select:"請選擇",sync:"同步",Role:"角色",opt:"操作",pxe_enable:"是否開啟 PXE",success:"成功",name:"名稱",desc:"描述",memory:"內存",show:"顯示",description:"描述",cpu_detail:"CPU 詳情",pls_select:"請選擇",Control:"控制",mem_cpu_num:"內存 CPU 編號",SystemParameter:"系統慘數",GB:"GB",OBM:"帶外",change_pwd:"修改密碼",ip_invalid_format:"IP 格式錯誤",invalid_format:"格式錯誤",OverView:"概覽",param_check_error:"慘數校驗失敗！",mask:"子網掩碼",last_sync_timestamp:"上次同步時間",pls_input_os_version:"請輸入 OS 版本號","not_supported_brand!":"不支持品牌-",Info:"個人信息",input_key_search:"型號/序列號/IP",input_key_search_switch:"名稱/IP",add_endpoint:"添加節點",pxeboot:"PXE 重啟",edit_fail:"編輯失敗",proc_speed:"處理器頻率","Bare Metal Server":"裸金屬服務器",pls_select_network:"請選擇子網",os_vesion:"OS 版本",obm:"帶外管理",time:"時間",ip_addr:"IP 地址",gateway:"網關",username:"用護名",fanti:"繁體",pls_input_pwd:"請輸入密碼",edit_network:"編輯網酪",type:"類型",Image:"鏡像",tips:"提示",hostname_must_not_have_invalid_word:"hostname 不合法",output:"輸出",default_params:"默認慘數",logout:"退出",event_type:"事件類型",enable:"開啟",Network:"網酪",id:"ID",proc_num_cores:"處理器核心數",view_detail:"查看詳情",selected_workflows:"已選工作流",IP:"IP",ip:"IP",pls_input_phone:"請輸入手機號",add_execution_log:"添加部署日誌",Login:"登陸",add_system_parameter:"添加系統慘數",pls_select_node:"請選擇服務器",system:"系統",pls_select_obm:"請選擇帶外信息",phone:"手機號",pls_input_url:"請輸入 URL 或直接上傳 ISO 文件",reset:"重置",sync_status:"同步狀態",pls_input_username:"請輸入用護名",pwd:"密碼",Subnet:"DHCP 子網",add_success:"添加成功",view_execution_log:"查看部署日誌",status:"狀態",submitting:"提交中",poweron:"啟動",pls_select_username:"請選擇用護名","add_discovery-devices":"添加到已發現",edit_role:"編輯角色",mac:"mac地址",enabled:"是",capacity:"容量",pls_set_params:"請設置慘數",update_time:"更新時間",pls_fill_in_blanks:"請填空",pls_input_end_ip:"請輸入結束 IP",add_to_device:"添加到裸金屬",pls_input_param_value:"請輸入慘數值",set_workflow_param:"設置工作流慘數",poweroff:"關閉",edit_outband:"編輯帶外",pls_select_system_parameter:"請選擇系統慘數",os_version:"OS 版本",execution_log:"部署日誌",machine_model:"機器品牌/型號",machine_sn:"機器序列號",PENDING:"同步中","new-password":"新密碼",url:"URL",mem_mod_num:"內存插槽號",mem_mod_part_num:"內存型號",discovery:"發現",disable:"關閉",edit_endpoint:"編輯節點",raid_type:"RAID 類型","Execution Log":"部署日誌",powercycle:"電源循環",mem_mod_min_volt:"內存最低電壓",same_workflow_node:"同壹節點不可以同時執行多次同洋的工作流",CPU:"CPU",custom_partition:"自定義分區",pls_input_hostname:"請輸入 hostname",custom_raid:"自定義 RAID",opt_fail:"操作失敗",pls_input_netmask:"請輸入子網掩碼",view_url:"查看 URL",edit_image:"編輯鏡像",login_timeout:"登陸超時",end_ip:"結束 IP","confirm-password":"確認新密碼",machine_status:"機器狀態",mem_mod_frequency:"內存頻率",copy_success:"復制成功",param_config:"慘數配置",Resource:"資源",Discovery:"發現",cpu:"CPU",manufactor:"制造商",add_fail:"添加失敗",pls_select_password:"請選擇密碼",disk:"磁盤",network_card_mac:"網卡 MAC 地址",pls_input_params:"請輸入慘數",pls_input_name:"請輸入名稱","pls_select_discovery-devices":"請選擇已發現設備",dhcp_enable:"是否開啟 DHCP",injectable_name:"工作流模板",proc_name:"處理器型號",no_nessary_to_set:"無慘數設置",raid:"Raid 級別",startIp:"開始 IP",User:"用護",enclosure_id:"EnclosureId",deployed:"已部署",bmc_mac:"帶外 MAC",error:"錯誤",delete:"刪除",mem_mod_type:"內存類型",settable:"是否可設置參數",zh_TW:"繁體中文",add_image:"添加鏡像",netmask:"子網掩碼",param_key:"慘數 Key",ready:"就緒",add_to_selected_wf_list:"添加至待執行工作流",provisioning:"準備中",allocated:"已分配",friendly_name:"名稱",os:"OS",opt_success:"操作成功",nic_detail:"網卡詳情",endpointId:"節點 ID",mount_point:"掛載點",pls_select_endpoint:"請選擇節點","no_valid_image!":"沒有找到鏡像，請先上傳鏡像文件！",add_discovery:"添加發現規則",login_fail:"登六失敗",zh_CN:"简体中文",Machines:"裸金屬服務器",user:"用護",Wizard:"使用向導",edit_workflow:"編輯工作流",Plugin:"插件",FILL_OBMS:"補充 OBM 信息",PXE_BOOT_START:"PXE 啟動",PXE_BOOT_END:"PXE 啟動完畢",PXE_BOOT_CANCEL:"取消 PXE 啟動",POST_DISCOVERY_WORKFLOW_START:"下發發現工作流",POST_DISCOVERY_WORKFLOW_END:"發現工作流執行完畢",POST_DISCOVERY_WORKFLOW_CANCEL:"取消發現工作流",POST_OTHER_WORKFLOW_START:"下發通用工作流",POST_OTHER_WORKFLOW_END:"工作流執行完畢",POST_OTHER_WORKFLOW_CANCEL:"取消工作流",POST_OS_WORKFLOW_START:"下發安裝系統工作流",POST_OS_WORKFLOW_END:"安裝系統工作流執行完畢",POST_OS_WORKFLOW_CANCEL:"取消安裝系統工作流",device:"設備",START:"開始",TERMINATE:"用戶終止",END:"結束",SUBMIT:"提交",PROCESSING:"處理中",email_format_error:"郵箱格式錯誤",phone_format_error:"手機格式錯誤",admin:"管理員",i18n_mount_point_cant_be_null:"掛載點不能為空！",i18n_capacity_cant_be_null:"容量不能為空！",i18n_must_be_root_swap_boot:"必須有根，swap和/boot分區，並且所有分區最低容量不能小於1GB！",i18n_auto_or_number_0_or_1:"分區容量只能是數字或者auto，並且容量為auto的分區只能為0個或者1個!",i18n_must_be_auto_or_number:"分區容量必須是auto或數字！",i18n_swap_must:"swap分區格式必須是swap！",raidDisk:"raidDisk",i18n_file_type_cant_be_null:"文件類型不能為空！",i18n_all_greater_than_1_gb:"所有分區最低容量不能小於1GB！",i18n_mut_only_one:"必須有且僅有壹個根，swap和/boot分區！",only_iso_no_more_than_10g:"只能上傳ISO文件，且不超過10GB,默認支持官方完整版鏡像，如果需要 Minimal 版本，請到 https://docs.rackshift.io/iso/ 下載 ！",drag_file_into_or:"將文件拖到此處，或",click_to_upload:"點擊上傳",uefi_boot:"UEFI 引導",not_detected:"未在位",not_exists:"未检测到",detected:"在位",obm_not_exists:"帶外信息未配置",help_doc:"幫助文檔",created:"待執行",running:"執行中",failed:"失敗",succeeded:"成功",Task:"任務",instance_id:"任務 Id",i18n_zu:"組",i18n_raid60_must_be_2n:"raid60磁盤數必須是2的倍數！",i18n_di:"第",i18n_raid1_must_be_2:"浪潮機器 raid1 只能是2塊磁盤！",i18n_raid1_must_be_2n:"raid1只能是2塊或者2n塊磁盤！",i18n_raid10_must_be_2n:"raid10磁盤數必須是2的倍數！",i18n_raid50_must_be_2n:"raid50磁盤數必須是2的倍數！",i18n_raid5_must_greater_than_3:"raid5不能少於3塊磁盤！",i18n_raid10_must_greater_than_4:"raid10不能少於4塊磁盤！",i18n_raid56_must_be_greater_than_8:"raid60不能少於8塊磁盤！",i18n_pls_os_must_choose_one_raid:"請至少選擇壹組磁盤組建raid！",i18n_raid6_must_greater_than_4:"raid6不能少於4塊磁盤！",i18n_raid50_must_greater_than_6:"raid50不能少於6塊磁盤！",i18n_zu_de_raid_not_config:"組的RAID策略沒有設置！",i18n_raid1_must_greater_than_3:"raid3不能少於3塊磁盤！",i18n_disk:"磁盤：",i18n_duplicate_in_array:"被重複選進多個陣列！",view_log:"查看日志",not_ready:"未就緒",back:"回退",power:"電源",unknown:"未知",on:"開機",off:"關機",detect_params:"掃描配置",protocol:"協議",possible_params:"探測參數",community:"社區名稱",port:"端口號",founded_machine_number:"已發現數量",Discovery_Rule:"發現規則",username_or_id:"ID 或郵箱",welcome:"歡迎回來，輸入用戶名和密碼登錄RackShift",no_more_logs:"無更多日志...",about:"關於",about_us:"關於",server_message:"工作流消息",power_on:"開機",power_off:"關機",power_pxe:"PXE 重啓",power_reset:"硬重啓",sync_success:"同步成功",sync_fail:"同步失敗",Executor:"工作流執行器",upload:"上傳",upload_success_submit:"請等待上傳成功后點擊提交按鈕",selected:"已選擇",tai:"台",power_text:"衹有配置了正確的帶外信息才能通過 IPMI 獲取電源狀態",machine_brand:"品牌",cancel_task_success:"取消任務成功！請等待任務自動結束！",add_protocol_param:"添加一個探測參數","IPMI+Rest":"IPMI 帶外控制卡",workflow_submitted:"工作流已下發，請到任務頁面查看執行日志",opt_fail_pxe:"操作失敗！請先 PXE 啓動機器等待物理機走完發現流程补充完整信息之后再補充帶外信息","安装Centos7 64位版":"安裝 CentOS7 64位版","创建HPE服务器磁盘Raid虚拟磁盘":"創建 HPE 服務器 RAID","搜集HPE服务器磁盘Raid信息":"搜集 HPE 服務器 RAID","清空HPE服务器磁盘和Raid信息":"清空 HPE 服務器 RAID","创建Inspur服务器磁盘Raid虚拟磁盘":"創建 Inspur 服務器 RAID","清空Inspur服务器磁盘和Raid信息":"清空 Inspur 服務器 RAID","搜集Inspur服务器磁盘Raid信息":"搜集 Inspur 服務器 RAID","创建Dell服务器磁盘Raid虚拟磁盘":"創建 Dell 服務器 RAID","清空Dell服务器磁盘和Raid信息":"清空 Dell 服務器 RAID","搜集Dell服务器磁盘Raid信息":"搜集 Dell 服務器 RAID","安装 RedHat7 64位版":"安裝 RHEL7 64位版","安装 windowsServer 2012 标准版":"安装 WindowsServer 2012 標準版","安装 windowsServer 2016 标准版":"安装 WindowsServer 2016 標準版","安装 ESXI 6.7":"安装 ESXI 6.7","下发安装系统workflow":"安裝系統 WORKFLOW 事件","下发通用workflow":"通用 WORKFLOW 事件","补充OBM信息":"補充 OBM 信息","下发发现workflow":"下發發現 WORKFLOW","主节点":"主節點","从节点":"從節點",version:"版本","搜集New H3C Technologies Co., Ltd.服务器磁盘Raid信息":"搜集 H3C 服務器 RAID","清空New H3C Technologies Co., Ltd.服务器磁盘和Raid信息":"清空 H3C 服務器 RAID","创建New H3C Technologies Co., Ltd.服务器磁盘Raid虚拟磁盘":"創建 H3C 服務器 RAID","搜集 InspurM5 服务器磁盘 Raid 信息":"搜集 InspurM5 服務器 RAID","清空 InspurM5 服务器磁盘 Raid 信息":"清空 InspurM5 服務器 RAID","创建 InspurM5 服务器磁盘 Raid 虚拟磁盘":"創建 InspurM5 服務器 RAID",batch_params:"批量參數設置",common_params:"通用裝機參數",nic:"業務網卡編號",productkey:"密鑰",smb_user:"SAMBA 用戶名",smb_password:"SAMBA 密碼",windwos_param:"Windows 參數配置",domain:"域",host_increase:"自增",increase_host_desc:"HOSTNAME1,HOSTNAME2,...",base_number:"HOSTNAME 增長基數",platform:"平臺",samba:"SAMBA",msg:"消息",instruction_content:"命令內容",set_detect_params:"設置檢查參數",Instruction:"命令",pls_select_task:"請選擇任務",base_instruction:"指令模板",pls_select_plugin:"請選擇插件",logs:"日誌",view_plugin:"查看插件",item:"項目",workflow:"工作流",edit_instruction:"編輯命令",add_instruction:"添加命令",select_machine:"選擇物理機",add_plugin:"添加插件","delete_fail!":"刪除失敗",view_instructions:"查看命令",edit_plugin:"編輯插件",pls_select_instruction:"請選擇指令",PXE:"PXE",execute_instruction:"執行命令",pls_select_log:"請選擇日志",scan_over:"掃描結束",confirm_to_del_endpoint:"刪除節點將會同時刪除節點下的所有資源，確認刪除？","Centos 64位":"CentOS 64位","RedHat 64位":"RHEL 64位",network_error:"網絡錯誤，請檢查網絡~",cancelled:"已取消",netmask_validate_error:"子網掩碼不合法！",i18n_yigou_disk:" 組存在異構磁盤（比如機械和固態），不能創建 RAID!",COMPLETE:"完成",not_discoveryed:"未完成主動發現蒐集其 PXE MAC 地址，請執行對服務器進行 PXE重啟！再執行工作流！",is_pxe:"PXE 網卡",true:"是",false:"否",params_not_valid_json:"參數不是標準 json 格式！",cannot_add_more:"不能添加更多網卡配置了！",cannot_add_more_vs:"不能添加更多vSwitch配置了！",pls_input_vlan:"请输入vlanId，多个请用英文”，“隔开！",like_vlan:"例如：vlanId = 1， 填寫 ‘1’ 即可，多個請用英文逗號分隔",must_be_number:"只能是數字",i18n_mac_dup:"mac 地址不能重複",add_network_card:"添加網卡",del_network_card:"删除網卡",esxSwitchName:"vSwitch",add_switch:"添加 vSwitch",del_switch:"刪除 vSwitch",i18n_at_least_sw0:"至少有一个 vSwitch0",i18n_at_least_dns:"至少有一个 dns",i18n_at_least_ntp:"至少有一个 ntp",multiple:" 重複",nic_not_found:"沒有找到網卡",i18n_ms_7_long:"必須大於等於7個字符",no_vlan:" 無 vlan",must_between_0_4095:"必須是 0 - 4095",change:"修改",change_ipmipwd:"修改 IPMI 密碼",twp_pwd_notsame:"兩次密碼不一致","安装 Ubuntu 18.04 64位版":"安裝 Ubuntu 18.04 64位版",add_bond:"添加 BOND",del_bond:"刪除 BOND",deviceName:"Linux 設備名",switch_port:"交換機端口號",switch_name:"交換機名稱",Switch:"交換機",switch:"交換機",snmp_community:"SNMP 社區",snmp_port:"SNMP 端口",ssh_port:"SSH 端口",telnet_port:"TELNET 端口",view_vendor:"設備制造商",Switch_Discovery_Rule:"交換機掃描規則","edit_switch-discovery":"編輯交換機掃描規則",vendor:"製造商",active_ports:"活躍端口",port_detail:"端口詳情",api_key:"API KEY",create:"創建",access_key:"Access Key",secret_key:"Secret Key",hide:"隱藏",param:"參數",copy:"複製",copied:"已複製",device_type:"設備類型",volume_group:"LVM 卷組",lvm:"LVM",standard_partition:"標準分區",lvm_name:"LVM 卷名",partition_tips:"自動分配等於 kickstart autopart，自定義分區默認只操作第一塊磁盤 不管是 standard 標准設備還是 lvm 邏輯設備",ubuntu_pwd:"默認賬號密碼 ubuntu/root",open_webkvm:"遠程 KVM 控制台",post_install:"POST-INSTALL 腳本",view_example:"查看實例",Profile:"引導文件",InstallScript:"安裝腳本","Profile already exists!":"引導文件已經存在",add_profile:"添加引導文件",edit_profile:"編輯引導文件",content:"內容",profile:"引導文件","Template already exists!":"安裝腳本已经存在",add_template:"添加安裝腳本",edit_template:"编辑安裝腳本",template:"安裝腳本",more_than_3:"至少3個字符",pls_input:"請輸入",not_support_validate:"已選擇的鏡像已有裝機腳本，因此 UI 填寫的參數將可能不會生效",backend_upload:"後端掛載",front_upload:"前端上傳",mount_text:"默認 http 服務器掛載地址在 /opt/rackshift/rackhd/files/mount/common，也可以直接使用其他第三方 http 服務器",i18n_lvmname_null:"LVM 卷名不能為空",no_param:"參數不存在",pxe_mac:"PXE MAC",remark:"備注",why:"爲什麽？",pxe_desc:"裝機平台以網卡的 MAC 地址為唯一標識，對 PXE 中的物理機進行區分以實現不同機器不同引導流程",not_required:"(非必選，需要自定義腳本時可選擇)"}},2277:function(e,t,a){},2513:function(e,t,a){"use strict";a("79b7")},"264c":function(e,t,a){var i={"./Graph.InstallCentOS":"b2e4","./Graph.InstallCentOS.vue":"b2e4","./Graph.InstallESXi":"9109","./Graph.InstallESXi.vue":"9109","./Graph.InstallRHEL":"b854","./Graph.InstallRHEL.vue":"b854","./Graph.InstallUbuntu":"e01a","./Graph.InstallUbuntu.vue":"e01a","./Graph.InstallUbuntuLiveCD":"5ca6","./Graph.InstallUbuntuLiveCD.vue":"5ca6","./Graph.InstallWindowsServer":"f83a","./Graph.InstallWindowsServer.vue":"f83a","./Graph.InstallWindowsServer2016":"af6c","./Graph.InstallWindowsServer2016.vue":"af6c","./Graph.Raid.Create.AdaptecRAID":"65c0","./Graph.Raid.Create.AdaptecRAID.vue":"65c0","./Graph.Raid.Create.HpssaRAID":"c91c","./Graph.Raid.Create.HpssaRAID.vue":"c91c","./Graph.Raid.Create.PercRAID":"5f61","./Graph.Raid.Create.PercRAID.vue":"5f61","./params":"abde","./params.js":"abde"};function s(e){return Promise.resolve().then((function(){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}var s=i[e];return a(s)}))}s.keys=function(){return Object.keys(i)},s.id="264c",e.exports=s},"2e98":function(e,t,a){var i={"./en-US":["69d3",9],"./en-US.js":["69d3",9],"./i18n":["0692",9],"./i18n.js":["0692",9],"./zh-CN":["a5e7",9],"./zh-CN.js":["a5e7",9],"./zh-CN.json":["3e1e3",3,"chunk-747dda57"],"./zh-TW":["1954",9],"./zh-TW.js":["1954",9]};function s(e){if(!a.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],s=t[0];return Promise.all(t.slice(2).map(a.e)).then((function(){return a.t(s,t[1])}))}s.keys=function(){return Object.keys(i)},s.id="2e98",e.exports=s},3064:function(e,t,a){},"30d1":function(e,t,a){"use strict";a.d(t,"j",(function(){return l})),a.d(t,"h",(function(){return u})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"e",(function(){return h})),a.d(t,"i",(function(){return c})),a.d(t,"c",(function(){return r})),a.d(t,"g",(function(){return d})),a.d(t,"f",(function(){return b})),a.d(t,"k",(function(){return f})),a.d(t,"a",(function(){return _}));a("d9e2");var i=a("619f");let s=a("2ef0");function l(e,t,a){""!==t&&t&&0!==t.length||("userName"==e.field&&a(new Error(e.vue.$t("pls_input_username"))),"password"==e.field&&a(new Error(e.vue.$t("pls_input_password"))),"uplinks"==e.field&&a(new Error(e.vue.$t("pls_select_"))),e.msg?a(new Error(e.msg)):a(new Error(e.vue.$t("pls_input_params")))),t&&t.length<3&&"name"==e.field&&a(new Error(e.vue.$t("more_than_3"))),a()}var o=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,n=/^((0\d{2,3}-\d{7,8})|(1[3456789]\d{9}))$/;function r(e,t,a){""!==t&&t||("userName"==e.field&&a(new Error(e.vue.$t("pls_input_username"))),"password"==e.field&&a(new Error(e.vue.$t("pls_input_password"))),e.msg?a(new Error(e.msg)):a(new Error(e.vue.$t("pls_input_params")))),o.test(t)||a(new Error(e.vue.$t("email_format_error"))),a()}function d(e,t,a){""!==t&&t||("userName"==e.field&&a(new Error(e.vue.$t("pls_input_username"))),"password"==e.field&&a(new Error(e.vue.$t("pls_input_password"))),e.msg?a(new Error(e.msg)):a(new Error(e.vue.$t("pls_input_params")))),n.test(t)||a(new Error(e.vue.$t("phone_format_error"))),a()}function c(e,t,a){""!==t&&t&&t.length||("userName"==e.field&&a(new Error(e.vue.$t("pls_select_username"))),"password"==e.field&&a(new Error(e.vue.$t("pls_select_password"))),e.name?a(new Error(e.vue.$t("pls_select_")+e.vue.$t(e.name))):a(new Error(e.vue.$t("pls_select")))),a()}function u(e,t,a){""!==t&&t&&t.length||(e.name?a(new Error(e.vue.$t("pls_select_")+e.vue.$t(e.name))):a(new Error(e.vue.$t("pls_select")))),/[a-zA-z]+:\/\/[^\s]+/.test(t)?a():a(new Error(e.vue.$t("invalid_format")))}function p(e,t,a){""!==t&&t||a(new Error(e.vue.$t("pls_input_hostname"))),/[^0-9a-zA-Z\-]+/.test(t)&&a(new Error(e.vue.$t("hostname_must_not_have_invalid_word"))),a()}function m(e,t,a){""!==t&&t||a(new Error(e.vue.$t("pls_input_"))),/[^0-9a-zA-Z\-]+/.test(t)&&a(new Error(e.vue.$t("invalid_format"))),a()}function _(e,t,a){if(""!==t&&t){if(t.length)if(t instanceof Array){for(let i=0;i<t.length;i++)if(!/^(\w+\.\w+)+$/.test(t[i])&&!/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(t[i]))return void a(new Error(e.vue.$t("invalid_format")))}else if(!/^\w+\.\w+$/.test(t)&&!/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(t))return void a(new Error(e.vue.$t("invalid_format")))}else a();a()}function h(e,t,a){""!==t&&t||a(new Error(e.vue.$t("cannt_be_null"))),/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(t)||a(new Error(e.vue.$t("ip_invalid_format"))),a()}function f(e,t,a){if(e.require){""!==t&&t&&0!==t.length||a(new Error(e.vue.$t("cannt_be_null")));let i=s.uniqBy(t);t&&i.length!=t.length&&a(new Error(e.vue.$t("")));for(let s=0;s<t.length;s++)/\d+$/.test(t[s])?(t[s]<0||t[s]>4095)&&a(new Error(e.vue.$t("must_between_0_4095"))):a(new Error(e.vue.$t("must_be_number")))}a()}function b(e,t,a){""!==t&&t||a(),/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(t)||a(new Error(e.vue.$t("ip_invalid_format"))),Object(i["a"])(t)||a(new Error(e.vue.$t("netmask_validate_error"))),a()}},3146:function(e,t,a){"use strict";a("78f5")},"37a3":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",[t("el-input",{attrs:{type:"textarea",rows:e.row,placeholder:e.placeholder},on:{change:e.emitValue},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}),t("el-link",{attrs:{href:"https://docs.rackshift.io/post-install/",target:"_blank"}},[e._v(e._s(e.$t("view_example")))])],1)},s=[],l={name:"RSCodeMirror",props:{value:Array},data(){return{inputValue:"",arrValue:[],row:9,placeholder:"shell script"}},methods:{emitValue:function(e){this.arrValue=e.split("\n"),this.$emit("receiveValue",this.arrValue)}},watch:{value:{handler:function(e){e&&(this.inputValue=e.join("\n"))},immediate:!0}}},o=l,n=a("2877"),r=Object(n["a"])(o,i,s,!1,null,"0450199a",null);t["a"]=r.exports},"39d1":function(e,t,a){"use strict";a("86a4")},"3bc2":function(e,t,a){},"3cea":function(e,t,a){"use strict";a("8ba9")},"3d74":function(e,t,a){},"42a1":function(e,t,a){"use strict";a("2277")},"47cd":function(e,t,a){"use strict";a("ed57")},"4bbf":function(e,t,a){},"4efa":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",[t("el-tooltip",{attrs:{content:e.curObj.remark}},[e.curObj.remark?t("el-link",{on:{click:e.openEdit}},[e._v(e._s(e.formatRemark()))]):e._e()],1),""!=e.curObj.remark&&e.curObj.remark?e._e():t("el-link",{attrs:{type:"add"},on:{click:e.openEdit}},[e._v(e._s(e.$t("add")))]),t("el-dialog",{attrs:{title:e.$t("edit")+e.$t("remark"),visible:e.edit,width:"35vw","close-on-click-modal":!1},on:{"update:visible":function(t){e.edit=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.edit=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submit}},[e._v(e._s(e.$t("confirm")))])],1)]},proxy:!0}])},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:e.$t("remark"),"label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1)],1)],1)],1)},s=[],l=a("b35c"),o={props:["curObj"],data(){return{remark:null,initialRemark:null,edit:!1,loading:!1,formLabelWidth:"100px",form:{}}},methods:{openEdit(){this.remark=this.curObj.remark,this.edit=!0},submit(){this.curObj.remark=this.remark,l["a"].post("bare-metal/remark",this.curObj,e=>{e.success?(this.$message.success(this.$t("opt_success")),this.edit=!1):this.$message.error(this.$t("opt_fail"))})},formatRemark(){return this.curObj.remark&&this.curObj.remark.length>15?this.curObj.remark.substr(0,15)+"...":this.curObj.remark}}},n=o,r=a("2877"),d=Object(r["a"])(n,i,s,!1,null,null,null);t["a"]=d.exports},"56d7":function(e,t,a){"use strict";a.r(t);var i=a("2b0e"),s=(a("14d9"),function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[e.login?t("el-container",[t("el-header",{attrs:{id:"main-header"}},[t("div",{attrs:{id:"logo-div"}},[t("img",{attrs:{id:"logo",src:a("ae10"),alt:""}})]),t("div",{attrs:{id:"right-menu"}},[t("div",{staticClass:"align-right"},[t("HelpDoc"),t("ChangeLanguage"),t("ChangeInfo",{on:{about:e.about}}),t("AboutUs",{ref:"about"})],1)])]),t("el-container",{attrs:{id:"main-content"}},[t("el-aside",{attrs:{id:"main-menu-container"}},[t("el-menu",{attrs:{id:"main-menu","unique-opened":!1}},e._l(e.menus,(function(a){return t("el-submenu",{attrs:{index:a.order}},[t("template",{slot:"title"},[t("i",{class:a.icon}),e._v(e._s(e.$t(a.name)))]),e._l(a.childs,(function(i){return t("el-menu-item",{class:e.$route.path==i.router?"is-active":"",attrs:{index:a.order+"-"+i.order},on:{click:function(t){return e.$router.push(i.router)}}},[e._v(" "+e._s(e.$t(i.name))+" ")])}))],2)})),1)],1),t("el-container",[t("router-view")],1)],1)],1):e._e(),e.login?e._e():t("router-view")],1)}),l=[],o={menus:[{name:"Resource",router:"/Resource",requireRole:"admin,user",order:"3",icon:"el-icon-cloudy",childs:[{name:"Bare Metal Server",router:"/Bare-Metal",requireRole:"user,admin",order:"4",icon:"el-icon-monitor"},{name:"Switch",router:"/switch",requireRole:"user,admin",order:"5",icon:"el-icon-s-promotion"},{name:"Profile",router:"/Profile",requireRole:"user,admin",order:"6",icon:"el-icon-view"},{name:"Template",router:"/Template",requireRole:"user,admin",order:"7",icon:"el-icon-view"},{name:"Image",router:"/Image",requireRole:"user,admin",order:"8",icon:"el-icon-view"}]},{name:"Network",router:"/Network",requireRole:"admin",order:"6",icon:"el-icon-s-grid",childs:[{name:"Subnet",router:"/Network",requireRole:"admin",order:"7",icon:"el-icon-menu"}]},{name:"Control",router:"/Control",requireRole:"admin",order:"9",icon:"el-icon-unlock",childs:[{name:"Workflow",router:"/WorkFlow",requireRole:"admin",order:"10",icon:"el-icon-s-unfold"},{name:"Task",router:"/Task",requireRole:"admin",order:"11",icon:"el-icon-s-operation"},{name:"Plugin",router:"/Plugin",requireRole:"admin",order:"12",icon:"el-icon-s-operation"}]},{name:"Configuration",router:"/Setting",requireRole:"admin",order:"12",icon:"el-icon-s-tools",childs:[{name:"endpoint",router:"/EndPoint",requireRole:"admin",order:"13",icon:"el-icon-s-promotion"},{name:"User",router:"/User",requireRole:"admin",order:"14",icon:"el-icon-user-solid"},{name:"SystemParameter",router:"/SystemParameter",requireRole:"admin",order:"15",icon:"el-icon-s-home"}]}]},n=a("b35c"),r=function(){var e=this,t=e._self._c;return t("el-menu",{staticClass:"main-header-menu",staticStyle:{cursor:"pointer"},attrs:{id:"main-menu","unique-opened":!0,"background-color":"#004a71","text-color":"#fff","active-text-color":"#fff",mode:"horizontal"}},[t("el-submenu",{attrs:{index:"1"}},[t("template",{slot:"title"},[t("font-awesome-icon",{staticClass:"icon global",attrs:{icon:["fas","globe"]}}),e._v(" "+e._s(e.$t(e.language))+" ")],1),e._l(e.languages,(function(a){return t("el-menu-item",{attrs:{index:"1-"+a.index},on:{click:function(t){return e.clicked(a)}}},[e._v(" "+e._s(e.$t(a.name))+" ")])}))],2)],1)},d=[];let c=a("2ef0");var u={data(){return{language:null,languages:[{name:"zh_CN",value:"zh_CN",index:"1"},{name:"zh_TW",index:"2",value:"zh_TW"},{name:"en_US",index:"3",value:"en_US"}]}},mounted(){this.changeLanText()},methods:{changeLanText(){let e=localStorage.getItem("lang")?localStorage.getItem("lang"):"zh_CN",t=c.findIndex(this.languages,(function(t){return t.value==e}));this.language=this.languages[t].name},changeLaunguage(e){this.$setLang(e),this.changeLanText()},clicked:function(e){this.changeLaunguage(e.value)}}},p=u,m=a("2877"),_=Object(m["a"])(p,r,d,!1,null,null,null),h=_.exports,f=function(){var e=this,t=e._self._c;return t("el-menu",{staticClass:"main-header-menu",attrs:{id:"main-menu","unique-opened":!0,"background-color":"#004a71","text-color":"#fff","active-text-color":"#fff",mode:"horizontal"}},[t("el-dialog",{attrs:{title:e.$t("change_pwd"),visible:e.changePwd,"append-to-body":!0,width:"35vw","before-close":e.reset,"close-on-click-modal":!1},on:{"update:visible":function(t){e.changePwd=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v(e._s(e.$t("cancel"))+" ")]),t("el-button",{attrs:{type:"primary"},on:{click:e.change}},[e._v(e._s(e.$t("confirm")))])],1)]},proxy:!0}])},[t("el-form",{ref:"editForm",attrs:{model:e.editObj,rules:e.rules,"label-position":"right"}},[t("el-form-item",{attrs:{label:e.$t("origin-password"),prop:"originPwd","label-width":"6vw"}},[t("el-input",{attrs:{"show-password":""},model:{value:e.editObj.originPwd,callback:function(t){e.$set(e.editObj,"originPwd",t)},expression:"editObj.originPwd"}})],1),t("el-form-item",{attrs:{label:e.$t("new-password"),prop:"newPwd","label-width":"6vw"}},[t("el-input",{attrs:{"show-password":""},model:{value:e.editObj.newPwd,callback:function(t){e.$set(e.editObj,"newPwd",t)},expression:"editObj.newPwd"}})],1),t("el-form-item",{attrs:{label:e.$t("confirm-password"),prop:"confirmPwd","label-width":"6vw"}},[t("el-input",{attrs:{"show-password":""},model:{value:e.editObj.confirmPwd,callback:function(t){e.$set(e.editObj,"confirmPwd",t)},expression:"editObj.confirmPwd"}})],1)],1)],1),t("el-dialog",{attrs:{title:e.$t("api_key"),visible:e.apiVisible,"append-to-body":!0,width:"50vw","close-on-click-modal":!1},on:{"update:visible":function(t){e.apiVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.createApi}},[e._v(e._s(e.$t("create"))+" ")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleClose}},[e._v(e._s(e.$t("close"))+" ")])],1)]},proxy:!0}])},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"}},[t("el-table-column",{attrs:{prop:"accessKey",label:e.$t("access_key"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.accessKey)+" ")]}}])}),t("el-table-column",{attrs:{prop:"secretKey",label:e.$t("secret_key"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{directives:[{name:"show",rawName:"v-show",value:a.row.show,expression:"scope.row.show"}]},[e._v(e._s(a.row.secretKey))]),t("el-link",{on:{click:function(t){return e.showOrHide(a.row)}}},[e._v(e._s(a.row.show?e.$t("hide"):e.$t("show")))])]}}])}),t("el-table-column",{attrs:{prop:"status",label:e.$t("status"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"active-value":"ACTIVE","inactive-value":"DISABLED"},on:{change:function(t){return e.updateApi(t,a.row.id)}},model:{value:a.row.status,callback:function(t){e.$set(a.row,"status",t)},expression:"scope.row.status"}})]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{on:{click:function(t){return e.delApi(a.row.id)}}},[e._v(e._s(e.$t("del")))])]}}])})],1)],1),t("el-submenu",{attrs:{index:"1"}},[t("template",{staticStyle:{width:"150px",overflow:"hidden"},slot:"title"},[e._v(e._s(e.user.name))]),e._l(e.languages,(function(a){return t("el-menu-item",{attrs:{index:"1-"+a.index},on:{click:function(t){return e.clicked(a.value)}}},[e._v(" "+e._s(e.$t(a.name))+" ")])}))],2)],1)},b=[],g=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"about-us",attrs:{title:e.$t("about_us"),"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-row",[t("el-col",[t("div",{staticClass:"github-pic"},[t("el-link",{attrs:{underline:!1,href:e.githubUrl,target:"_blank"}},[t("font-awesome-icon",{staticClass:"github-icon",attrs:{icon:["fab","github-square"]}})],1)],1),t("el-link",{staticClass:"url",attrs:{href:e.githubUrl,target:"_blank"}},[t("span",[e._v(e._s(e.githubUrl))])])],1)],1),t("el-row",[t("el-col",{staticClass:"version"},[t("span",[e._v(e._s(e.$t("version"))+":")]),e._v("   "),t("span",[e._v(e._s(e.version))])])],1)],1)},v=[],y={name:"AboutUs",data(){return{dialogVisible:!1,githubUrl:"https://github.com/rackshift/rackshift",websiteUrl:"https://rackshift.io",version:"Release v1.7.1"}},created(){this.getVersion()},methods:{open(){this.dialogVisible=!0},getVersion(){}}},w=y,$=(a("3146"),Object(m["a"])(w,g,v,!1,null,"0f809c41",null)),k=$.exports,P=a("30d1");a("2ef0");var O={components:{AboutUs:k},data(){return{changePwd:!1,loadingList:!1,tableData:[],editObj:{},aboutUsVisible:!1,apiVisible:!1,language:null,user:JSON.parse(localStorage.getItem("user")),languages:[{name:"change_pwd",value:"changePwd",index:"1"},{name:"api_key",value:"apikey",index:"2"},{name:"about",value:"about",index:"3"},{name:"logout",index:"4",value:"logout"}],rules:{originPwd:[{validator:P["j"],trigger:"blur",vue:this}],newPwd:[{validator:P["j"],trigger:"blur",vue:this}],confirmPwd:[{validator:P["j"],trigger:"blur",vue:this}]}}},mounted(){this.getData()},methods:{showOrHide(e){e.show=!e.show},handleClose(){this.loadingList=!1,this.apiVisible=!1,this.aboutUsVisible=!1},getData(){this.loadingList=!0,n["a"].post("/user/key/info",this.queryVO,e=>{e.forEach(e=>e.show=!1),this.tableData=e,this.loadingList=!1})},delApi(e){n["a"].post("/user/key/delete/"+e,{},e=>{this.getData()})},updateApi(e,t){let a="disabled";e&&(a="active"),n["a"].post("/user/key/"+a+"/"+t,{},e=>{})},createApi(){n["a"].post("/user/key/generate",{},e=>{this.getData()})},reset(){this.changePwd=!1,this.$refs.editForm&&this.$refs.editForm.resetFields()},logout(){n["a"].get("logout",null,()=>{localStorage.removeItem("login"),sessionStorage.removeItem("rsSocket"),window.location.href="/",window.event.returnValue=!1})},clicked:function(e){"logout"==e?this.logout():"changePwd"==e?this.changePwd=!0:"about"==e?(this.aboutUsVisible=!0,this.$emit("about")):"apikey"==e?this.apiVisible=!0:window.open("https://docs.rackshift.io/")},change(){this.validateResult=!0,this.$refs.editForm.validate(e=>{e||(this.validateResult=!1)}),this.validateResult&&n["a"].post("/user/change",this.editObj,e=>{e.data?(this.$message.success(this.$t("opt_success")),this.editObj={},this.changePwd=!1,this.logout()):this.$message.error(this.$t("opt_fail"))})}}},S=O,L=Object(m["a"])(S,f,b,!1,null,null,null),D=L.exports,I=function(){var e=this,t=e._self._c;return t("ul",{staticClass:"main-header-menu el-menu--horizontal el-menu",staticStyle:{"background-color":"rgb(0, 74, 113)"},attrs:{role:"menubar"},on:{mouseenter:function(t){return e.setColor(!0)},mouseout:function(t){return e.setColor(!1)}}},[t("li",{staticClass:"el-submenu",attrs:{role:"menuitem","aria-haspopup":"true",tabindex:"0"}},[t("div",{staticClass:"el-submenu__title",staticStyle:{"border-bottom-color":"transparent",color:"rgb(255, 255, 255)","background-color":"rgb(0, 74, 113)"},attrs:{id:"help-doc"},on:{click:e.helpDoc}},[e._v(" "+e._s(e.$t("help_doc"))+" ")])])])},C=[];a("2ef0");var x={components:{AboutUs:k},data(){return{}},mounted(){},methods:{setColor(e){e?document.querySelector("#help-doc").setAttribute("style","background-color:rgb(0, 59, 90);color:white;"):document.querySelector("#help-doc").setAttribute("style","background-color:rgb(0, 74, 113);color:white;")},helpDoc(){window.open("https://docs.rackshift.io/")}}},E=x,T=Object(m["a"])(E,I,C,!1,null,null,null),N=T.exports,R={name:"App",data(){return{aboutUsVisible:!1,menus:o.menus,login:"true"===localStorage.getItem("login"),user:JSON.parse(localStorage.getItem("user")),squareUrl:"https://cube.elemecdn.com/9/c2/f0ee8a3c7c9638a54940382568c9dpng.png"}},components:{ChangeLanguage:h,ChangeInfo:D,AboutUs:k,HelpDoc:N},mounted(){"true"==localStorage.getItem("first")&&(this.$router.push("/bare-metal"),localStorage.removeItem("first"));let e=localStorage.getItem("lang")?localStorage.getItem("lang"):"zh_CN";this.changeLaunguage(e)},methods:{about(){this.$refs.about.open()},logout(){n["a"].get("logout",null,()=>{localStorage.removeItem("login"),sessionStorage.removeItem("rsSocket"),window.location.href="/",window.event.returnValue=!1})},changeLaunguage(e){this.$setLang(e)},action(e){"logout"==e?this.logout():this.$router.push("info")}}},M=R,j=(a("7db0"),Object(m["a"])(M,s,l,!1,null,null,null)),A=j.exports,B=a("8c4f"),W=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container"},[t("el-row",{attrs:{type:"flex"}},[t("el-col",{attrs:{span:12}},[t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules}},[t("div",{staticClass:"logo"},[t("img",{staticStyle:{width:"224px"},attrs:{src:a("b9b3"),alt:""}})]),t("div",{staticClass:"title"},[t("span",{attrs:{id:"s1"}},[e._v(e._s(e.$t("Login")))]),t("span",{attrs:{id:"s2"}},[e._v(" RackShift ")])]),t("div",{staticClass:"border"}),t("div",{staticClass:"welcome"},[e._v(" "+e._s(e.$t("welcome"))+" ")]),t("div",{staticClass:"form"},[t("el-form-item",{scopedSlots:e._u([{key:"default",fn:function(){return[t("el-radio-group",{model:{value:e.ldap,callback:function(t){e.ldap=t},expression:"ldap"}},[e.ldap?t("el-radio",{attrs:{label:"LDAP",size:"mini"}},[e._v("LDAP")]):e._e(),e.ldap?t("el-radio",{attrs:{label:"LOCAL",size:"mini"}},[e._v("普通登录")]):e._e()],1)]},proxy:!0}])}),t("el-form-item",{attrs:{prop:"userName"}},[t("el-input",{attrs:{type:"text",autocomplete:"off",placeholder:e.$t("username_or_id"),maxlength:"30"},model:{value:e.ruleForm.userName,callback:function(t){e.$set(e.ruleForm,"userName",t)},expression:"ruleForm.userName"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off","show-password":"",placeholder:e.$t("password"),maxlength:"30"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1)],1),t("div",{staticClass:"btn"},[t("el-button",{staticClass:"submit",attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(e._s(e.$t("Login")))])],1),t("div",{staticClass:"msg"},[e._v(" "+e._s(e.msg)+" ")])])],1),t("el-col",{staticClass:"image",attrs:{span:12}},[t("div",{staticClass:"grid-content bg-purple-light"})])],1)],1)},V=[],z=(a("d9e2"),{name:"Login",data(){let e=(e,t,a)=>{""===t&&("userName"==e.field&&a(new Error(this.$t("pls_input_user_name"))),"password"==e.field&&a(new Error(this.$t("pls_input_pwd")))),a()};return{ldap:null,ruleForm:{userName:"",password:""},rules:{userName:[{validator:e,trigger:"blur"}],password:[{validator:e,trigger:"blur"}]},msg:null}},beforeCreate(){"true"===localStorage.getItem("login")&&this.$router.push("index")},created:function(){document.addEventListener("keydown",this.watchEnter)},destroyed(){document.removeEventListener("keydown",this.watchEnter)},methods:{watchEnter(e){13==e.which&&this.submitForm("ruleForm")},submitForm(e){this.$refs[e].validate(e=>{if(!e)return console.log("error submit!!"),!1;n["a"].post("/signin",{userName:this.ruleForm.userName,password:this.ruleForm.password},e=>{if(e.success)localStorage.setItem("login",!0),localStorage.setItem("user",JSON.stringify(e.data)),localStorage.setItem("first",!0),sessionStorage.removeItem("rsSocket"),window.location.href="/";else{let t=e.message;t&&-1!=t.indexOf("Authentication failed for token submission")?this.$message.error(this.$t("username_pwd_error_login_fail")):this.$message.error(this.$t("login_fail"))}},e=>{e&&-1!=e.indexOf("Authentication failed for token submission")?this.$message.error(this.$t("username_pwd_error_login_fail")):this.$message.error(this.$t("login_fail"))})})},resetForm(e){this.$refs[e].resetFields()}}}),U=z,q=(a("0ba4"),Object(m["a"])(U,W,V,!1,null,null,null)),F=q.exports,K=function(){var e=this,t=e._self._c;return t("div")},H=[],J={data(){return{}}},X=J,G=Object(m["a"])(X,K,H,!1,null,null,null),Y=G.exports,Q=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("role"),name:"role"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"machine-title"},[t("div",{staticClass:"el-button-group batch-button"},[t("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("delete"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(e){return t("el-table-column",{attrs:{prop:e.prop,label:e.label,align:"left"}})})),t("el-table-column",{attrs:{prop:"updateTime",label:e.$t("update_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.updateTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}})]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageIndex,"page-size":e.query.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1),t("el-dialog",{attrs:{title:e.$t("edit_role"),visible:e.editDialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmEdit}},[e._v(e._s(e.$t("confirm")))])],1)]},proxy:!0}])},[t("el-form",{ref:"editForm",attrs:{"label-width":"110px",model:e.editObj,"label-position":"right",rules:e.rules}},[t("el-form-item",{attrs:{label:e.$t("name"),prop:"name"}},[t("el-input",{model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),t("el-form-item",{attrs:{label:e.$t("desc"),prop:"description"}},[t("el-input",{model:{value:e.editObj.description,callback:function(t){e.$set(e.editObj,"description",t)},expression:"editObj.description"}})],1),t("el-form-item",{attrs:{label:e.$t("type"),prop:"type"}},[t("el-select",{attrs:{placeholder:e.$t("pls_select")},model:{value:e.editObj.type,callback:function(t){e.$set(e.editObj,"type",t)},expression:"editObj.type"}},[t("el-option",{attrs:{label:e.$t("admin"),value:"admin"}}),t("el-option",{attrs:{label:e.$t("user"),value:"user"}})],1)],1)],1)],1)],1)])],1)},Z=[];let ee=a("2ef0");var te={data(){return{rules:{name:[{validator:P["j"],trigger:"blur",vue:this}],description:[{validator:P["j"],trigger:"blur",vue:this}],type:[{validator:P["j"],trigger:"blur",vue:this,msg:this.$t("pls_select")+this.$t("type")}]},activeName:"role",query:{name:"",pageIndex:1,pageSize:10},tableData:[],multipleSelection:[],delList:[],editVisible:!1,pageTotal:0,form:{},idx:-1,id:-1,columns:[{label:this.$t("name"),prop:"name"},{label:this.$t("desc"),prop:"description"}],editDialogVisible:!1,editType:"edit",editObj:{name:null,description:null,type:null},loadingList:!1}},mounted(){this.getData()},methods:{getData(){this.loadingList=!0,n["a"].post("/role/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},confirmEdit(){this.validateResult=!0,this.$refs.editForm.validate(e=>{e||(this.validateResult=!1)}),this.validateResult&&("edit"==this.editType?n["a"].put("/role/update",this.editObj,e=>{this.editDialogVisible=!1,this.$message.success("edit_success"),this.getData()}):n["a"].post("/role/add",this.editObj,e=>{this.editDialogVisible=!1,this.$message.success("opt_success"),this.getData()}))},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=ee.map(this.delList,e=>e.id);return e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].post("/role/del",e,e=>{this.$message.success(this.$t("delete_success")),this.getData()}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select")+"!")},handleEdit(e,t){"edit"==t?(this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e))):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].delete("/role/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success"))})}):(this.editDialogVisible=!0,this.editType=t,this.editObj={})},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},ae=te,ie=(a("42a1"),Object(m["a"])(ae,Q,Z,!1,null,"7b4d6656",null)),se=ie.exports,le=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("user"),name:"user"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"machine-title"},[t("div",{staticClass:"el-button-group batch-button"},[t("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("delete"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(e){return t("el-table-column",{attrs:{prop:e.prop,label:e.label,align:"left"}})})),t("el-table-column",{attrs:{prop:"updateTime",label:e.$t("update_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.updateTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}})]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit")+e.$t("user"):e.$t("add")+e.$t("user"),visible:e.drawer,direction:"rtl",wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.drawer=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"editForm",attrs:{model:e.editObj,"label-position":"top",rules:e.rules}},[t("el-form-item",{attrs:{label:"ID","label-width":e.formLabelWidth,prop:"id"}},[t("el-input",{attrs:{autocomplete:"off",disabled:"edit"==e.editType,maxlength:"30"},model:{value:e.editObj.id,callback:function(t){e.$set(e.editObj,"id",t)},expression:"editObj.id"}})],1),t("el-form-item",{attrs:{label:e.$t("name"),"label-width":e.formLabelWidth,prop:"name"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("pls_input_name"),maxlength:"30"},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),t("el-form-item",{attrs:{label:e.$t("email"),"label-width":e.formLabelWidth,prop:"email"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("pls_input_email"),maxlength:"50"},model:{value:e.editObj.email,callback:function(t){e.$set(e.editObj,"email",t)},expression:"editObj.email"}})],1),t("el-form-item",{attrs:{label:e.$t("phone"),"label-width":e.formLabelWidth,prop:"phone"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("pls_input_phone")},model:{value:e.editObj.phone,callback:function(t){e.$set(e.editObj,"phone",t)},expression:"editObj.phone"}})],1),"edit"!=e.editType?t("el-form-item",{attrs:{label:e.$t("password"),"label-width":e.formLabelWidth,prop:"password"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("pls_input_pwd"),"show-password":"",maxlength:"30"},model:{value:e.editObj.password,callback:function(t){e.$set(e.editObj,"password",t)},expression:"editObj.password"}})],1):e._e()],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:e.cancelForm}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)])],1)},oe=[];let ne=a("2ef0");var re={data(){return{rules:{id:[{validator:P["j"],trigger:"blur",vue:this}],name:[{validator:P["j"],trigger:"blur",vue:this}],email:[{validator:P["c"],trigger:"blur",vue:this}],phone:[{validator:P["g"],trigger:"blur",vue:this}],password:[{validator:P["j"],trigger:"blur",vue:this}]},activeName:"user",query:{address:"",name:"",pageIndex:1,pageSize:10},tableData:[],multipleSelection:[],delList:[],loadingList:!1,editVisible:!1,formLabelWidth:"80px",pageTotal:0,form:{},loading:!1,idx:-1,id:-1,columns:[{label:this.$t("id"),prop:"id"},{label:this.$t("name"),prop:"name"},{label:this.$t("email"),prop:"email"},{label:this.$t("phone"),prop:"phone"}],drawer:!1,editType:"edit",editObj:{name:null,id:null,email:null,phone:null,roles:[],rolesIds:[]},allRoles:[]}},mounted(){this.getData()},methods:{handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},getData(){this.loadingList=!0,n["a"].post("/user/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},getAllRoles(){n["a"].post("/role/list/1/10000",{},e=>{this.allRoles=e.data.listObject})},handleClose(){this.drawer=!1},cancelForm(){this.loading=!1,this.drawer=!1},resetFields(){this.$refs.editForm&&this.$refs.editForm.resetFields()},add(){this.drawer=!0,this.editType="add",this.resetFields()},confirmEdit(){this.validateResult=!0,this.$refs.editForm.validate(e=>{e||(this.validateResult=!1)}),this.validateResult&&(this.loading=!0,"edit"==this.editType?n["a"].put("/user/update",this.editObj,e=>{this.drawer=!1,this.$message.success(this.$t("edit_success")),this.cancelForm(),this.getData()}):n["a"].post("/user/add",this.editObj,e=>{e.data?(this.drawer=!1,this.$message.success(this.$t("opt_success")),this.cancelForm(),this.getData()):(this.$message.error(this.$t("opt_fail")),this.loading=!1)}))},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=ne.map(this.delList,e=>e.id);return e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].post("/user/del",e,e=>{e.data?(this.$message.success(this.$t("delete_success")),this.getData()):this.$message.error(this.$t("delete_fail"))}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select")+"!")},handleEdit(e,t){"edit"==t?(this.drawer=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e)),this.editObj.rolesIds=ne.map(this.editObj.roles,e=>e.id),this.resetFields()):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].delete("/user/del/"+encodeURIComponent(e.id),{},e=>{e.data?(this.$message.success(this.$t("delete_success")),this.getData()):this.$message.error(this.$t("delete_fail"))})}):(this.drawer=!0,this.editType=t,this.resetFields(),this.editObj={})},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},de=re,ce=(a("e690"),Object(m["a"])(de,le,oe,!1,null,"54675ef2",null)),ue=ce.exports,pe=function(){var e=this,t=e._self._c;return t("el-tabs",{staticStyle:{width:"100vw","min-width":"1300px"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("Bare Metal Server"),name:"bare-metal"}},[t("div",{staticClass:"machine-title2"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.openAdd}},[e._v(e._s(e.$t("add")))]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))]),t("el-button",{attrs:{type:"primary",icon:"el-icon-discover"},on:{click:e.openDiscover}},[e._v(e._s(e.$t("Discovery")))]),t("el-button",{attrs:{type:"primary",icon:"el-icon-caret-right"},on:{click:e.openRunWorkflow}},[e._v(e._s(e.$t("Workflow"))+" ")]),t("el-dropdown",[t("el-button",{attrs:{type:"primary"}},[e._v(" "+e._s(e.$t("opt"))),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.powerBatch("on")}}},[e._v(e._s(e.$t("power_on"))+" ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.powerBatch("off")}}},[e._v(e._s(e.$t("power_off"))+" ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.powerBatch("reset")}}},[e._v(e._s(e.$t("power_reset"))+" ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.powerBatch("pxe")}}},[e._v(e._s(e.$t("power_pxe"))+" ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.fillOBM("obm","batch")}}},[e._v(e._s(e.$t("OBM")+e.$t("info"))+" ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openChangeOBM()}}},[e._v(e._s(e.$t("change")+e.$t("OBM")+e.$t("pwd"))+" ")])],1)],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"sort-change":function(t){return e.sortChange(t)},"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),t("el-table-column",{attrs:{prop:"pxe_mac",label:e.$t("pxe_mac"),align:"left",width:"140",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.pxeMac)+" ")]}}])}),t("el-table-column",{staticStyle:{overflow:"scroll"},attrs:{prop:"machine_model",label:e.$t("machine_model"),align:"left",sortable:"custom",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("detail"),placement:"right-end"}},[t("el-link",{attrs:{type:"primary",target:"_blank"},on:{click:function(t){return e.showDetail(a.row)}}},[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(a.row.machineModel))])])],1)]}}])}),t("el-table-column",{attrs:{prop:"machine_sn",label:e.$t("machine_sn"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.machineSn)+" ")]}}])}),t("el-table-column",{attrs:{prop:"inet_aton(management_ip)",label:e.$t("management_ip"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.managementIp)+" ")]}}])}),t("el-table-column",{attrs:{prop:"ip_array",label:e.$t("IP"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.ipArray)+" ")]}}])}),e._l(e.columns,(function(a){return t("el-table-column",{attrs:{prop:a.prop,label:e.$t(a.label),align:"left",sortable:"custom",width:e.resizeWith(a)},scopedSlots:e._u([{key:"default",fn:function(i){return[a.custom?e._e():t("span",[e._v(e._s(i.row[a.prop]))]),a.custom?t("span",[e._v(e._s(a.formatter(i.row[a.prop])))]):e._e()]}}],null,!0)})})),t("el-table-column",{attrs:{prop:"status",label:e.$t("machine_status"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.status&&-1!=a.row.status.indexOf("ing")?t("i",{staticClass:"el-icon-loading"}):e._e(),t("span",{domProps:{innerHTML:e._s(e.statusFilter(a.row))}})]}}])}),t("el-table-column",{attrs:{prop:"remark",label:e.$t("remark"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("Remark",{attrs:{"cur-obj":e.row}})]}}])}),t("el-table-column",{attrs:{prop:"status",label:e.$t("power"),align:"left",filters:[{text:e.$t("power_on"),value:"on"},{text:e.$t("power_off"),value:"off"},{text:e.$t("unknown"),value:"unknown"}],"filter-method":e.filterPower,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("PowerStatus",{attrs:{content:e.$t("power_text"),status:a.row.power,bareMetalId:a.row.id,callback:e.getData}})]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:e.$t("input_key_search")},on:{change:function(t){return e.getData()}},model:{value:e.queryVO.searchKey,callback:function(t){e.$set(e.queryVO,"searchKey",t)},expression:"queryVO.searchKey"}})]}},{key:"default",fn:function(a){return[t("el-dropdown",[t("el-button",{attrs:{type:"primary"}},[e._v(" "+e._s(e.$t("opt"))),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.power("on",a.row)}}},[e._v(e._s(e.$t("power_on"))+" ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.power("off",a.row)}}},[e._v(e._s(e.$t("power_off"))+" ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.power("reset",a.row)}}},[e._v(e._s(e.$t("power_reset"))+" ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.power("pxe",a.row)}}},[e._v(e._s(e.$t("power_pxe"))+" ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.fillOBM(a.row)}}},[e._v(" "+e._s(e.$t("OBM")+e.$t("info"))+" ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.webKVM(a.row)}}},[e._v(" "+e._s(e.$t("open_webkvm"))+" ")])],1)],1)]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{size:"50%",title:e.logTitle,visible:e.executionLogDrawer,direction:"ttb","min-height":"40vh",wrapperClosable:!1,"before-close":e.handleCloseExecutionLog},on:{"update:visible":function(t){e.executionLogDrawer=t}}},[t("el-card",[t("table",{staticClass:"detail-info"},[t("tr",[t("td",[e._v(e._s(e.$t("time")))]),t("td",[e._v(e._s(e.$t("user")))]),t("td",[e._v(e._s(e.$t("operation")))]),t("td",[e._v(e._s(e.$t("output")))])]),e._l(e.logs,(function(a){return t("tr",[t("td",[e._v(e._s(e._f("dateFormat")(a.createTime)))]),t("td",[e._v(e._s(a.user))]),t("td",[e._v(e._s(a.operation))]),t("td",[e._v(e._s(a.outPut))])])}))],2)])],1),t("el-dialog",{attrs:{title:e.$t("obms"),visible:e.fillOutObms,width:"35vw","close-on-click-modal":!1},on:{"update:visible":function(t){e.fillOutObms=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.fillOutObms=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.obmLoading},on:{click:e.submitOBM}},[e._v(e._s(e.$t("confirm")))])],1)]},proxy:!0}])},[t("el-form",{attrs:{model:e.form}},["batch"!=e.fillOBMMode?t("el-form-item",{attrs:{label:e.$t("ip"),"label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.curObm.ip,callback:function(t){e.$set(e.curObm,"ip",t)},expression:"curObm.ip"}})],1):e._e(),t("el-form-item",{attrs:{label:e.$t("username"),"label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off",maxlength:"30"},model:{value:e.curObm.userName,callback:function(t){e.$set(e.curObm,"userName",t)},expression:"curObm.userName"}})],1),t("el-form-item",{attrs:{label:e.$t("pwd"),"label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off","show-password":"",maxlength:"30"},model:{value:e.curObm.pwd,callback:function(t){e.$set(e.curObm,"pwd",t)},expression:"curObm.pwd"}})],1)],1)],1),t("el-dialog",{ref:"paramDialog",attrs:{title:e.currentParamConfig,visible:e.fillWfParams,width:"90vw","close-on-click-modal":!1},on:{"update:visible":function(t){e.fillWfParams=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("el-button",{on:{click:e.restoreParams}},[t("i",{staticClass:"el-icon-refresh"}),e._v(" "+e._s(e.$t("reset"))+" ")]),t("el-button",{attrs:{type:"primary",loading:e.fillWfParamsLoading},on:{click:e.saveParams}},[e._v(e._s(e.$t("confirm")))])]},proxy:!0}])},[t("keep-alive",[-1!=e.editWorkflowIndex&&e.selectedWorkflow.length>0?t(e.currentWfParamTemplate,{ref:"currentWfParamTemplate",tag:"component",attrs:{params:e.selectedWorkflow[e.editWorkflowIndex]&&e.selectedWorkflow[e.editWorkflowIndex].params,extraParams:e.selectedWorkflow[e.editWorkflowIndex]&&e.selectedWorkflow[e.editWorkflowIndex].extraParams,bareMetalId:e.selectedWorkflow[e.editWorkflowIndex]&&e.selectedWorkflow[e.editWorkflowIndex].bareMetalId}}):e._e()],1)],1),t("el-dialog",{attrs:{title:e.$t("batch_params"),visible:e.batchParams,width:"55vw","close-on-click-modal":!1,"append-to-body":!0},on:{"update:visible":function(t){e.batchParams=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.batchParams=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.batchParamsLoading},on:{click:e.confirmBatchParams}},[e._v(e._s(e.$t("confirm"))+" ")])],1)]},proxy:!0}])},[t("el-form",{ref:"batchParam",attrs:{model:e.bp,rules:e.rules}},[t("el-collapse",{attrs:{accordion:""},on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[t("el-collapse-item",{attrs:{title:e.$t("common_params"),name:"commonOs"}},[t("el-form-item",{attrs:{label:e.$t("hostname"),prop:"hostname","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"30"},model:{value:e.bp.hostname,callback:function(t){e.$set(e.bp,"hostname",t)},expression:"bp.hostname"}})],1),t("el-form-item",{attrs:{label:e.$t("host_increase"),prop:"increase","label-width":e.formLabelWidth}},[t("el-col",{attrs:{span:12}},[t("el-tooltip",{attrs:{content:e.$t("increase_host_desc"),effect:"dark"}},[t("el-switch",{model:{value:e.bp.increase,callback:function(t){e.$set(e.bp,"increase",t)},expression:"bp.increase"}})],1)],1)],1),e.bp.increase?t("el-form-item",{attrs:{label:e.$t("base_number"),"label-width":e.formLabelWidth}},[t("el-input",{attrs:{type:"number"},model:{value:e.bp.baseNumber,callback:function(t){e.$set(e.bp,"baseNumber",t)},expression:"bp.baseNumber"}})],1):e._e(),t("el-form-item",{attrs:{label:e.$t("root_pwd"),prop:"rootPassword","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off","show-password":"",maxlength:"30"},model:{value:e.bp.rootPassword,callback:function(t){e.$set(e.bp,"rootPassword",t)},expression:"bp.rootPassword"}})],1),t("el-form-item",{attrs:{label:e.$t("start_ip"),prop:"startIp","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.bp.startIp,callback:function(t){e.$set(e.bp,"startIp",t)},expression:"bp.startIp"}})],1),t("el-form-item",{attrs:{label:e.$t("end_ip"),prop:"endIp","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.bp.endIp,callback:function(t){e.$set(e.bp,"endIp",t)},expression:"bp.endIp"}})],1),t("el-form-item",{attrs:{label:e.$t("gateway"),prop:"gateway","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.bp.gateway,callback:function(t){e.$set(e.bp,"gateway",t)},expression:"bp.gateway"}})],1),t("el-form-item",{attrs:{label:e.$t("netmask"),prop:"netmask","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.bp.netmask,callback:function(t){e.$set(e.bp,"netmask",t)},expression:"bp.netmask"}})],1),t("el-form-item",{attrs:{label:e.$t("nic"),"label-width":e.formLabelWidth}},[t("el-select",{staticClass:"input-element",model:{value:e.bp.nicNumber,callback:function(t){e.$set(e.bp,"nicNumber",t)},expression:"bp.nicNumber"}},e._l(e.allNicNumber,(function(e){return t("el-option",{attrs:{label:e.name,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("post_install"),"label-width":e.formLabelWidth}},[t("RSCodeMirror",{on:{receiveValue:e.receiveValue},model:{value:e.bp.postInstallCommands,callback:function(t){e.$set(e.bp,"postInstallCommands",t)},expression:"bp.postInstallCommands"}})],1)],1),t("el-collapse-item",{attrs:{title:e.$t("windwos_param"),name:"windowsSamba"}},[t("el-form-item",{attrs:{label:e.$t("domain"),prop:"domain","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true"},model:{value:e.bp.domain,callback:function(t){e.$set(e.bp,"domain",t)},expression:"bp.domain"}})],1),t("el-form-item",{attrs:{label:e.$t("username"),prop:"username","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true"},model:{value:e.bp.username,callback:function(t){e.$set(e.bp,"username",t)},expression:"bp.username"}})],1),t("el-form-item",{attrs:{label:e.$t("samba"),prop:"smbRepo","label-width":e.formLabelWidth}},[t("el-input",{attrs:{placeholder:"\\\\172.31.128.1\\windowsServer2012"},model:{value:e.bp.smbRepo,callback:function(t){e.$set(e.bp,"smbRepo",t)},expression:"bp.smbRepo"}})],1),t("el-form-item",{attrs:{label:e.$t("productkey"),prop:"productkey","label-width":e.formLabelWidth}},[t("el-input",{attrs:{placeholder:"XXXX-XXXX-XXXX-XXXX-XXXX"},model:{value:e.bp.productkey,callback:function(t){e.$set(e.bp,"productkey",t)},expression:"bp.productkey"}})],1),t("el-form-item",{attrs:{label:e.$t("smb_user"),prop:"smbUser","label-width":e.formLabelWidth}},[t("el-input",{model:{value:e.bp.smbUser,callback:function(t){e.$set(e.bp,"smbUser",t)},expression:"bp.smbUser"}})],1),t("el-form-item",{attrs:{label:e.$t("smb_password"),prop:"smbPassword","label-width":e.formLabelWidth}},[t("el-input",{attrs:{"show-password":""},model:{value:e.bp.smbPassword,callback:function(t){e.$set(e.bp,"smbPassword",t)},expression:"bp.smbPassword"}})],1)],1)],1)],1)],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_discovery"):e.$t("add_discovery"),visible:e.discoveryVisible,direction:"rtl",size:"100%","with-header":!1,wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.discoveryVisible=t}}},[t("Discovery",{ref:"discoveryCom",staticClass:"bare-discovery",on:{back:function(t){e.discoveryVisible=!1},queryByRuleId:e.queryByRuleId}})],1),t("drawer",{attrs:{visible:e.detailDrawer,direction:"rtl","with-header":!1,size:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.detailDrawer=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-tabs",{model:{value:e.detailShowName,callback:function(t){e.detailShowName=t},expression:"detailShowName"}},[t("el-tab-pane",{attrs:{label:e.$t("detail"),name:"detail"}},[t("el-form",{ref:"form",attrs:{model:e.machine,"label-position":"top"}},[t("el-form-item",{attrs:{label:e.$t("machine_model")}},[e._v(" "+e._s(e.machine.machineModel)+" ")]),t("el-form-item",{attrs:{label:e.$t("machine_sn")}},[e._v(" "+e._s(e.machine.machineSn)+" ")]),t("el-form-item",{attrs:{label:e.$t("management_ip")}},[e._v(" "+e._s(e.machine.managementIp)+" ")]),t("el-form-item",{attrs:{label:e.$t("bmc_mac")}},[e._v(" "+e._s(e.machine.bmcMac)+" ")]),t("el-form-item",{attrs:{label:e.$t("cpu")}},[e.machine.cpu?t("span",[e._v(e._s(e.machine.cpuType)+" X "+e._s(e.machine.cpu))]):e._e(),e.machine.cpu?e._e():t("span",[e._v(e._s(e.$t("not_exists")))])]),t("el-form-item",{attrs:{label:e.$t("memory")}},[e.machine.memory?t("span",[e._v(e._s(e.machine.memory)+e._s(" "+e.$t("GB")))]):e._e(),e.machine.cpu?e._e():t("span",[e._v(e._s(e.$t("not_exists")))])]),t("el-form-item",{attrs:{label:e.$t("disk")}},[e.machine.disk?t("span",[e._v(e._s(e.machine.disk)+e._s(" "+e.$t("GB")))]):e._e(),e.machine.disk?e._e():t("span",[e._v(e._s(e.$t("not_exists")))])])],1)],1),t("el-tab-pane",{staticClass:"detail-pane",attrs:{label:e.$t("cpu_detail"),name:"cpuDetail"}},[t("table",{staticClass:"detail-info"},[t("tr",[t("td",[e._v(e._s(e.$t("proc_name")))]),t("td",[e._v(e._s(e.$t("proc_socket")))]),t("td",[e._v(e._s(e.$t("proc_speed")))]),t("td",[e._v(e._s(e.$t("proc_num_cores")))]),t("td",[e._v(e._s(e.$t("proc_num_threads")))]),t("td",[e._v(e._s(e.$t("sync_time")))])]),e._l(e.cpus,(function(a){return t("tr",[t("td",[e._v(e._s(a.procName))]),t("td",[e._v(e._s(a.procSocket))]),t("td",[e._v(e._s(a.procSpeed))]),t("td",[e._v(e._s(a.procNumCores))]),t("td",[e._v(e._s(a.procNumThreads))]),t("td",[e._v(e._s(e._f("dateFormat")(a.syncTime)))])])}))],2)]),t("el-tab-pane",{staticClass:"detail-pane",attrs:{label:e.$t("memory_detail"),name:"memoryDetail"}},[t("table",{staticClass:"detail-info"},[t("tr",[t("td",[e._v(e._s(e.$t("mem_cpu_num")))]),t("td",[e._v(e._s(e.$t("mem_mod_num")))]),t("td",[e._v(e._s(e.$t("mem_mod_size")))]),t("td",[e._v(e._s(e.$t("mem_mod_type")))]),t("td",[e._v(e._s(e.$t("mem_mod_num")))]),t("td",[e._v(e._s(e.$t("mem_mod_frequency")))]),t("td",[e._v(e._s(e.$t("mem_mod_part_num")))]),t("td",[e._v(e._s(e.$t("mem_mod_min_volt")))]),t("td",[e._v(e._s(e.$t("sync_time")))])]),e._l(e.memories,(function(a){return t("tr",[t("td",[e._v(e._s(a.memCpuNum))]),t("td",[e._v(e._s(a.memModNum))]),t("td",[e._v(e._s(a.memModSize+" GB"))]),t("td",[e._v(e._s(a.memModType))]),t("td",[e._v(e._s(a.memModNum))]),t("td",[e._v(e._s(a.memModFrequency+" MHz"))]),t("td",[e._v(e._s(a.memModPartNum))]),t("td",[e._v(e._s(a.memModMinVolt))]),t("td",[e._v(e._s(e._f("dateFormat")(a.syncTime)))])])}))],2)]),t("el-tab-pane",{staticClass:"detail-pane",attrs:{label:e.$t("disk_detail"),name:"diskDetail"}},[t("table",{staticClass:"detail-info"},[t("tr",[t("td",[e._v(e._s(e.$t("enclosure_id")))]),t("td",[e._v(e._s(e.$t("controller_id")))]),t("td",[e._v(e._s(e.$t("drive")))]),t("td",[e._v(e._s(e.$t("type")))]),t("td",[e._v(e._s(e.$t("size")))]),t("td",[e._v(e._s(e.$t("raid")))]),t("td",[e._v(e._s(e.$t("manufactor")))]),t("td",[e._v(e._s(e.$t("sn")))]),t("td",[e._v(e._s(e.$t("sync_time")))])]),e._l(e.disks,(function(a){return t("tr",[t("td",[e._v(e._s(a.enclosureId))]),t("td",[e._v(e._s(a.controllerId))]),t("td",[e._v(e._s(a.drive))]),t("td",[e._v(e._s(a.type))]),t("td",[e._v(e._s(a.size))]),t("td",[e._v(e._s(a.raid))]),t("td",[e._v(e._s(a.manufactor))]),t("td",[e._v(e._s(a.sn))]),t("td",[e._v(e._s(e._f("dateFormat")(a.syncTime)))])])}))],2)]),t("el-tab-pane",{staticClass:"detail-pane",attrs:{label:e.$t("nic_detail"),name:"nicDetail"}},[t("table",{staticClass:"detail-info"},[t("tr",[t("td",[e._v(e._s(e.$t("nic_number")))]),t("td",[e._v(e._s(e.$t("mac")))]),t("td",[e._v(e._s(e.$t("is_pxe")))]),t("td",[e._v(e._s(e.$t("switch_name")))]),t("td",[e._v(e._s(e.$t("switch_port")))]),t("td",[e._v(e._s(e.$t("sync_time")))])]),e._l(e.nics,(function(a){return t("tr",[t("td",[e._v(e._s(a.number))]),t("td",[e._v(e._s(a.mac))]),t("td",[e._v(e._s(e.$t(a.pxe)))]),t("td",[e._v(e._s(e.$t(a.switchName)))]),t("td",[e._v(e._s(e.$t(a.switchPort)))]),t("td",[e._v(e._s(e._f("dateFormat")(a.syncTime)))])])}))],2)])],1)],1)])],1),t("drawer",{attrs:{visible:e.actionDrawer,direction:"btt","with-header":!1,size:"70%","before-close":e.handleClose},on:{"update:visible":function(t){e.actionDrawer=t}}},[t("el-divider",[e._v(e._s(e.$t("Executor")))]),t("el-divider",[e._v(e._s(e.$t("selected")+" ")+" "),t("em",{staticClass:"selected-number"},[e._v(" "+e._s(e.multipleSelection.length+" "))]),e._v(" "+e._s(e.$t("tai")+e.$t("Bare Metal Server"))+" ")]),t("div",{attrs:{id:"control-drawer"}},[t("div",{staticClass:"action-div",attrs:{id:"workflow-selector"}},[t("div",{attrs:{id:"select-workflow"}},[t("div",{staticClass:"el-icon-menu h25 workflow-div workflow-div"},[e._v(" "+e._s(e.$t("Workflow"))+" ")]),t("div",{staticClass:"run-splitter h25"}),t("el-select",{attrs:{filterable:"",placeholder:e.$t("please_select")},on:{change:e.getParamsTemplate},model:{value:e.wfRequest.workflow,callback:function(t){e.$set(e.wfRequest,"workflow",t)},expression:"wfRequest.workflow"}},e._l(e.groupedSupportedWorkflow,(function(a){return t("el-option-group",{key:a.key,attrs:{label:e.$t(a.label)}},e._l(a.items,(function(a){return t("el-option",{attrs:{label:e.$t(a.friendlyName),value:a.id}})})),1)})),1),t("el-button",{staticClass:"h50 ml10",attrs:{disabled:0==this.multipleSelection.length||!e.wfRequest.workflow},on:{click:e.addToSelectedWorkflow}},[t("span",{staticClass:"el-icon-circle-plus"}),e._v(e._s(e.$t("add_to_selected_wf_list"))+" ")])],1)]),t("div",{attrs:{id:"action-list"}},[t("div",{staticClass:"el-icon-s-operation h25 workflow-div"},[t("el-badge",{directives:[{name:"show",rawName:"v-show",value:e.selectedWorkflow.length,expression:"selectedWorkflow.length"}],staticClass:"item",attrs:{value:e.selectedWorkflow.length,type:"primary"}},[e._v(" "+e._s(e.$t("selected_workflows"))+" ")]),t("span",{directives:[{name:"show",rawName:"v-show",value:0==e.selectedWorkflow.length,expression:"selectedWorkflow.length == 0"}]},[e._v(" "+e._s(e.$t("selected_workflows"))+" ")])],1),t("div",{staticStyle:{display:"block"}},e._l(e.selectedWorkflow,(function(a,i){return t("el-card",{staticStyle:{height:"100%"}},[t("el-row",[t("el-col",{attrs:{span:6}},[t("el-button",{staticClass:"h50 ml10",on:{click:function(t){return e.deleteSelectedWorkflow(i)}}},[t("span",{staticClass:"el-icon-remove"}),e._v(e._s(e.$t("del"))+" ")])],1),t("el-col",{attrs:{span:10}},[e._v(" "+e._s(a.machineModel?a.machineModel+" "+a.machineSn:a.pxeMac)+" "),t("br"),e._v(" "+e._s(a.friendlyNameInternational)+" ")]),t("el-col",{attrs:{span:8}},[a.settable?t("el-button",{on:{click:function(t){return e.editWfParams(i)}}},[e._v(" "+e._s(e.$t("set_workflow_param"))+" ")]):e._e(),a.settable?e._e():t("span",[e._v(" "+e._s(e.$t("no_nessary_to_set"))+" ")])],1)],1)],1)})),1)]),t("div",{staticClass:"action-div",attrs:{id:"run-workflow"}},[t("div",{staticClass:"el-icon-caret-right h25 workflow-div"},[e._v(e._s(e.$t("Run"))+" ")]),t("div",{staticClass:"run-splitter h25"}),t("div",{staticClass:"center flex"},[t("el-button-group",[t("el-tooltip",{attrs:{effect:"dark",content:e.$t("batch_params")}},[t("el-button",{staticClass:"el-icon-setting h50",on:{click:e.openBatchParams}})],1),t("el-tooltip",{attrs:{effect:"dark",content:e.$t("Run")}},[t("el-button",{staticClass:"el-icon-caret-right h50",on:{click:e.runWorkflow}})],1)],1)],1)])])],1),t("el-dialog",{attrs:{title:e.$t("change_ipmipwd"),visible:e.changeObm,width:"35vw","close-on-click-modal":!1},on:{"update:visible":function(t){e.changeObm=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.changeObm=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.ipmipwdLoading},on:{click:function(t){return e.changeOBM()}}},[e._v(e._s(e.$t("confirm")))])],1)]},proxy:!0}])},[t("el-form",{ref:"ipmiForm",attrs:{model:e.curObm,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$t("pwd"),"label-width":e.formLabelWidth,prop:"pwd"}},[t("el-input",{attrs:{autocomplete:"off","show-password":"",maxlength:"30"},model:{value:e.curObm.pwd,callback:function(t){e.$set(e.curObm,"pwd",t)},expression:"curObm.pwd"}})],1),t("el-form-item",{attrs:{label:e.$t("confirm-password"),"label-width":e.formLabelWidth,prop:"confirmPwd"}},[t("el-input",{attrs:{autocomplete:"off","show-password":"",maxlength:"30"},model:{value:e.curObm.confirmPwd,callback:function(t){e.$set(e.curObm,"confirmPwd",t)},expression:"curObm.confirmPwd"}})],1)],1)],1),t("AddBareMetal",{ref:"addBareMetal",on:{confirm:e.getData}})],1)},me=[],_e=a("b727"),he=_e["a"],fe=(a("b398"),Object(m["a"])(he,pe,me,!1,null,"8ec9c2f4",null)),be=fe.exports,ge=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("image"),name:"image"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),t("el-table-column",{attrs:{prop:"name",label:e.$t("name"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),t("el-table-column",{attrs:{prop:"endpointId",label:e.$t("endpoint"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("endpointFormat")(t.row.endpointId))+" ")]}}])}),t("el-table-column",{attrs:{prop:"url",label:e.$t("url"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.showUrl(a.row.url)}}},[e._v(e._s(e.$t("show")))])]}}])}),e._l(e.columns,(function(a){return t("el-table-column",{attrs:{prop:a.prop,label:e.$t(a.label),align:"left",sortable:a.sort},scopedSlots:e._u([{key:"default",fn:function(i){return[a.custom?e._e():t("span",[e._v(e._s(i.row[a.prop]))]),a.custom?t("span",[e._v(e._s(a.formatter(i.row[a.prop])))]):e._e()]}}],null,!0)})})),t("el-table-column",{attrs:{prop:"updateTime",label:e.$t("update_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.updateTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}})]}}])})],2),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_image"):e.$t("add_image"),visible:e.editDialogVisible,direction:"rtl",wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"form",attrs:{model:e.editObj,rules:e.rules,"label-width":"50px","label-position":e.labelPosition}},[t("el-form-item",{attrs:{label:e.$t("name"),prop:"name"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),t("el-form-item",{attrs:{label:e.$t("os"),prop:"os"}},[t("el-select",{staticClass:"input-element",attrs:{placeholder:e.$t("pls_select")},on:{change:e.changeOsVersion},model:{value:e.editObj.os,callback:function(t){e.$set(e.editObj,"os",t)},expression:"editObj.os"}},e._l(e.allOs,(function(a,i){return t("el-option",{key:a.id,attrs:{label:e.$t(a.name),value:a.id}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("os_version"),prop:"osVersion"}},[t("el-select",{staticClass:"input-element",attrs:{placeholder:e.$t("pls_input_os_version")},model:{value:e.editObj.osVersion,callback:function(t){e.$set(e.editObj,"osVersion",t)},expression:"editObj.osVersion"}},e._l(e.allOsVersion,(function(e,a){return t("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("profile")+e.$t("not_required"),prop:"profile"}},[t("el-select",{staticClass:"input-element",attrs:{placeholder:e.$t("pls_select")+e.$t("profile")},model:{value:e.editObj.profileId,callback:function(t){e.$set(e.editObj,"profileId",t)},expression:"editObj.profileId"}},e._l(e.allProfiles,(function(e,a){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("template")+e.$t("not_required"),prop:"template"}},[t("el-select",{staticClass:"input-element",attrs:{placeholder:e.$t("pls_select")+e.$t("template")},model:{value:e.editObj.templateId,callback:function(t){e.$set(e.editObj,"templateId",t)},expression:"editObj.templateId"}},e._l(e.allTemplates,(function(e,a){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),"edit"!=e.editType?t("el-tabs",{on:{"tab-click":e.handleChangeType},model:{value:e.activeTypeName,callback:function(t){e.activeTypeName=t},expression:"activeTypeName"}},[t("el-tab-pane",{attrs:{label:e.$t("front_upload"),name:"front"}},["edit"!=e.editType?t("el-form-item",{attrs:{label:e.$t("image")}},[t("el-upload",{ref:"uploader",staticClass:"upload-demo",staticStyle:{"margin-bottom":"20px"},attrs:{drag:"","before-upload":e.beforeUpload,"on-success":e.afterUploadSuccess,action:"/image/upload",multiple:!1,limit:1,disabled:"edit"==e.editType}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(e._s(e.$t("drag_file_into_or"))),t("em",[e._v(e._s(e.$t("click_to_upload")))])]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.$t("only_iso_no_more_than_10g"))+" "),t("em",{staticClass:"upload-tip"},[e._v(e._s(e.$t("upload_success_submit")))])])])],1):e._e()],1),t("el-tab-pane",{attrs:{label:e.$t("backend_upload"),name:"backend"}},[t("el-form-item",{attrs:{label:e.$t("url"),prop:"name"}},[t("div",{staticClass:"el-upload__text"},[e._v(e._s(e.$t("mount_text"))+" ")]),t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.url,callback:function(t){e.$set(e.editObj,"url",t)},expression:"editObj.url"}})],1)],1)],1):e._e(),"edit"==e.editType?t("el-form-item",{attrs:{label:e.$t("url"),prop:"name"}},[t("div",{staticClass:"el-upload__text"},[e._v(e._s(e.$t("mount_text"))+" ")]),t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.url,callback:function(t){e.$set(e.editObj,"url",t)},expression:"editObj.url"}})],1):e._e()],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),"edit"!=e.editType?t("el-button",{attrs:{type:"primary",loading:e.loading,disabled:!e.canConfirm},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("SUBMIT"))+" ")]):e._e(),"edit"==e.editType?t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("SUBMIT"))+" ")]):e._e()],1)],1)]),t("el-dialog",{attrs:{title:e.$t("view_url"),visible:e.showUrlVisible,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.showUrlVisible=t}}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("span",[e._v(e._s(e.currentUrl)+" ")]),t("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.copyUrl(t)}}},[t("i",{staticClass:"el-icon-copy-document"})])],1)],1)],1)],1)])],1)},ve=[];let ye=a("2ef0");var we={data(){return{allTemplates:[],allProfiles:[],activeName:"image",activeTypeName:"front",canConfirm:!1,rules:{name:[{validator:P["j"],trigger:"blur",vue:this}],os:[{validator:P["i"],trigger:"blur",vue:this}],osVersion:[{validator:P["i"],trigger:"blur",vue:this}]},query:{name:"",pageIndex:1,pageSize:10},showUrlVisible:!1,currentUrl:null,tableData:[],loadingList:[],multipleSelection:[],delList:[],editVisible:!1,labelPosition:"top",pageTotal:0,idx:-1,id:-1,loading:!1,columns:[{label:"os",prop:"os"},{label:"os_vesion",prop:"osVersion"}],editDialogVisible:!1,editType:"edit",editObj:{name:null},allOs:[],allOsVersion:[],allEndPoints:[],fileName:null}},computed:{action:function(){return"/image/upload?fileName="+this.fileName}},mounted(){this.getData(),this.getAllOsAndVersion(),this.getAllEndPoints(),this.getAllProfiles(),this.getAllTemplates()},methods:{copyUrl(e){e.preventDefault();var t=this.currentUrl;let a=document.createElement("input");a.value=t,document.body.appendChild(a),a.select(),document.execCommand("Copy"),a.style.display="none",document.body.removeChild(a),this.$message.success(this.$t("copy_success"))},showUrl(e){this.showUrlVisible=!0,this.currentUrl=e},getAllEndPoints(){n["a"].get("/endpoint/getAllEndPoints",{},e=>{this.allEndPoints=[].concat(ye.find(e.data,e=>"main_endpoint"==e.type)),localStorage.setItem("allEndPoints",JSON.stringify(this.allEndPoints))})},getAllProfiles(){n["a"].get("/profile/getAllProfiles",{},e=>{this.allProfiles=e.data,localStorage.setItem("allProfiles",JSON.stringify(this.allProfiles))})},getAllTemplates(){n["a"].get("/template/getAllTemplates",{},e=>{this.allTemplates=e.data,localStorage.setItem("allTemplates",JSON.stringify(this.allTemplates))})},getData(){this.loadingList=!0,n["a"].post("/image/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},getAllOsAndVersion(){n["a"].get("/rackhd/allOsAndVersion",{},e=>{this.allOs=e.data})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},changeOsVersion(){this.allOsVersion=ye.find(this.allOs,{id:this.editObj.os}).versions,this.editObj.osVersion=null},handleChangeType(){"backend"==this.activeTypeName?this.canConfirm=!0:this.canConfirm=!1},handleClose(){this.editDialogVisible=!1,this.showUrlVisible=!1},add(){this.editDialogVisible=!0,this.editType="add",this.canConfirm=!1},confirmEdit(){this.validateResult=!0,this.$refs.form.validate(e=>{e||(this.validateResult=!1)}),this.validateResult?(this.loading=!0,this.editObj.brands=JSON.stringify(this.editObj.brands),"edit"==this.editType?n["a"].put("/image/update",this.editObj,e=>{this.editDialogVisible=!1,this.canConfirm=!1,this.$message.success(this.$t("edit_success")),this.getData(),this.loading=!1}):n["a"].post("/image/add",this.editObj,e=>{e.success?(this.editDialogVisible=!1,this.$message.success(this.$t("add_success")),this.getData()):this.$message.error(this.$t("upload")+this.$t("failed")),this.$refs.uploader.clearFiles(),this.loading=!1,this.canConfirm=!0},null,e=>{this.$message.error(this.$t("opt_fail")),this.loading=!1,this.canConfirm=!0})):this.$message.error(this.$t("validate_error"))},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=ye.map(this.delList,e=>e.id);return e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{this.loadingList=!0,n["a"].post("/image/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData(),this.multipleSelection=[],this.loadingList=!1):this.$message.success(this.$t("delete_fail"))},e=>{this.$message.success(this.$t("delete_fail")),this.loadingList=!1})}):this.$message.error(this.$t("pls_select_image")+"!")},handleEdit(e,t){if("edit"==t)this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e)),this.resetFields();else if("del"==t)this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{this.loadingList=!0,n["a"].delete("/image/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!")),this.loadingList=!1},e=>{this.$message.error(this.$t("delete_fail!")),this.loadingList=!1})});else{this.editDialogVisible=!0,this.editType=t,this.$refs.form&&this.$refs.form.resetFields();let e=ye.find(this.allEndPoints,e=>"main_endpoint"==e.type);this.editObj={endpointId:e?e.id:null,url:null,os:null,osVersion:null}}},resetFields(){this.$refs.form&&this.$refs.form.resetFields()},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()},afterUploadSuccess(e){this.editObj.originalName=e.originalName,this.editObj.filePath=e.filePath,this.canConfirm=!0},beforeUpload(e){return this.canConfirm=!1,!0}}},$e=we,ke=(a("47cd"),Object(m["a"])($e,ge,ve,!1,null,"6e1b43c4",null)),Pe=ke.exports,Oe=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("Network"),name:"network"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(a){return t("el-table-column",{attrs:{prop:a.prop,formatter:e.getValidProText,label:a.label,align:"left",sortable:a.sort}})})),t("el-table-column",{attrs:{prop:"endpointId",label:e.$t("endpoint"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("endpointFormat")(t.row.endpointId))+" ")]}}])}),t("el-table-column",{attrs:{label:e.$t("dhcp_enable"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$t("enabled"))+" ")]}}])}),t("el-table-column",{attrs:{prop:"pxeEnable",label:e.$t("pxe_enable"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getValidProText(null,null,t.row.pxeEnable))+" ")]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),t("RSButton",{attrs:{icon:"el-icon-delete",type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}})]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_network"):e.$t("add_network"),visible:e.editDialogVisible,direction:"rtl",wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"form",attrs:{model:e.editObj,rules:e.rules,"label-position":"top"}},[t("el-form-item",{attrs:{label:e.$t("name"),prop:"name"}},[t("el-input",{attrs:{autocomplete:"off",maxlength:"30"},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),t("el-form-item",{attrs:{label:e.$t("endpoint"),prop:"endpointId"}},[t("el-select",{staticClass:"input-element",attrs:{placeholder:e.$t("pls_select")},model:{value:e.editObj.endpointId,callback:function(t){e.$set(e.editObj,"endpointId",t)},expression:"editObj.endpointId"}},e._l(e.allEndPoints,(function(e,a){return t("el-option",{attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("startIp"),prop:"startIp"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("pls_input_start_ip")},model:{value:e.editObj.startIp,callback:function(t){e.$set(e.editObj,"startIp",t)},expression:"editObj.startIp"}})],1),t("el-form-item",{attrs:{label:e.$t("endIp"),prop:"endIp"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("pls_input_end_ip")},model:{value:e.editObj.endIp,callback:function(t){e.$set(e.editObj,"endIp",t)},expression:"editObj.endIp"}})],1),t("el-form-item",{attrs:{label:e.$t("netmask"),prop:"netmask"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("pls_input_netmask")},model:{value:e.editObj.netmask,callback:function(t){e.$set(e.editObj,"netmask",t)},expression:"editObj.netmask"}})],1),t("el-form-item",{attrs:{label:e.$t("pxe_enable"),prop:"pxeEnable"}},[e.editObj.pxeEnable?e._e():t("el-tooltip",{attrs:{effect:"dark",content:e.pxeTips}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.changePXE},model:{value:e.editObj.pxeEnable,callback:function(t){e.$set(e.editObj,"pxeEnable",t)},expression:"editObj.pxeEnable"}})],1),e.editObj.pxeEnable?t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.changePXE},model:{value:e.editObj.pxeEnable,callback:function(t){e.$set(e.editObj,"pxeEnable",t)},expression:"editObj.pxeEnable"}}):e._e()],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)])],1)},Se=[],Le=a("619f");let De=a("2ef0");var Ie={data(){return{activeName:"network",rules:{name:[{validator:P["j"],trigger:"blur",vue:this}],endpointId:[{validator:P["i"],trigger:"blur",vue:this}],startIp:[{validator:P["e"],trigger:"blur",vue:this}],endIp:[{validator:P["e"],trigger:"blur",vue:this}],netmask:[{validator:P["f"],trigger:"blur",vue:this}]},query:{name:"",pageIndex:1,pageSize:10},tableData:[],multipleSelection:[],delList:[],editVisible:!1,pageTotal:0,idx:-1,id:-1,loading:!1,enables:[{id:"enable",name:this.$t("enable")},{id:"disable",name:this.$t("disable")}],columns:[{label:this.$t("name"),prop:"name",sort:!0}],editDialogVisible:!1,editType:"edit",editObj:{name:null,description:null,type:null},allOs:[],allOsVersion:[],allEndPoints:[],loadingList:!1,pxeTips:""}},mounted(){this.getData(),this.getAllEndPoints()},methods:{changePXE(e){this.editObj.pxeEnable?(this.editObj.dhcpEnable=!0,this.pxeTips=null):this.pxeTips=this.$t("pxe_open_tip")},getAllEndPoints(){n["a"].get("/endpoint/getAllEndPoints",{},e=>{this.allEndPoints=e.data,localStorage.setItem("allEndPoints",JSON.stringify(e.data))})},getValidProText(e,t,a,i){return!0===a?this.$t("enabled"):!1===a?this.$t("disabled"):a},getData(){this.loadingList=!0,n["a"].post("/network/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},confirmEdit(){this.validateResult=!0,this.$refs["form"].validate(e=>{e||(this.validateResult=!1)}),this.validateResult?Object(Le["a"])(this.editObj.netmask)?(this.loading=!0,"edit"==this.editType?n["a"].put("/network/update",this.editObj,e=>{this.editDialogVisible=!1,e.success?(this.$message.success(this.$t("edit_success")),this.getData()):this.$message.error(this.$t("opt_fail")),this.loading=!1}):n["a"].post("/network/add",this.editObj,e=>{this.editDialogVisible=!1,e.data?(this.$message.success(this.$t("add_success")),this.getData()):this.$message.error(this.$t("opt_fail")),this.loading=!1})):this.$message.error(this.$t("netmask_validate_error")):this.$message.error(this.$t("validate_error"))},handleSelectionChange(e){this.multipleSelection=e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{this.loadingList=!0,n["a"].post("/network/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData(),this.multipleSelection=[],this.loadingList=!1):this.$message.success(this.$t("delete_fail"))},e=>{this.$message.success(this.$t("delete_fail")),this.loadingList=!1})}):this.$message.error(this.$t("pls_select_network")+"!")},handleEdit(e,t){"edit"==t?(this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e)),this.resetFields()):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].delete("/network/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})}):(this.editDialogVisible=!0,this.editType=t,this.resetFields(),this.editObj={pxeEnable:!1,dhcpEnable:!1,netmask:"255.255.255.0"})},resetFields(){this.$refs.form&&this.$refs.form.resetFields()},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=De.map(this.delList,e=>e.id);return e}}},Ce=Ie,xe=(a("65b1"),Object(m["a"])(Ce,Oe,Se,!1,null,"c0892e6e",null)),Ee=xe.exports,Te=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("ExecutionLog"),name:"execution-log"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"machine-title"},[t("div",{staticClass:"el-button-group batch-button"},[t("button",{staticClass:"el-button el-button--primary",attrs:{type:"button"},on:{click:e.delAllSelection}},[t("i",{staticClass:"el-icon-delete"}),e._v(e._s(e.$t("delete"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(a){return t("el-table-column",{attrs:{prop:a.prop,formatter:e.getValidProText,label:a.label,align:"left",sortable:a.sort}})})),t("el-table-column",{attrs:{prop:"status",label:e.$t("status"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$t(t.row.status))+" ")]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{attrs:{tip:e.$t("view")},on:{click:function(t){return e.viewDetail(a.row)}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}})]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{size:"50%",title:"edit"==e.editType?e.$t("view_execution_log"):e.$t("add_execution_log"),visible:e.editDialogVisible,wrapperClosable:!1,direction:"ttb","before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-card",[t("table",{staticClass:"detail-info"},[t("tr",[t("td",[e._v(e._s(e.$t("time")))]),t("td",[e._v(e._s(e.$t("user")))]),t("td",[e._v(e._s(e.$t("status")))]),t("td",[e._v(e._s(e.$t("output")))])]),e._l(e.detailLogs,(function(a){return t("tr",[t("td",[e._v(e._s(e._f("dateFormat")(a.createTime)))]),t("td",[e._v(e._s(a.user))]),t("td",[e._v(e._s(e.$t(a.operation)))]),t("td",[e._v(e._s(a.outPut))])])}))],2)]),t("div",{staticClass:"demo-drawer__footer fr"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("close")))])],1)],1)])],1)])],1)},Ne=[];let Re=a("2ef0");var Me={data(){return{activeName:"execution-log",query:{name:"",pageIndex:1,pageSize:10},tableData:[],loadingList:!1,multipleSelection:[],delList:[],editVisible:!1,pageTotal:0,form:{},loading:!1,enables:[{id:"enable",name:this.$t("enable")},{id:"disable",name:this.$t("disable")}],columns:[{label:this.$t("user"),prop:"user",sort:!0}],editDialogVisible:!1,editType:"edit",editObj:{name:null,description:null,type:null},allOs:[],detailLogs:[],allOsVersion:[]}},mounted(){this.getData()},methods:{getValidProText(e,t,a,i){return 1==a?this.$t("enabled"):a&&0==a?this.$t("disabled"):a},getData(){this.loadingList=!0,n["a"].post("/execution-log/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},confirmEdit(){this.editDialogVisible=!1},handleSelectionChange(e){this.multipleSelection=e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].post("/execution-log/del",e,e=>{this.$message.success(this.$t("delete_success")),this.getData()}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select_network")+"!")},viewDetail(e){n["a"].get("/execution-log/getDetailById/"+e.id,{},e=>{this.detailLogs=e.data,this.editDialogVisible=!0})},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=Re.map(this.delList,e=>e.id);return e},handleEdit(e,t){"edit"==t?(this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e))):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].get("/execution-log/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})}):(this.editDialogVisible=!0,this.editType=t,this.editObj={})},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},je=Me,Ae=(a("8460"),Object(m["a"])(je,Te,Ne,!1,null,"0e6f0426",null)),Be=Ae.exports,We=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("Workflow"),name:"workflow"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),t("el-table-column",{attrs:{prop:"friendlyName",label:e.$t("friendly_name"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(e.$t(a.row.friendlyName)))])]}}])}),e._l(e.columns,(function(a){return t("el-table-column",{attrs:{prop:a.prop,label:a.label,align:"left",sortable:a.sort,formatter:e.getValidProText,width:"100"}})})),t("el-table-column",{attrs:{prop:"eventType",label:e.$t("event_type"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(e._f("eventFormat")(a.row.eventType)))])]}}])}),t("el-table-column",{attrs:{prop:"brands",label:e.$t("brands"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("brandsFormat")(t.row.brands))+" ")]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),"system"!=a.row.type?t("RSButton",{attrs:{icon:"el-icon-delete",type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}}):e._e()]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_workflow"):e.$t("add_workflow"),visible:e.editDialogVisible,direction:"rtl",wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"form",attrs:{model:e.editObj,"label-position":e.labelPosition,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:e.$t("injectable_name"),prop:"injectableName"}},[t("el-select",{staticClass:"input-element",attrs:{filterable:"",placeholder:e.$t("pls_select"),disabled:"system"==e.editObj.type},on:{change:e.changeFriendlyName},model:{value:e.editObj.injectableName,callback:function(t){e.$set(e.editObj,"injectableName",t)},expression:"editObj.injectableName"}},e._l(e.allRackHDWorkflows,(function(e){return t("el-option",{attrs:{label:e.injectableName,value:e.injectableName}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("friendly_name"),prop:"friendlyName"}},[t("el-input",{staticClass:"input-element",model:{value:e.editObj.friendlyName,callback:function(t){e.$set(e.editObj,"friendlyName",t)},expression:"editObj.friendlyName"}})],1),t("el-form-item",{attrs:{label:e.$t("event_type"),prop:"eventType"}},[t("el-select",{staticClass:"input-element",attrs:{placeholder:e.$t("pls_select"),disabled:"system"==e.editObj.type},model:{value:e.editObj.eventType,callback:function(t){e.$set(e.editObj,"eventType",t)},expression:"editObj.eventType"}},e._l(e.allEventType,(function(a,i){return t("el-option",{attrs:{label:e.$t(a.name),value:a.value}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("brands"),prop:"brands"}},[t("el-select",{staticClass:"input-element",attrs:{placeholder:e.$t("pls_select"),multiple:""},model:{value:e.editObj.brands,callback:function(t){e.$set(e.editObj,"brands",t)},expression:"editObj.brands"}},e._l(e.allBrands,(function(e,a){return t("el-option",{attrs:{label:e,value:e}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("settable"),disabled:"system"==e.editObj.type}},[t("el-switch",{model:{value:e.editObj.settable,callback:function(t){e.$set(e.editObj,"settable",t)},expression:"editObj.settable"}})],1),t("el-form-item",{attrs:{label:e.$t("default_params"),disabled:"system"==e.editObj.type}},[t("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.editObj.defaultParams,callback:function(t){e.$set(e.editObj,"defaultParams",t)},expression:"editObj.defaultParams"}})],1),t("el-form-item",{attrs:{label:e.$t("status"),disabled:"system"==e.editObj.type,prop:"status"}},[t("el-switch",{attrs:{"active-value":"enable","inactive-value":"disable"},model:{value:e.editObj.status,callback:function(t){e.$set(e.editObj,"status",t)},expression:"editObj.status"}})],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)])],1)},Ve=[],ze=a("a788"),Ue=ze["a"],qe=(a("1481"),Object(m["a"])(Ue,We,Ve,!1,null,"54087253",null)),Fe=qe.exports,Ke=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("endpoint"),name:"endpoint"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),t("el-table-column",{attrs:{prop:"name",label:e.$t("name"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$t(t.row.name))+" ")]}}])}),t("el-table-column",{attrs:{prop:"type",label:e.$t("type"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("endpointType")(t.row.type))+" ")]}}])}),t("el-table-column",{attrs:{prop:"ip",label:e.$t("ip"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.ip)+" ")]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"status",label:e.$t("status"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return["Online"==a.row.status?t("span",{staticClass:"green"},[e._v(" Online ")]):e._e(),"Offline"==a.row.status?t("span",{staticClass:"grey"},[e._v(" Offline ")]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}}),t("RSButton",{attrs:{type:"sync",tip:e.$t("sync")},on:{click:function(t){return e.handleEdit(a.row,"sync")}}})]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_endpoint"):e.$t("add_endpoint"),visible:e.editDialogVisible,wrapperClosable:!1,direction:"rtl","before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"editForm",attrs:{model:e.editObj,labelPosition:"top",rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:e.$t("name"),prop:"name"}},[t("el-input",{staticClass:"input-element",attrs:{autocomplete:"off",maxlength:"30",placeholder:e.$t("pls_input_param_value")},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),t("el-form-item",{attrs:{label:e.$t("type"),prop:"type"}},[t("el-select",{staticClass:"input-element",model:{value:e.editObj.type,callback:function(t){e.$set(e.editObj,"type",t)},expression:"editObj.type"}},e._l(e.onlySlave(e.editObj.type),(function(a){return t("el-option",{attrs:{label:e.$t(a.name),value:a.value}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("ip"),prop:"ip"}},[t("el-input",{staticClass:"input-element",attrs:{autocomplete:"off",placeholder:e.$t("pls_input_param_value")},model:{value:e.editObj.ip,callback:function(t){e.$set(e.editObj,"ip",t)},expression:"editObj.ip"}})],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)])],1)},He=[],Je=a("c32b"),Xe=Je["a"],Ge=(a("8a5f"),Object(m["a"])(Xe,Ke,He,!1,null,"d3001b0a",null)),Ye=Ge.exports,Qe=a("9bd2"),Ze=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",on:{"tab-click":e.refreshChildData},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("Task"),name:"task"}},[t("div",{staticClass:"container-task"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(t){return e.cancel()}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(t){return e.getData()}}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header",type:"selection","reserve-selection":!0,"row-key":e=>e.id,"highlight-current-row":""},on:{"selection-change":e.handleSelectionChange,"sort-change":function(t){return e.sortChange(t)}}},[t("el-table-column",{attrs:{type:"selection","reserve-selection":!0,align:"left"}}),t("el-table-column",{attrs:{prop:"id",label:e.$t("id"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.row.id,placement:"right-end"}},[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(a.row.id))])])]}}])}),t("el-table-column",{attrs:{prop:"machineModel",label:e.$t("Bare Metal Server"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(a.row.machineModel))])]}}])}),t("el-table-column",{attrs:{prop:"machineSn",label:e.$t("machine_sn"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(a.row.machineSn))])]}}])}),t("el-table-column",{attrs:{prop:"friendlyName",label:e.$t("Workflow"),align:"left",sortable:"custom",width:"210"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(e.$t(a.row.friendlyName)))])]}}])}),t("el-table-column",{attrs:{prop:"userId",label:e.$t("user"),align:"left",sortable:"custom"}}),t("el-table-column",{attrs:{prop:"params",label:e.$t("param"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{on:{click:function(t){return e.viewParam(a.row.params)}}},[e._v("查看")])]}}])}),t("el-table-column",{attrs:{prop:"status",label:e.$t("status"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[-1!=a.row.status.indexOf("ing")?t("i",{staticClass:"el-icon-loading"}):e._e(),t("span",[e._v(e._s(e.$t(a.row.status)))]),-1!=a.row.status.indexOf("ing")?t("span",{staticClass:"percent"},[e._v(e._s(e.getSuccessRate(a.row)))]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(e._f("dateFormat")(a.row.createTime)))])]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:e.$t("input_key_search")},on:{change:function(t){return e.getData()}},model:{value:e.queryVO.searchKey,callback:function(t){e.$set(e.queryVO,"searchKey",t)},expression:"queryVO.searchKey"}})]}},{key:"default",fn:function(a){return[t("RSButton",{attrs:{type:"view",tip:e.$t("view_log")},on:{click:function(t){return e.handleEdit(a.row,"view")}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}})]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:e.$t("view_log"),visible:e.editDialogVisible,direction:"rtl",size:"50%",wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[e.logs.length?t("table",{staticClass:"detail-info log"},[t("tr",[t("td",[e._v(e._s(e.$t("create_time")))]),t("td",[e._v(e._s(e.$t("output")))])]),e._l(e.logs,(function(a,i){return t("tr",[t("td",{staticClass:"nowrap"},[e._v(e._s(e._f("dateFormat")(a.createTime)))]),t("td",[e._v(e._s(a.outPut))])])})),t("tr",[t("td",["running"==e.editObj.status?t("i",{staticClass:"el-icon-loading"}):e._e()])])],2):t("span",{staticClass:"mb10"},[e._v(e._s(e.$t("no_more_logs")))]),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("close")))])],1)])]),t("el-drawer",{attrs:{title:e.$t("view_log"),visible:e.editDialogVisible2,direction:"rtl",size:"50%",wrapperClosable:!1,"before-close":e.handleClose2},on:{"update:visible":function(t){e.editDialogVisible2=t}}},[t("div",{staticClass:"demo-drawer__content"},[e.editObj.graphObjects?t("json-viewer",{attrs:{value:e.editObj.graphObjects,"expand-depth":2,copyable:{copyText:e.$t("copy"),copiedText:e.$t("copied"),timeout:2e3}}}):t("span",{staticClass:"mb10"},[e._v(e._s(e.$t("no_more_logs")))]),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:e.handleClose2}},[e._v(e._s(e.$t("close")))])],1)],1)]),t("el-dialog",{staticClass:"about-us",attrs:{title:e.$t("param"),"append-to-body":!0,visible:e.paramVisable},on:{"update:visible":function(t){e.paramVisable=t}}},[t("json-viewer",{attrs:{value:e.jsonData,"expand-depth":6,copyable:{copyText:e.$t("copy"),copiedText:e.$t("copied"),timeout:2e3}}})],1)],1)])],1)},et=[],tt=a("349e"),at=a.n(tt),it=a("8420"),st=a.n(it);i["default"].use(at.a);let lt=a("2ef0");var ot={data(){return{states:[{id:"state_1",label:"State 1"},{id:"state_2",label:"State 2"},{id:"state_3",label:"State 3"},{id:"state_4",label:"State 4"},{id:"state_5",label:"State 5"},{id:"state_6",label:"State 6"}],transitions:[{id:"transition_1",label:"this is a transition",target:"state_2",source:"state_1"},{id:"transition_1",label:"this is a transition",target:"state_3",source:"state_2"},{id:"transition_1",label:"this is a transition",target:"state_4",source:"state_3"},{id:"transition_1",label:"this is a transition",target:"state_5",source:"state_4"},{id:"transition_1",label:"this is a transition",target:"state_6",source:"state_5"}],editDialogVisible2:!1,paramVisable:!1,jsonData:{},queryVO:{},refreshOne:!1,refreshSubTaskPointer:null,refreshTaskPointer:null,logs:[],activeName:"task",rules:{name:[{validator:P["j"],trigger:"blur",vue:this}],startIp:[{validator:P["e"],trigger:"blur",vue:this}],endIp:[{validator:P["e"],trigger:"blur",vue:this}],mask:[{validator:P["e"],trigger:"blur",vue:this}]},query:{name:"",pageIndex:1,pageSize:10},tableData:[],loadingList:[],multipleSelection:[],delList:[],editVisible:!1,labelPosition:"top",pageTotal:0,idx:-1,id:-1,loading:!1,columns:[{label:"machine_sn",prop:"machineSn",sort:!0}],editDialogVisible:!1,editType:"edit",editObj:{name:null},allOs:[],allOsVersion:[],allEndPoints:[],fileName:null,websocket:null}},computed:{action:function(){return"/task/upload?fileName="+this.fileName}},destroyed(){this.websocket&&this.websocket.close(),this.refreshTaskPointer&&clearInterval(this.refreshTaskPointer),this.refreshSubTaskPointer&&clearInterval(this.refreshSubTaskPointer)},components:{WorkflowChart:st.a},mounted(){this.getData()},methods:{getSuccessRate(e){let t=JSON.parse(e.graphObjects),a=[];return lt.forIn(t,(function(e,t){"succeeded"==e.state&&a.push(e)})),a.length+"/"+Object.keys(t).length},copy(e){e.preventDefault();var t=JSON.stringify(this.jsonData);let a=document.createElement("input");a.value=t,document.body.appendChild(a),a.select(),document.execCommand("Copy"),a.style.display="none",document.body.removeChild(a),this.$message.success(this.$t("copy_success"))},close(){this.paramVisable=!1},viewParam(e){e?(this.jsonData=JSON.parse(e),this.paramVisable=!0):this.$message.info(this.$t("no_param"))},sortChange(e){e.order?this.queryVO.sort=Object(Le["b"])(e.prop)+" "+e.order.replace("ending",""):delete this.queryVO.sort,this.getData()},cancel(){let e=this.getSelectedIds();e.length?n["a"].post("/task/cancel",e,e=>{e.success?this.$message.success(this.$t("cancel_task_success")):this.$message.error(this.$t("opt_fail"))}):this.$message.error(this.$t("pls_select_")+this.$t("Task")+"!")},notify(e){this.getData(),this.$notify({title:this.$t("server_message"),message:e})},getLogs(){let e=this;n["a"].get("/task/logs?id="+e.editObj.id,{},t=>{if(e.editDialogVisible=!0,e.logs=t.data,e.logs&&e.logs.length){let t=e.logs[e.logs.length-1];n["a"].post("/task/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount}),"START"==t.status&&(this.refreshOne||(this.refreshOne=!0,e.getData((function(){e.editObj=lt.find(e.tableData,t=>t.id==e.editObj.id)})))),"END"==t.status&&(clearInterval(e.refreshSubTaskPointer),e.getData((function(){e.editObj=lt.find(e.tableData,t=>t.id==e.editObj.id)})))}})},getData(e){this.loadingList=!0,n["a"].post("/task/list/"+this.query.pageIndex+"/"+this.query.pageSize,this.queryVO,t=>{let a=this;a.tableData=t.data.listObject,a.pageTotal=t.data.itemCount,a.loadingList=!1,e&&e(),lt.find(t.data.listObject,e=>"running"==e.status||"created"==e.status)?a.refreshTaskPointer||(a.refreshTaskPointer=setInterval(a.getDataNoLoading,3e3)):a.refreshTaskPointer&&clearInterval(a.refreshTaskPointer)})},getDataNoLoading(e){n["a"].post("/task/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},t=>{this.tableData=t.data.listObject,this.pageTotal=t.data.itemCount;let a=this;lt.find(t.data.listObject,e=>"running"==e.status||"created"==e.status)||a.refreshTaskPointer&&clearInterval(a.refreshTaskPointer),e&&e()})},refreshChildData(){this.$refs.device.getData()},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1,window.clearInterval(this.refreshSubTaskPointer)},handleClose2(){this.editDialogVisible2=!1,window.clearInterval(this.refreshSubTaskPointer)},add(){this.editDialogVisible=!0,this.editType="add"},confirmEdit(){},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=lt.map(this.delList,e=>e.id);return e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].post("/task/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData()):this.$message.success(this.$t("delete_fail")),this.multipleSelection=[]},e=>{this.$message.error(e)})}).catch((function(e){this.multipleSelection=[]})):this.$message.error(this.$t("pls_select_task")+"!")},handleEdit(e,t){"edit"==t?(this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e))):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].delete("/task/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})}):"view"==t&&(this.editObj=JSON.parse(JSON.stringify(e)),this.editObj.graphObjects=JSON.parse(this.editObj.graphObjects),this.editDialogVisible2=!0)},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},nt=ot,rt=(a("fb1d"),Object(m["a"])(nt,Ze,et,!1,null,"147db88a",null)),dt=rt.exports,ct=a("714f"),ut=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",on:{"tab-click":e.refreshChildData},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("Plugin"),name:"task"}},[t("div",{staticClass:"container-task"},[t("div",{staticClass:"machine-title"}),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),t("el-table-column",{attrs:{prop:"name",label:e.$t("name"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(a.row.name))])]}}])}),t("el-table-column",{attrs:{prop:"platform",label:e.$t("platform"),align:"left",width:"210"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(a.row.platform))])]}}])}),t("el-table-column",{attrs:{prop:"image",label:e.$t("image"),align:"left",width:"210"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(a.row.image))])]}}])}),t("el-table-column",{attrs:{prop:"platform",label:e.$t("base_instruction"),align:"left",width:"210"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(a.row.baseInstruction))])]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(e._f("dateFormat")(a.row.createTime)))])]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{attrs:{type:"run",tip:e.$t("execute_instruction")},on:{click:function(t){return e.handleEdit(a.row,"view")}}})]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:e.$t("view_plugin"),visible:e.editDialogVisible,direction:"rtl",size:"50%",wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{attrs:{"label-position":"top"}},[t("el-form-item",{attrs:{"label-width":"80px",label:e.$t("base_instruction")}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.editObj.baseInstruction,callback:function(t){e.$set(e.editObj,"baseInstruction",t)},expression:"editObj.baseInstruction"}})],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("close")))])],1)],1)]),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_plugin"):e.$t("add_plugin"),visible:e.instructionVisible,direction:"rtl",size:"100%","with-header":!1,wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.instructionVisible=t}}},[t("Instruction",{staticClass:"drawer-full",attrs:{pluginId:e.currentPluginId},on:{back:e.back}})],1)],1)])],1)},pt=[],mt=function(){var e=this,t=e._self._c;return t("div",[t("el-button",{staticClass:"el-button el-button--default el-button--mini is-plain pointer",on:{click:e.back}},[t("i",{staticClass:"el-icon-back"}),e._v("    "+e._s(e.$t("back"))+" ")]),t("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(e.$t("Instruction")))]),t("div",{staticClass:"container-instruction"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit(null,"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(a){return t("el-table-column",{attrs:{prop:a.prop,label:e.$t(a.label),align:"left",sortable:a.sort}})})),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}}),t("RSButton",{attrs:{type:"run",tip:e.$t("Run")},on:{click:function(t){return e.handleEdit(a.row,"run")}}})]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_instruction"):e.$t("add_instruction"),visible:e.editDialogVisible,direction:"rtl",modal:!0,wrapperClosable:!1,appendToBody:!0,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"form",attrs:{model:e.editObj,rules:e.rules,"label-width":"50px","label-position":e.labelPosition}},[t("el-form-item",{attrs:{label:e.$t("name"),prop:"name"}},[t("el-input",{attrs:{type:"text",autocomplete:"off",maxlength:"30"},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),t("el-form-item",{attrs:{label:e.$t("instruction_content"),prop:"content"}},[t("el-input",{attrs:{type:"textarea",autocomplete:"off",maxlength:"3000",placeholder:"例如：sel clear = ipmitool -I lanplus -H xxx -U xxx -P xxx sel clear,多条命令请换行"},model:{value:e.editObj.content,callback:function(t){e.$set(e.editObj,"content",t)},expression:"editObj.content"}})],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)]),t("el-dialog",{attrs:{title:e.$t("Run"),visible:e.runInstruction,fullscreen:!0,"close-on-click-modal":!1,appendToBody:!0},on:{"update:visible":function(t){e.runInstruction=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.runInstruction=!1}}},[e._v(e._s(e.$t("close")))]),t("el-button",{attrs:{type:"primary",loading:e.runLoading},on:{click:e.runCommands}},[e._v(e._s(e.$t("Run")))])],1)]},proxy:!0}])},[t("div",[t("el-row",[t("el-col",{attrs:{span:10}},[t("div",{staticClass:"instruction-title"},[e._v(e._s(e.$t("select_machine")))]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingBareMetalList,expression:"loadingBareMetalList"}],ref:"bareMetalMultipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.bareMetalData,"header-cell-class-name":"table-header"},on:{"sort-change":function(t){return e.sortChange(t)},"selection-change":e.handleMetalSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),t("el-table-column",{staticStyle:{overflow:"scroll"},attrs:{prop:"machine_model",label:e.$t("machine_model"),align:"left",sortable:"custom",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"rs-nowrap"},[e._v(e._s(a.row.machineModel))])]}}])}),t("el-table-column",{attrs:{prop:"machine_sn",label:e.$t("machine_sn"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.machineSn)+" ")]}}])}),t("el-table-column",{attrs:{prop:"management_ip",label:e.$t("management_ip"),align:"left",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.managementIp)+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:e.$t("input_key_search")},on:{change:function(t){return e.getBareMetalData()}},model:{value:e.queryVO.searchKey,callback:function(t){e.$set(e.queryVO,"searchKey",t)},expression:"queryVO.searchKey"}})]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.bareMetalQuery.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.bareMetalpageTotal},on:{"size-change":e.handleBMSizeChange,"current-change":e.handleBMPageChange}})],1)],1),t("el-col",{attrs:{span:14}},[t("div",{staticClass:"instruction-title"},[e._v(e._s(e.$t("logs")))]),t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelectionLog}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getLogs}},[e._v(e._s(e.$t("refresh")))])],1),t("div",{staticClass:"instruction-logs"},[e.logs.length?t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingLogList,expression:"loadingLogList"}],ref:"multipleLogTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.logs,"header-cell-class-name":"table-header"},on:{"sort-change":function(t){return e.logSortChange(t)},"selection-change":e.handleLogSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left",width:"151px",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.createTime))+" ")]}}],null,!1,3816663554)}),t("el-table-column",{attrs:{prop:"machineModel",label:e.$t("machine_model"),align:"left",width:"151px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{domProps:{innerHTML:e._s(e.getMachineText(a))}})]}}],null,!1,1199766406)}),t("el-table-column",{attrs:{prop:"content",label:e.$t("output"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("codemirror",{attrs:{options:e.options},model:{value:a.row.content,callback:function(t){e.$set(a.row,"content",t)},expression:"scope.row.content"}})]}}],null,!1,2795710380)})],1):e._e()],1)],1)],1)],1)])],1)],1)},_t=[],ht=a("8f94");a("d5e0"),a("0f7c"),a("31c5"),a("05dd");let ft=a("2ef0");var bt={props:["pluginId"],data(){return{options:{tabSize:4,styleActiveLine:!0,lineNumbers:!0,autoCloseTags:!0,line:!0,mode:"text/html",theme:"ambiance"},loadingLogList:!1,runLoading:!1,loadingBareMetalList:!1,bareMetalColumns:[{label:"CPU",prop:"cpu"},{label:"memory",prop:"memory",expandLanguage:"en_US",custom:!0,formatter:function(e){return e?parseInt(e)+" GB":e}},{label:"disk",prop:"disk",custom:!0,formatter:function(e){return e?parseInt(e)/1e3+" TB":e}}],runInstruction:!1,formLabelWidth:"80px",activeName:"instruction",rules:{name:[{validator:P["j"],trigger:"blur",vue:this}],content:[{validator:P["j"],trigger:"blur",vue:this}]},query:{name:"",pageIndex:1,pageSize:10},bareMetalQuery:{name:"",pageIndex:1,pageSize:10},queryVO:{searchKey:null},logQueryVO:{searchKey:null},tableData:[],loadingList:[],multipleSelection:[],multipleMetalSelection:[],multipleLogSelection:[],delList:[],editVisible:!1,customProtocol:!1,labelPosition:"top",pageTotal:0,bareMetalpageTotal:0,idx:-1,id:-1,loading:!1,columns:[{label:"name",prop:"name",sort:!1},{label:"instruction_content",prop:"content",sort:!1}],baremetalColumns:[{label:"name",prop:"name",sort:!0},{label:"instruction_content",prop:"content",sort:!0}],editDialogVisible:!1,editType:"edit",editObj:{name:null},allOs:[],allOsVersion:[],allEndPoints:[],fileName:null,curObj:{},bareMetalData:[],logs:[]}},components:{codemirror:ht["codemirror"]},mounted(){this.getData()},watch:{pluginId(){this.getData()}},methods:{getMachineText(e){if(e.row.machineModel)return e.row.machineModel+"</br>["+e.row.machineSn+"]"},sortChange(e){e.order?this.queryVO.sort=e.prop+" "+e.order.replace("ending",""):delete this.queryVO.sort,this.getBareMetalData()},logSortChange(e){e.order?this.logQueryVO.sort=Object(Le["b"])(e.prop)+" "+e.order.replace("ending",""):delete this.logQueryVO.sort,this.getLogs()},statusFilter(e){return-1==e.status.indexOf("ing")?e.serverId?'<span style="display: inline-block;white-space: nowrap;">'+this.$t("PXE")+" "+this.$t(e.status)+'<i class="el-icon-check" style="color:#55BA23;margin-left:5px;"></i><br>'+this.$t("OBM")+" "+this.$t("info")+(e.outBandList.length>0?'<i class="el-icon-check" style="color:#55BA23;margin-left:5px;"></i>':'<i class="el-icon-close" style="margin-left:5px;color: red;"></i>')+"</span>":'<span style="display: inline-block;white-space: nowrap;">'+this.$t("PXE")+" "+this.$t("status")+'<i class="el-icon-close" style="margin-left:5px;color: red;"></i><br>'+this.$t("OBM")+" "+this.$t("info")+(e.outBandList.length>0?'<i class="el-icon-check" style="color:#55BA23;margin-left:5px;"></i>':'<i class="el-icon-close" style="margin-left:5px;color: red;"></i>')+"</span>":'<span style="display: inline-block;white-space: nowrap;">'+this.$t("PXE")+" "+this.$t(e.status)+"<br>"},filterPower(e,t){return t.power==e},runCommands(){if(!this.getBareMetalSelectedIds().length)return void this.$message(this.$t("pls_select")+this.$t("Bare Metal Server"));let e={bareMetalIds:this.getBareMetalSelectedIds(),id:this.editObj.id};this.runLoading=!0,n["a"].post("instruction/runCommands",e,e=>{e.data&&this.$message.success(this.$t("opt_success")),this.getLogs(),this.runLoading=!1},e=>{this.$message.error(this.$t("opt_fail")),this.getLogs(),this.runLoading=!1})},getLogs(){this.loadingLogList=!0,n["a"].post("instruction/logs?id="+this.editObj.id,this.logQueryVO,e=>{ft.forEach(e.data,e=>{e.content=e.content?e.content.replace(/STDOUT:/g,""):""}),this.logs=e.data,this.loadingLogList=!1})},resizeWith(e){return e.expandLanguage&&e.expandLanguage==localStorage.getItem("lang")?"100px":"90px"},handleChange(e,t,a){console.log(e,t,a)},showMachine(e){e.number&&(this.$emit("queryByRuleId",e.id),this.back())},back(){this.$emit("back")},getData(){this.loadingList=!0,n["a"].post("/instruction/list/"+this.query.pageIndex+"/"+this.query.pageSize,{pluginId:this.pluginId},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},getBareMetalData(){this.loadingBareMetalList=!0,n["a"].post("/bare-metal/list/"+this.bareMetalQuery.pageIndex+"/"+this.bareMetalQuery.pageSize,this.queryVO,e=>{this.bareMetalData=e.data.listObject,this.bareMetalpageTotal=e.data.itemCount,this.loadingBareMetalList=!1})},refreshChildData(){this.$refs.device.getData()},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleBMSizeChange(e){this.bareMetalQuery.pageSize=e,this.handleBMPageChange(this.bareMetalQuery.pageIndex)},handleClose(){this.editDialogVisible=!1},confirmEdit(){if(this.validateResult=!0,this.$refs.form.validate(e=>{e||(this.validateResult=!1)}),!this.validateResult)return;this.loading=!0;let e=JSON.parse(JSON.stringify(this.editObj));e.pluginId=this.pluginId,"edit"==this.editType?n["a"].put("/instruction/update",e,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("edit_success")),this.getData(),this.loading=!1}):n["a"].post("/instruction/add",e,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("add_success")),this.getData(),this.loading=!1})},handleSelectionChange(e){this.multipleSelection=e},handleLogSelectionChange(e){this.multipleLogSelection=e},handleMetalSelectionChange(e){this.multipleMetalSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=ft.map(this.delList,e=>e.id);return e},getSelectedLogIds:function(){this.delList=[].concat(this.multipleLogSelection);let e=ft.map(this.delList,e=>e.id);return e},getBareMetalSelectedIds:function(){let e=[].concat(this.multipleMetalSelection),t=ft.map(e,e=>e.id);return t},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].post("/instruction/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData()):this.$message.success(this.$t("delete_fail"))}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select_instruction")+"!")},delAllSelectionLog(){let e=this.getSelectedLogIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].post("/instruction/delLog",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getLogs()):this.$message.success(this.$t("delete_fail"))}),this.multipleLogSelection=[]}):this.$message.error(this.$t("pls_select_log")+"!")},handleEdit(e,t){"edit"==t?(this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e)),this.resetFields()):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].delete("/instruction/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})}):"run"==t?(this.runInstruction=!0,this.editObj=JSON.parse(JSON.stringify(e)),n["a"].post("/bare-metal/list/"+this.bareMetalQuery.pageIndex+"/"+this.bareMetalQuery.pageSize,this.queryVO,e=>{this.bareMetalData=e.data.listObject,this.bareMetalpageTotal=e.data.itemCount}),this.getLogs()):(this.editDialogVisible=!0,this.editType=t,this.editObj={},this.resetFields())},resetFields(){this.$refs.form&&this.$refs.form.resetFields()},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()},handleBMPageChange(e){this.$set(this.bareMetalQuery,"pageIndex",e),this.getBareMetalData()}}},gt=bt,vt=(a("2513"),Object(m["a"])(gt,mt,_t,!1,null,"4fc50020",null)),yt=vt.exports;let wt=a("2ef0");var $t={data(){return{currentPluginId:null,instructionVisible:!1,queryVO:{},refreshOne:!1,refreshSubTaskPointer:null,refreshTaskPointer:null,logs:[],activeName:"task",rules:{name:[{validator:P["j"],trigger:"blur",vue:this}],startIp:[{validator:P["e"],trigger:"blur",vue:this}],endIp:[{validator:P["e"],trigger:"blur",vue:this}],mask:[{validator:P["e"],trigger:"blur",vue:this}]},query:{name:"",pageIndex:1,pageSize:10},tableData:[],loadingList:[],multipleSelection:[],delList:[],editVisible:!1,labelPosition:"top",pageTotal:0,idx:-1,id:-1,loading:!1,columns:[{label:"machine_sn",prop:"machineSn",sort:!1}],editDialogVisible:!1,editType:"edit",editObj:{name:null},allOs:[],allOsVersion:[],allEndPoints:[],fileName:null,websocket:null}},computed:{action:function(){return"/plugin/upload?fileName="+this.fileName}},destroyed(){this.websocket&&this.websocket.close(),this.refreshTaskPointer&&clearInterval(this.refreshTaskPointer),this.refreshSubTaskPointer&&clearInterval(this.refreshSubTaskPointer)},mounted(){this.getData()},components:{Instruction:yt},methods:{back(){this.instructionVisible=!1},getData(e){this.loadingList=!0,n["a"].post("/plugin/list/"+this.query.pageIndex+"/"+this.query.pageSize,this.queryVO,e=>{let t=this;t.tableData=e.data.listObject,t.pageTotal=e.data.itemCount,t.loadingList=!1})},refreshChildData(){this.$refs.device.getData()},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.instructionVisible=!1,this.editDialogVisible=!1,window.clearInterval(this.refreshSubTaskPointer)},add(){this.editDialogVisible=!0,this.editType="add"},confirmEdit(){},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=wt.map(this.delList,e=>e.id);return e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].post("/plugin/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData()):this.$message.success(this.$t("delete_fail")),this.multipleSelection=[]},e=>{this.$message.error(e)})}).catch((function(e){this.multipleSelection=[]})):this.$message.error(this.$t("pls_select_plugin")+"!")},handleEdit(e,t){"edit"==t?(this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e))):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].delete("/plugin/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})}):"view"==t&&(this.editObj=JSON.parse(JSON.stringify(e)),this.currentPluginId=this.editObj.id,this.instructionVisible=!0)},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},kt=$t,Pt=(a("39d1"),Object(m["a"])(kt,ut,pt,!1,null,"1438d9fc",null)),Ot=Pt.exports,St=function(){var e=this,t=e._self._c;return t("el-tabs",{staticStyle:{width:"100vw","min-width":"1300px"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("switch"),name:"switch"}},[t("div",{staticClass:"machine-title2"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))]),t("el-button",{attrs:{type:"primary",icon:"el-icon-discover"},on:{click:e.openDiscover}},[e._v(e._s(e.$t("Discovery")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"sort-change":function(t){return e.sortChange(t)},"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(a){return t("el-table-column",{attrs:{prop:a.prop,label:e.$t(a.label),align:"left",sortable:"custom",width:e.resizeWith(a)},scopedSlots:e._u([{key:"default",fn:function(i){return[a.custom?e._e():t("span",[e._v(e._s(i.row[a.prop]))]),a.custom?t("span",[e._v(e._s(a.formatter(i.row[a.prop])))]):e._e()]}}],null,!0)})})),t("el-table-column",{attrs:{prop:"vendor",label:e.$t("vendor"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.showVendor(a.row.vendor)}}},[e._v(e._s(e.$t("show")))])]}}])}),t("el-table-column",{attrs:{prop:"active_ports",label:e.$t("active_ports"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.showActivePorts(a.row.id)}}},[e._v(e._s(e.$t("show")))])]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"updateTime",label:e.$t("update_time"),align:"left",width:"170px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.updateTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:e.$t("input_key_search_switch")},on:{change:function(t){return e.getData()}},model:{value:e.queryVO.searchKey,callback:function(t){e.$set(e.queryVO,"searchKey",t)},expression:"queryVO.searchKey"}})]}},{key:"default",fn:function(e){}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1)],1),t("el-dialog",{attrs:{title:e.$t("view_vendor"),visible:e.showVendorVisible,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.showVendorVisible=t}}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("span",[e._v(e._s(e.currentVendor)+" ")])])],1)],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_discovery"):e.$t("add_discovery"),visible:e.discoveryVisible,direction:"rtl",size:"100%","with-header":!1,wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.discoveryVisible=t}}},[t("Discovery",{ref:"discoveryCom",staticClass:"bare-discovery",on:{back:function(t){e.discoveryVisible=!1},queryByRuleId:e.queryByRuleId}})],1),t("drawer",{attrs:{visible:e.detailDrawer,direction:"rtl","with-header":!1,size:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.detailDrawer=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-tabs",{model:{value:e.detailShowName,callback:function(t){e.detailShowName=t},expression:"detailShowName"}},[t("el-tab-pane",{staticClass:"detail-pane",attrs:{label:e.$t("port_detail"),name:"portDetail"}},[t("table",{staticClass:"detail-info"},[t("tr",[t("td",[e._v(e._s(e.$t("port")))]),t("td",[e._v(e._s(e.$t("mac")))]),t("td",[e._v(e._s(e.$t("switch_name")))]),t("td",[e._v(e._s(e.$t("Bare Metal Server")+e.$t("machine_brand")))]),t("td",[e._v(e._s(e.$t("Bare Metal Server")+e.$t("machine_model")))]),t("td",[e._v(e._s(e.$t("Bare Metal Server")+e.$t("machine_sn")))]),t("td",[e._v(e._s(e.$t("OBM")))]),t("td",[e._v(e._s(e.$t("create_time")))]),t("td",[e._v(e._s(e.$t("update_time")))])]),e._l(e.switchPorts,(function(a){return t("tr",[t("td",[e._v(e._s(a.port))]),t("td",[e._v(e._s(a.mac))]),t("td",[e._v(e._s(a.switchName))]),t("td",[e._v(e._s(a.machineBrand))]),t("td",[e._v(e._s(a.machineModel))]),t("td",[e._v(e._s(a.machineSn))]),t("td",[e._v(e._s("no"==a.outband?e.$t("disabled"):e.$t("enabled")))]),t("td",[e._v(e._s(e._f("dateFormat")(a.createTime)))]),t("td",[e._v(e._s(e._f("dateFormat")(a.updateTime)))])])}))],2)])],1)],1)])],1)},Lt=[],Dt=a("e16b"),It=Dt["a"],Ct=(a("8321"),Object(m["a"])(It,St,Lt,!1,null,"353277a7",null)),xt=Ct.exports,Et=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("profile"),name:"profile"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),t("el-table-column",{attrs:{prop:"id",label:e.$t("id"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$t(t.row.id))+" ")]}}])}),t("el-table-column",{attrs:{prop:"name",label:e.$t("name"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$t(t.row.name))+" ")]}}])}),t("el-table-column",{attrs:{prop:"type",label:e.$t("type"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$t(t.row.type))+" ")]}}])}),t("el-table-column",{attrs:{prop:"updateTime",label:e.$t("update_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.updateTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),"system"!=a.row.type?t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}}):e._e(),t("RSButton",{attrs:{type:"copy",tip:e.$t("copy")},on:{click:function(t){return e.handleEdit(a.row,"copy")}}})]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_profile"):e.$t("add_profile"),visible:e.editDialogVisible,wrapperClosable:!1,size:"50%",direction:"rtl","before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"editForm",attrs:{model:e.editObj,labelPosition:"top",rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:e.$t("name"),prop:"name"}},[t("el-input",{staticClass:"input-element",attrs:{autocomplete:"off",minlength:"3",maxlength:"30",placeholder:e.$t("pls_input_param_value")},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),"edit"==e.editType?t("el-form-item",{attrs:{label:e.$t("type"),prop:"type"}},[t("el-select",{staticClass:"input-element",attrs:{disabled:""},model:{value:e.editObj.type,callback:function(t){e.$set(e.editObj,"type",t)},expression:"editObj.type"}},e._l(e.types,(function(a){return t("el-option",{attrs:{label:e.$t(a.name),value:a.value}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:e.$t("content"),prop:"content"}},[t("el-input",{attrs:{type:"textarea",rows:20},model:{value:e.editObj.content,callback:function(t){e.$set(e.editObj,"content",t)},expression:"editObj.content"}})],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)])],1)},Tt=[];const Nt={types:[{name:"system",value:"system"},{name:"user",value:"user"}]};let Rt=a("2ef0");var Mt={data(){return{rules:{name:[{validator:P["j"],trigger:"blur",vue:this}],content:[{validator:P["j"],trigger:"blur",vue:this}]},activeName:"profile",query:{name:"",pageIndex:1,pageSize:10},types:Nt.types,tableData:[],multipleSelection:[],delList:[],editVisible:!1,pageTotal:0,form:{},idx:-1,id:-1,loading:!1,editDialogVisible:!1,editType:"edit",editObj:{name:null,description:null,type:null},allOs:[],allOsVersion:[],allprofileType:[],loadingList:[]}},mounted(){this.getData()},methods:{getData(){this.loadingList=!0,n["a"].post("/profile/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=Rt.map(this.delList,e=>e.id);return e},confirmEdit(){this.validateResult=!0,this.$refs.editForm.validate(e=>{e||(this.validateResult=!1)}),this.validateResult&&(this.loading=!0,this.editObj.brands=JSON.stringify(this.editObj.brands),"edit"==this.editType?n["a"].put("/profile/update",this.editObj,e=>{e.data?(this.editDialogVisible=!1,this.editObj.defaultParams=JSON.stringify(this.editObj.defaultParams),this.$message.success(this.$t("edit_success")),this.getData(),this.loading=!1):(this.$message.error(this.$t("opt_fail")),this.loading=!1)},e=>{this.$message.error(this.$t("opt_fail")),this.loading=!1}):n["a"].post("/profile/add",this.editObj,e=>{e.data?(this.$message.success(this.$t("add_success")),this.editDialogVisible=!1):this.$message.error(this.$t(e.message)),this.getData(),this.loading=!1},e=>{this.$message.error(this.$t("opt_fail")),this.loading=!1}))},handleSelectionChange(e){this.multipleSelection=e},delAllSelection(){let e=[],t=this.delList=[].concat(this.multipleSelection);if(Rt.forEach(t,t=>{"system"==t.type&&e.push(t)}),e.length>0)return void this.$message.error(this.$t("delete_fail"));let a=this.getSelectedIds();a&&0!=a.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].post("/profile/del",a,e=>{e.data?this.$message.success(this.$t("delete_success")):this.$message.error(this.$t("delete_fail")),this.getData()}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select")+this.$t("profile")+"!")},handleEdit(e,t){if("edit"==t)this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e)),this.resetFields();else if("del"==t){if("system"==e.type)return void this.$message.error(this.$t("delete_fail"));this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].delete("/profile/del/"+e.id,{},e=>{e.data?this.$message.success(this.$t("delete_success")):this.$message.error(this.$t("delete_fail")),this.getData()})})}else"copy"==t?(this.editDialogVisible=!0,this.editType=t,this.resetFields(),this.editObj=JSON.parse(JSON.stringify(e)),this.editObj.type="user",delete this.editObj.id,this.resetFields()):(this.editDialogVisible=!0,this.editType=t,this.resetFields(),this.editObj={})},resetFields(){this.$refs.editForm&&this.$refs.editForm.resetFields()},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},jt=Mt,At=(a("99cb"),Object(m["a"])(jt,Et,Tt,!1,null,"6c38d1bf",null)),Bt=At.exports,Wt=function(){var e=this,t=e._self._c;return t("el-tabs",{staticClass:"t100vw",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("template"),name:"template"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),t("el-table-column",{attrs:{prop:"id",label:e.$t("id"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$t(t.row.id))+" ")]}}])}),t("el-table-column",{attrs:{prop:"name",label:e.$t("name"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$t(t.row.name))+" ")]}}])}),t("el-table-column",{attrs:{prop:"type",label:e.$t("type"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$t(t.row.type))+" ")]}}])}),t("el-table-column",{attrs:{prop:"updateTime",label:e.$t("update_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.updateTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),"system"!=a.row.type?t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}}):e._e(),t("RSButton",{attrs:{type:"copy",tip:e.$t("copy")},on:{click:function(t){return e.handleEdit(a.row,"copy")}}})]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_template"):e.$t("add_template"),visible:e.editDialogVisible,wrapperClosable:!1,size:"50%",direction:"rtl","before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"editForm",attrs:{model:e.editObj,labelPosition:"top",rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:e.$t("name"),prop:"name"}},[t("el-input",{staticClass:"input-element",attrs:{autocomplete:"off",min:"3",max:"30",placeholder:e.$t("pls_input_param_value")},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),"edit"==e.editType?t("el-form-item",{attrs:{label:e.$t("type"),prop:"type"}},[t("el-select",{staticClass:"input-element",attrs:{disabled:""},model:{value:e.editObj.type,callback:function(t){e.$set(e.editObj,"type",t)},expression:"editObj.type"}},e._l(e.types,(function(a){return t("el-option",{attrs:{label:e.$t(a.name),value:a.value}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:e.$t("content"),prop:"content"}},[t("el-input",{attrs:{type:"textarea",rows:20},model:{value:e.editObj.content,callback:function(t){e.$set(e.editObj,"content",t)},expression:"editObj.content"}})],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)])],1)},Vt=[];let zt=a("2ef0");var Ut={data(){return{rules:{name:[{validator:P["j"],trigger:"blur",vue:this}],content:[{validator:P["j"],trigger:"blur",vue:this}]},activeName:"template",query:{name:"",pageIndex:1,pageSize:10},types:Nt.types,tableData:[],multipleSelection:[],delList:[],editVisible:!1,pageTotal:0,form:{},idx:-1,id:-1,loading:!1,editDialogVisible:!1,editType:"edit",editObj:{name:null,description:null,type:null},allOs:[],allOsVersion:[],alltemplateType:[],loadingList:[]}},mounted(){this.getData()},methods:{getData(){this.loadingList=!0,n["a"].post("/template/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=zt.map(this.delList,e=>e.id);return e},confirmEdit(){this.validateResult=!0,this.$refs.editForm.validate(e=>{e||(this.validateResult=!1)}),this.validateResult&&(this.loading=!0,this.editObj.brands=JSON.stringify(this.editObj.brands),"edit"==this.editType?n["a"].put("/template/update",this.editObj,e=>{e.data?(this.editDialogVisible=!1,this.editObj.defaultParams=JSON.stringify(this.editObj.defaultParams),this.$message.success(this.$t("edit_success")),this.getData(),this.loading=!1):(this.$message.error(this.$t("opt_fail")),this.loading=!1)}):n["a"].post("/template/add",this.editObj,e=>{e.data?(this.$message.success(this.$t("add_success")),this.editDialogVisible=!1):this.$message.error(this.$t(e.message)),this.getData(),this.loading=!1}))},handleSelectionChange(e){this.multipleSelection=e},delAllSelection(){let e=[],t=this.delList=[].concat(this.multipleSelection);if(zt.forEach(t,t=>{"system"==t.type&&e.push(t)}),e.length>0)return void this.$message.error(this.$t("delete_fail"));let a=this.getSelectedIds();a&&0!=a.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].post("/template/del",a,e=>{e.data?this.$message.success(this.$t("delete_success")):this.$message.error(this.$t("delete_fail")),this.getData()}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select")+this.$t("template")+"!")},handleEdit(e,t){if("edit"==t)this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e)),this.resetFields();else if("del"==t){if("system"==e.type)return void this.$message.error(this.$t("delete_fail"));this.$confirm(this.$t("confirm_to_del")+this.$t("template"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].delete("/template/del/"+e.id,{},e=>{e.data?this.$message.success(this.$t("delete_success")):this.$message.error(this.$t("delete_fail")),this.getData()})})}else"copy"==t?(this.editDialogVisible=!0,this.editType=t,this.resetFields(),this.editObj=JSON.parse(JSON.stringify(e)),this.editObj.type="user",delete this.editObj.id,this.resetFields()):(this.editDialogVisible=!0,this.editType=t,this.resetFields(),this.editObj={})},resetFields(){this.$refs.editForm&&this.$refs.editForm.resetFields()},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},qt=Ut,Ft=(a("f7c7"),Object(m["a"])(qt,Wt,Vt,!1,null,"69e1eefe",null)),Kt=Ft.exports,Ht=function(){var e=this,t=e._self._c;return t("el-tabs",{staticStyle:{width:"100vw","min-width":"1300px"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("SystemParameter"),name:"systemParameter"}},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(e){return t("el-table-column",{attrs:{prop:e.prop,label:e.label,align:"left",sortable:e.sort}})})),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}})]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_system_parameter"):e.$t("add_system_parameter"),visible:e.editDialogVisible,direction:"rtl",wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{attrs:{model:e.editObj}},[t("el-form-item",{attrs:{label:e.$t("param_key")}},[t("el-input",{attrs:{autocomplete:"off",disabled:"edit"==e.editType,placeholder:e.$t("pls_input")+e.$t("param_key")},model:{value:e.editObj.paramKey,callback:function(t){e.$set(e.editObj,"paramKey",t)},expression:"editObj.paramKey"}})],1),t("el-form-item",{attrs:{label:e.$t("param_value")}},[t("el-input",{attrs:{type:"textarea",rows:10,cols:20,autocomplete:"off",placeholder:e.$t("pls_input_param_value")},model:{value:e.editObj.paramValue,callback:function(t){e.$set(e.editObj,"paramValue",t)},expression:"editObj.paramValue"}})],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)],1)},Jt=[];let Xt=a("2ef0");var Gt={data(){return{activeName:"systemParameter",query:{name:"",pageIndex:1,pageSize:10},tableData:[],loadingList:!1,multipleSelection:[],delList:[],editVisible:!1,pageTotal:0,form:{},idx:-1,id:-1,loading:!1,columns:[{label:this.$t("param_key"),prop:"paramKey",sort:!0},{label:this.$t("param_value"),prop:"paramValue"},{label:this.$t("desc"),prop:"des"}],editDialogVisible:!1,editType:"edit",editObj:{name:null,description:null,type:null},allOs:[],allOsVersion:[],allEndPointType:[]}},mounted(){this.getData()},methods:{getData(){this.loadingList=!0,n["a"].post("/system_parameter/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=Xt.map(this.delList,e=>e.paramKey);return e},confirmEdit(){this.loading=!0,this.editObj.brands=JSON.stringify(this.editObj.brands),"edit"==this.editType?n["a"].put("/system_parameter/update",this.editObj,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("edit_success")),this.getData(),this.loading=!1}):n["a"].post("/system_parameter/add",this.editObj,e=>{this.editDialogVisible=!1,e.data?this.$message.success(this.$t("add_success")):this.$message.error(this.$t("add_fail")),this.getData(),this.loading=!1})},handleSelectionChange(e){this.multipleSelection=e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].post("/system_parameter/del",e,e=>{this.$message.success(this.$t("delete_success")),this.getData()}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select_system_parameter")+"!")},handleEdit(e,t){"edit"==t?(this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e))):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{n["a"].delete("/system_parameter/del/"+e.paramKey,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})}):(this.editDialogVisible=!0,this.editType=t,this.editObj={})},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},Yt=Gt,Qt=(a("5fec"),Object(m["a"])(Yt,Ht,Jt,!1,null,"1b488992",null)),Zt=Qt.exports;i["default"].use(B["a"]);const ea=[{path:"/",redirect:"/bare-metal"},{path:"/login",component:F},{path:"/index",component:Y},{path:"/role",component:se},{path:"/user",component:ue},{path:"/bare-metal",component:be},{path:"/image",component:Pe},{path:"/network",component:Ee},{path:"/obm",component:ct["a"]},{path:"/plugin",component:Ot},{path:"/execution-log",component:Be},{path:"/workflow",component:Fe},{path:"/endpoint",component:Ye},{path:"/discovery",component:Qe["a"]},{path:"/task",component:dt},{path:"/switch",component:xt},{path:"/profile",component:Bt},{path:"/template",component:Kt},{path:"/SystemParameter",component:Zt}],ta=new B["a"]({routes:ea}),aa=B["a"].prototype.push;B["a"].prototype.push=function(e){return aa.call(this,e).catch(e=>e)},ta.beforeEach((e,t,a)=>{"/login"!=e.path?"true"===localStorage.getItem("login")?a():ta.push("login"):a()});var ia=ta,sa=a("0692"),la=a("b90d"),oa=a("5c96"),na=a.n(oa),ra=function(){var e=this,t=e._self._c;return t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.getContent(),placement:"bottom-end"}},[t("el-button",{class:e.typeClass,staticStyle:{cursor:"pointer","font-size":"12px"},attrs:{type:"button",icon:e.icon,circle:""},on:{click:e.handleEdit},scopedSlots:e._u([{key:"default",fn:function(){},proxy:!0}])})],1)},da=[],ca={name:"RSButton",props:{type:{type:String,default(){return"edit"}},tip:{type:String}},computed:{typeClass(){switch(this.type){case"add":return"el-button";case"edit":return"el-button";case"del":return"el-button--danger";case"sync":return"el-button--success";case"copy":return"el-button--success";default:return"el-button"}},icon(){switch(this.type){case"edit":return"el-icon-edit";case"del":return"el-icon-delete";case"sync":return"el-icon-refresh";case"view":return"el-icon-view";case"run":return"el-icon-caret-right";case"add":return"el-icon-plus";case"copy":return"el-icon-plus";default:return""}}},methods:{handleEdit(e,t){this.$emit("click",e,t)},getContent(){if(this.tip)return this.tip;switch(this.type){case"add":return this.$t("add");case"edit":return this.$t("edit");case"del":return this.$t("del");case"sync":return this.$t("sync");case"view":return this.$t("view");case"run":return this.$t("run");case"copy":return this.$t("copy");default:return""}}}},ua=ca,pa=Object(m["a"])(ua,ra,da,!1,null,"167f50e5",null),ma=pa.exports;const _a={install:function(){i["default"].component("RSButton",ma)}};var ha=_a,fa=a("ecee"),ba=a("c074"),ga=a("b702"),va=a("f2d1"),ya=a("ad3d"),wa={install(e){fa["c"].add(ba["a"],ga["a"],va["a"]),e.component("font-awesome-icon",ya["a"])}},$a=function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"el-drawer-fade"},on:{"after-enter":e.afterEnter,"after-leave":e.afterLeave}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"el-drawer__wrapper",attrs:{tabindex:"-1"}},[t("div",{staticClass:"el-drawer__container",class:e.visible&&"el-drawer__open",attrs:{role:"document",tabindex:"-1"},on:{click:function(t){return t.target!==t.currentTarget?null:e.handleWrapperClick.apply(null,arguments)}}},[t("div",{ref:"drawer",staticClass:"el-drawer",class:[e.direction,e.customClass],style:e.isHorizontal?"width: "+e.size:"height: "+e.size,attrs:{"aria-modal":"true","aria-labelledby":"el-drawer__title","aria-label":e.title,role:"dialog",tabindex:"-1"}},[e.withHeader?t("header",{staticClass:"el-drawer__header",attrs:{id:"el-drawer__title"}},[e._t("title",(function(){return[t("span",{attrs:{role:"heading",tabindex:"0",title:e.title}},[e._v(e._s(e.title))])]})),e.showClose?t("button",{staticClass:"el-drawer__close-btn",attrs:{"aria-label":"close "+(e.title||"drawer"),type:"button"},on:{click:e.closeDrawer}},[t("i",{staticClass:"el-dialog__close el-icon el-icon-close"})]):e._e()],2):e._e(),e.rendered?t("section",{staticClass:"el-drawer__body"},[e._t("default")],2):e._e()])])])])},ka=[],Pa=a("03a5"),Oa=a("f6f4"),Sa={name:"Drawer",mixins:[Pa["a"],Oa["a"]],props:{appendToBody:{type:Boolean,default:!1},beforeClose:{type:Function},customClass:{type:String,default:""},closeOnPressEscape:{type:Boolean,default:!0},destroyOnClose:{type:Boolean,default:!1},modal:{type:Boolean,default:!0},direction:{type:String,default:"rtl",validator(e){return-1!==["ltr","rtl","ttb","btt"].indexOf(e)}},modalAppendToBody:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},size:{type:String,default:"30%"},title:{type:String,default:""},visible:{type:Boolean},wrapperClosable:{type:Boolean,default:!0},withHeader:{type:Boolean,default:!0}},computed:{isHorizontal(){return"rtl"===this.direction||"ltr"===this.direction}},data(){return{closed:!1,prevActiveElement:null}},watch:{visible(e){e?(this.closed=!1,this.$emit("open"),this.appendToBody&&document.body.appendChild(this.$el),this.prevActiveElement=document.activeElement):this.closed||this.$emit("close")}},methods:{afterEnter(){this.$emit("opened")},afterLeave(){this.$emit("closed")},hide(e){!1!==e&&(this.$emit("update:visible",!1),this.$emit("close"),!0===this.destroyOnClose&&(this.rendered=!1),this.closed=!0)},handleWrapperClick(){this.wrapperClosable&&this.closeDrawer()},closeDrawer(){"function"===typeof this.beforeClose?this.beforeClose(this.hide):this.hide()},handleClose(){this.closeDrawer()}},mounted(){this.visible&&(this.rendered=!0,this.open())},destroyed(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},La=Sa,Da=Object(m["a"])(La,$a,ka,!1,null,null,null),Ia=Da.exports;Ia.install=function(e){e.component(Ia.name,Ia)};var Ca=Ia;a("a83d");i["default"].use(ha),i["default"].use(wa),i["default"].use(Ca),i["default"].filter("dateFormat",la["b"]),i["default"].filter("brandsFormat",la["a"]),i["default"].filter("endpointFormat",la["c"]),sa["default"].locale=localStorage.getItem("lang")||"zh_CN",i["default"].use(na.a,{i18n:(e,t)=>sa["default"].t(e,t)}),i["default"].use(oa["Pagination"]),i["default"].use(oa["Dialog"]),i["default"].use(oa["Autocomplete"]),i["default"].use(oa["Dropdown"]),i["default"].use(oa["DropdownMenu"]),i["default"].use(oa["DropdownItem"]),i["default"].use(oa["Menu"]),i["default"].use(oa["Submenu"]),i["default"].use(oa["MenuItem"]),i["default"].use(oa["MenuItemGroup"]),i["default"].use(oa["Input"]),i["default"].use(oa["InputNumber"]),i["default"].use(oa["Radio"]),i["default"].use(oa["RadioGroup"]),i["default"].use(oa["RadioButton"]),i["default"].use(oa["Checkbox"]),i["default"].use(oa["CheckboxButton"]),i["default"].use(oa["CheckboxGroup"]),i["default"].use(oa["Switch"]),i["default"].use(oa["Select"]),i["default"].use(oa["Option"]),i["default"].use(oa["OptionGroup"]),i["default"].use(oa["Button"]),i["default"].use(oa["ButtonGroup"]),i["default"].use(oa["Table"]),i["default"].use(oa["TableColumn"]),i["default"].use(oa["DatePicker"]),i["default"].use(oa["TimeSelect"]),i["default"].use(oa["TimePicker"]),i["default"].use(oa["Popover"]),i["default"].use(oa["Tooltip"]),i["default"].use(oa["Breadcrumb"]),i["default"].use(oa["BreadcrumbItem"]),i["default"].use(oa["Form"]),i["default"].use(oa["FormItem"]),i["default"].use(oa["Tabs"]),i["default"].use(oa["TabPane"]),i["default"].use(oa["Tag"]),i["default"].use(oa["Tree"]),i["default"].use(oa["Alert"]),i["default"].use(oa["Slider"]),i["default"].use(oa["Icon"]),i["default"].use(oa["Row"]),i["default"].use(oa["Col"]),i["default"].use(oa["Upload"]),i["default"].use(oa["Progress"]),i["default"].use(oa["Spinner"]),i["default"].use(oa["Badge"]),i["default"].use(oa["Card"]),i["default"].use(oa["Rate"]),i["default"].use(oa["Steps"]),i["default"].use(oa["Step"]),i["default"].use(oa["Carousel"]),i["default"].use(oa["CarouselItem"]),i["default"].use(oa["Collapse"]),i["default"].use(oa["CollapseItem"]),i["default"].use(oa["Cascader"]),i["default"].use(oa["ColorPicker"]),i["default"].use(oa["Transfer"]),i["default"].use(oa["Container"]),i["default"].use(oa["Header"]),i["default"].use(oa["Aside"]),i["default"].use(oa["Main"]),i["default"].use(oa["Footer"]),i["default"].use(oa["Timeline"]),i["default"].use(oa["TimelineItem"]),i["default"].use(oa["Link"]),i["default"].use(oa["Divider"]),i["default"].use(oa["Image"]),i["default"].use(oa["Calendar"]),i["default"].use(oa["Backtop"]),i["default"].use(oa["PageHeader"]),i["default"].use(oa["CascaderPanel"]),i["default"].use(oa["Loading"].directive),i["default"].prototype.$loading=oa["Loading"].service,i["default"].prototype.$msgbox=oa["MessageBox"],i["default"].prototype.$alert=oa["MessageBox"].alert,i["default"].prototype.$confirm=oa["MessageBox"].confirm,i["default"].prototype.$prompt=oa["MessageBox"].prompt,i["default"].prototype.$message=oa["Notification"],i["default"].prototype.$message=oa["Message"],i["default"].config.productionTip=!1,new i["default"]({router:ia,i18n:sa["default"],render:e=>e(A)}).$mount("#app")},"5ca6":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"form",attrs:{"label-width":"130px",rules:e.rules,model:e.payLoad.options.defaults,"label-position":"right"}},[t("el-row",[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:e.$t("hostname"),prop:"hostname"}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"20"},model:{value:e.payLoad.options.defaults.hostname,callback:function(t){e.$set(e.payLoad.options.defaults,"hostname",t)},expression:"payLoad.options.defaults.hostname"}})],1),t("el-form-item",{attrs:{label:e.$t("root_pwd"),prop:"rootPassword"}},[t("el-input",{attrs:{value:e.$t("ubuntu_pwd"),autocomplete:"off",maxlength:"20",disabled:""}})],1),t("el-form-item",{attrs:{label:e.$t("image"),prop:"repo"}},[t("el-select",{staticClass:"input-element",attrs:{filterable:"","allow-create":"","default-first-option":""},on:{change:e.setISOUrl},model:{value:e.payLoad.options.defaults.repo,callback:function(t){e.$set(e.payLoad.options.defaults,"repo",t)},expression:"payLoad.options.defaults.repo"}},e._l(e.allImages,(function(e){return t("el-option",{attrs:{label:e.name,value:e.url}})})),1)],1)],1),t("el-col",{attrs:{span:13}},[t("el-form-item",{attrs:{label:e.$t("network_card")}},[t("RSButton",{attrs:{type:"add",tip:e.$t("add_network_card")},on:{click:e.addNet}}),t("el-collapse",{model:{value:e.nicActiveNames,callback:function(t){e.nicActiveNames=t},expression:"nicActiveNames"}},e._l(e.payLoad.options.defaults.networkDevices,(function(a,i){return t("el-collapse-item",{attrs:{title:e.getNetworkName(a),name:i+""}},[t("RSButton",{attrs:{type:"del",tip:e.$t("del_network_card")},on:{click:function(t){return e.delNet(i)}}}),t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:a,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"device",label:e.$t("pls_select_")+e.$t("network_card")}},[t("el-select",{staticClass:"input-element",model:{value:a.device,callback:function(t){e.$set(a,"device",t)},expression:"d.device"}},e._l(e.nics,(function(a){return t("el-option",{attrs:{value:a.mac}},[t("span",[e._v(" "+e._s(a.number+"("+a.mac+")")+" "),a.pxe?t("span",{staticStyle:{color:"red"}},[e._v(e._s(" "+e.$t("is_pxe")))]):e._e()])])})),1)],1),t("el-form",{ref:"nic2Form",refInFor:!0,attrs:{model:a.ipv4,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"ipAddr",label:e.$t("ip_addr")}},[t("el-input",{model:{value:a.ipv4.ipAddr,callback:function(t){e.$set(a.ipv4,"ipAddr",t)},expression:"d.ipv4.ipAddr"}})],1),t("el-form-item",{attrs:{prop:"gateway",label:e.$t("gateway")}},[t("el-input",{model:{value:a.ipv4.gateway,callback:function(t){e.$set(a.ipv4,"gateway",t)},expression:"d.ipv4.gateway"}})],1),t("el-form-item",{attrs:{prop:"netmask",label:e.$t("netmask")}},[t("el-input",{model:{value:a.ipv4.netmask,callback:function(t){e.$set(a.ipv4,"netmask",t)},expression:"d.ipv4.netmask"}})],1)],1)],1)],1)})),1)],1),t("el-form-item",{attrs:{label:e.$t("DNS"),prop:"dnsServers"}},[t("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.payLoad.options.defaults.dnsServers,callback:function(t){e.$set(e.payLoad.options.defaults,"dnsServers",t)},expression:"payLoad.options.defaults.dnsServers"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}}),t("el-col",{attrs:{span:12}})],1)],1)],1)},s=[],l=(a("14d9"),a("b35c")),o=a("619f"),n=a("30d1");let r=a("2ef0");var d={activated(){},created(){},deactivated(){},data(){return{objs:[],nicActiveNames:"0",switchActiveNames:"switch0",rules:{hostname:[{validator:n["d"],trigger:"blur",vue:this}],dnsServers:[{validator:n["a"],trigger:"change",vue:this}],ntp:[{validator:n["a"],trigger:"blur",vue:this}],rootPassword:[{validator:n["j"],trigger:"blur",vue:this}],repo:[{validator:n["h"],trigger:"blur",vue:this,name:"image"}]},nicRules:{device:[{validator:n["i"],trigger:"blur",vue:this,name:"device"}],ipAddr:[{validator:n["e"],trigger:"blur",vue:this}],netmask:[{validator:n["e"],trigger:"blur",vue:this}],gateway:[{validator:n["e"],trigger:"blur",vue:this}],vlanIds:[{validator:n["k"],trigger:"change",vue:this,require:!1}]},uefi:!1,defaultPayLoad:{options:{defaults:{version:"bionic",osName:"ubuntu",repo:null,baseUrl:"install/netboot/ubuntu-installer/amd64",rootPassword:"root",hostname:"rackhd-node",domain:"example.com",dnsServers:["172.12.88.91","192.168.20.77"],networkDevices:[{device:null,ipv4:{ipAddr:"192.168.1.29",gateway:"192.168.1.1",netmask:"255.255.255.0",vlanIds:[104,105]}}],kvm:!0,timezone:"UTC",ntp:"192.168.1.21",installDisk:"/dev/sda",installPartitions:[{mountPoint:"/",size:"auto",fsType:"ext3"},{mountPoint:"swap",size:"4096",fsType:"swap"},{mountPoint:"/boot",size:"4096",fsType:"ext3"}]}}},payLoad:this.$attrs.params,extraParams:this.$attrs.extraParams?JSON.parse(JSON.stringify(this.$attrs.extraParams)):{unit:"MB"},allImages:[],cpus:[],memories:[],disks:[],nics:[],units:["GB","MB"],fsType:["ext3","ext4","swap","xfs","biosboot"],validateResult:!1}},mounted(){this.getAllImage(),this.getHardware(),this.$watch("extraParams.unit",(function(e,t){if("GB"==t&&"MB"==e)for(var a=0;a<this.payLoad.options.defaults.installPartitions.length&&"biosboot"!=this.payLoad.options.defaults.installPartitions[a].mountPoint;a++)/\d+/.test(this.payLoad.options.defaults.installPartitions[a].size)&&(this.payLoad.options.defaults.installPartitions[a].size=1024*this.payLoad.options.defaults.installPartitions[a].size+"");else if("MB"==t&&"GB"==e)for(a=0;a<this.payLoad.options.defaults.installPartitions.length&&"biosboot"!=this.payLoad.options.defaults.installPartitions[a].mountPoint;a++)/\d+/.test(this.payLoad.options.defaults.installPartitions[a].size)&&(this.payLoad.options.defaults.installPartitions[a].size=parseInt(this.payLoad.options.defaults.installPartitions[a].size/1024)+"");this.extraParams.unit=e}))},methods:{setISOUrl:function(e){let t=r.find(this.allImages,t=>t.url==e);t&&t.url?this.payLoad.options.defaults.isoUrl=t.url.substr(0,t.url.lastIndexOf("/"))+"/"+t.originalName:this.payLoad.options.defaults.isoUrl=t.url,console.log(JSON.stringify(t))},changeUefiBoot:function(){if(this.extraParams.uefi){if(this.payLoad.options.defaults.installPartitions){let e=r.findIndex(this.payLoad.options.defaults.installPartitions,(function(e){return"/boot/efi"==e.mountPoint}));-1==e&&this.payLoad.options.defaults.installPartitions.push({mountPoint:"/boot/efi",size:"200",fsType:"vfat"}),e=r.findIndex(this.payLoad.options.defaults.installPartitions,(function(e){return"biosboot"==e.mountPoint})),-1!==e&&this.payLoad.options.defaults.installPartitions.splice(e,1)}}else{let e=r.findIndex(this.payLoad.options.defaults.installPartitions,(function(e){return"/boot/efi"==e.mountPoint}));-1!=e&&this.payLoad.options.defaults.installPartitions.splice(e,1)}console.table(this.payLoad.options.defaults.installPartitions)},changeInt(e){let t=[];e.ipv4.vlanIds.forEach(e=>t.push(Number(e))),e.ipv4.vlanIds=t},getNetworkName(e){return e.device?this.$t("network_card_mac")+" "+e.device:this.$t("network_card_mac")},delNet(e){this.payLoad.options.defaults.networkDevices.length-1>0&&this.payLoad.options.defaults.networkDevices.splice(e,1)},addNet(){0!=this.nics.length?this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length==this.nics.length?this.$message.warning(this.$t("cannot_add_more")):this.payLoad.options.defaults.networkDevices.push({device:null,ipv4:{ipAddr:"192.168.1.10",gateway:"192.168.1.1",netmask:"255.255.255.0"}}):this.$message.warning(this.$t("nic_not_found"))},restoreParams:function(){this.restorePartition()},restorePartition:function(){this.payLoad=JSON.parse(JSON.stringify(this.defaultPayLoad)),this.getAllImage()},valid:function(){this.validateResult=!0;let e=this;if(this.$refs["form"].validate(t=>{t?(e.$refs["nicForm"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})}),e.$refs["nic2Form"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})})):e.validateResult=!1}),!e.validateResult)return void this.$message.error(this.$t("param_check_error"));let t=this.payLoad.options.defaults.hostname,a=this.payLoad.options.defaults.rootPassword,i=this.payLoad.options.defaults.networkDevices[0].device,s=this.payLoad.options.defaults.networkDevices[0].ipv4.ipAddr,l=this.payLoad.options.defaults.networkDevices[0].ipv4.gateway,n=this.payLoad.options.defaults.networkDevices[0].ipv4.netmask;if(Object(o["c"])(t,a,i,s,l,n))return this.$message.error(this.$t("param_cannot_be_null!")),!1;if(/[^0-9a-zA-Z\-]+/.test(t))return this.$message.error(this.$t("hostname_must_not_have_invalid_word!")),!1;let d=0;for(let o=0;o<this.payLoad.options.defaults.installPartitions.length;o++){let e=this.payLoad.options.defaults.installPartitions[o];e.mountPoint||(this.$message.error(this.$t("i18n_mount_point_cant_be_null")),this.validateResult=!1),e.size||(this.$message.error(this.$t("i18n_capacity_cant_be_null")),this.validateResult=!1),e.fsType||(this.$message.error(this.$t("i18n_file_type_cant_be_null")),this.validateResult=!1),"biosboot"!=e.mountPoint&&("GB"==this.unit&&e.size<1||"MB"==this.unit&&e.size<1024)&&(this.$message.error(this.$t("i18n_all_greater_than_1_gb")),this.validateResult=!1),e.size&&!/^[0-9]*$/.test(e.size)&&"auto"!=e.size&&(this.$message.error(this.$t("i18n_auto_or_number_0_or_1")),this.validateResult=!1),"auto"==e.size||/\d+/.test(e.size)||(this.$message.error(this.$t("i18n_must_be_auto_or_number")),this.validateResult=!1),"/"!=e.mountPoint&&"/boot"!=e.mountPoint&&"swap"!=e.mountPoint&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint||(d++,"swap"==e.mountPoint&&"swap"!=e.fsType&&(this.$message.error(this.$t("i18n_swap_must")),this.validateResult=!1),("GB"==this.unit&&e.size<1&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint||"MB"==this.unit&&e.size<1024&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint)&&(this.$message.error(this.$t("i18n_must_be_root_swap_boot")),this.validateResult=!1))}if(3!=d)return this.$message.error(this.$t("i18n_mut_only_one")),void(this.validateResult=!1);if(this.payLoad.options.defaults.installPartitions.length<3)return this.$message.error(this.$t("i18n_must_be_root_swap_boot")),void(this.validateResult=!1);let c=[];if(this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length>0)for(let o=0;o<this.payLoad.options.defaults.networkDevices.length;o++)this.payLoad.options.defaults.networkDevices[o].device&&c.push(this.payLoad.options.defaults.networkDevices[o].device),this.payLoad.options.defaults.networkDevices[o].ipv4.vlanIds&&0==this.payLoad.options.defaults.networkDevices[o].ipv4.vlanIds.length&&delete this.payLoad.options.defaults.networkDevices[o].ipv4.vlanIds;if(c=r.groupBy(c,(function(e){return e})),r.forEach(c,t=>{t.length>1&&(this.$message.error(this.$t("i18n_mac_dup")),e.validateResult=!1)}),this.payLoad.options.defaults.switchDevices&&this.payLoad.options.defaults.switchDevices.length>0){let t={},a={};r.forEach(this.payLoad.options.defaults.switchDevices,e=>t[e.switchName]?t[e.switchName]=t[e.switchName]+1:t[e.switchName]=1),Object.keys(t).forEach(a=>{if(t[a]>1)return e.$message.error(a+e.$t("multiple")),void(e.validateResult=!1)}),r.forEach(this.payLoad.options.defaults.switchDevices,e=>{r.forEach(e.uplinks,e=>a[e]?a[e]=a[e]+1:a[e]=1)}),Object.keys(a).forEach(t=>{if(a[t]>1)return e.$message.error(t+e.$t("multiple")),void(e.validateResult=!1)})}return this.payLoad.options.defaults.switchDevices&&this.payLoad.options.defaults.switchDevices.length>0&&0==r.filter(this.payLoad.options.defaults.switchDevices,e=>"vSwitch0"==e.switchName).length&&(this.$message.error(this.$t("i18n_at_least_sw0")),e.validateResult=!1),this.payLoad.options.defaults.dnsServers&&0==this.payLoad.options.defaults.dnsServers.length&&(this.$message.error(this.$t("i18n_at_least_dns")),e.validateResult=!1),this.payLoad.options.defaults.ntp&&0!==this.payLoad.options.defaults.ntp.length||(this.$message.error(this.$t("i18n_at_least_ntp")),e.validateResult=!1),this.validateResult},getAllImage:function(){l["a"].post("/image/allImage",{},e=>{if(this.allImages=r.filter(e.data,e=>"ubuntu"==e.os&&"20.04 liveCD"==e.osVersion),this.allImages&&this.allImages.length){if(!this.payLoad.options.defaults.repo){let e=r.find(this.allImages,e=>"ubuntu"==e.os);e?(this.payLoad.options.defaults.repo=e.url,this.payLoad.options.defaults.isoUrl=e.url.substr(0,e.url.lastIndexOf("/"))+"/"+e.originalName):this.$message.error(this.$t("no_valid_image!"))}}else this.$message.error(this.$t("no_valid_image!"))})},getHardware(){l["a"].get("/bare-metal/hardwares/"+this.$attrs.bareMetalId,null,e=>{this.cpus=e.data.cpus,this.memories=e.data.memories,this.disks=e.data.disks,this.nics=e.data.nics,"em1"==this.payLoad.options.defaults.networkDevices[0].device&&this.nics.length>0&&(this.payLoad.options.defaults.networkDevices[0].device=this.nics[0].mac)})}}},c=d,u=a("2877"),p=Object(u["a"])(c,i,s,!1,null,null,null);t["default"]=p.exports},"5f61":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{attrs:{"label-width":"101px"}},[t("el-form-item",{attrs:{label:e.$t("custom_raid")}},[t("table",{staticClass:"detail-info"},[t("thead",[t("tr",[t("th",[e._v(e._s(e.$t("raid_type")))]),t("th",[e._v(e._s(e.$t("raid_disk")))]),t("th",[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(t){return e.addRaid()}}})],1)])]),t("tbody",e._l(e.payLoad.options["create-raid"].raidList,(function(a,i){return t("tr",[t("td",[t("el-select",{model:{value:a.type,callback:function(t){e.$set(a,"type",t)},expression:"config.type"}},e._l(e.raidTypes,(function(a){return t("el-option",{attrs:{label:a,value:a}},[e._v(" "+e._s(a)+" ")])})),1)],1),t("td",[t("el-select",{attrs:{multiple:""},on:{change:function(t){return e.changeDisk(a,i)}},model:{value:a.drives,callback:function(t){e.$set(a,"drives",t)},expression:"config.drives"}},e._l(e.odisks,(function(a){return t("el-option",{attrs:{label:a.drives,value:parseInt(a.drive)}},[e._v(" "+e._s((a.type?a.type:e.$t("unknown"))+" raidLevel:"+(a.raid?a.raid:"无")+"-enclosureId:"+a.enclosureId+"-driveId:"+a.drive+"-"+a.size)+" ")])})),1)],1),t("td",[t("el-button",{attrs:{type:"primary",icon:"el-icon-minus",circle:""},on:{click:function(t){return e.payLoad.options["create-raid"]["raidList"].splice(i,1)}}})],1)])})),0)])])],1)],1)},s=[],l=(a("14d9"),a("b35c")),o=a("e8de");let n=a("2ef0");var r={activated(){},created(){},deactivated(){},data(){return{enclosure:32,defaultPayLoad:{options:{"bootstrap-rancher":{dockerFile:"secure.erase.docker.tar.xz"},"create-raid":{createDefault:!1,controller:0,path:"/opt/MegaRAID/perccli/perccli64",raidList:[{enclosure:32,type:null,drives:[],name:"VD0"}]}}},raidTypes:["raid0","raid1","raid5","raid10","raid50"],payLoad:this.$attrs.params?JSON.parse(JSON.stringify(this.$attrs.params)):{options:{"bootstrap-rancher":{dockerFile:"secure.erase.docker.tar.xz"},"create-raid":{createDefault:!1,controller:0,path:"/opt/MegaRAID/perccli/perccli64",raidList:[{enclosure:32,type:null,drives:[],name:"VD0"}]}}},extraParams:this.$attrs.extraParams?JSON.parse(JSON.stringify(this.$attrs.extraParams)):{},cpus:[],memories:[],disks:[],diskMap:{},nics:[],validateResult:!1}},watch:{},computed:{odisks:function(){return n.orderBy(this.disks,["drive"],["asc"])}},mounted(){this.getHardware()},methods:{addRaid(){this.payLoad.options["create-raid"].raidList.push({enclosure:this.enclosure,type:null,drives:[],name:"VD"+this.payLoad.options["create-raid"].raidList.length})},changeDisk(e){if(e.drives&&e.drives.length>0){let t=n.find(this.odisks,t=>t.drive==e.drives[0]);t&&(e.enclosure=t.enclosureId)}},restoreParams:function(){this.restorePartition()},restorePartition:function(){this.payLoad=JSON.parse(JSON.stringify(this.defaultPayLoad))},valid:function(){let e=this.payLoad.options["create-raid"].raidList;if(0==e.length)return this.$message.error(this.$t("i18n_pls_os_must_choose_one_raid","请至少选择一组磁盘组建raid！")),!1;let t=[];for(let s=0;s<e.length;s++){let a=e[s],i=a.type,l=a.drives;if(Object(o["a"])(this.getSelectDisks(l)))return void this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_yigou_disk"));if(t=t.concat(l),!i)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu_de_raid_not_config")),!1;if(!l||0==l.length)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu_de_raid_not_config")),!1;switch(i){case"raid1":if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid1_must_be_2n")),!1;break;case"raid3":if(l.length<3)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid1_must_greater_than_3")),!1;break;case"raid5":if(l.length<3)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid5_must_greater_than_3")),!1;break;case"raid6":if(l.length<4)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid6_must_greater_than_4")),!1;break;case"raid10":if(l.length<4)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid10_must_greater_than_4")),!1;if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid10_must_be_2n")),!1;break;case"raid50":if(l.length<6)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid50_must_greater_than_6")),!1;if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid50_must_be_2n")),!1;break;case"raid60":if(l.length<8)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid56_must_be_greater_than_8")),!1;if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid60_must_be_2n")),!1;break}}if(0==t.length)return!1;let a=[],i=[];a=t;for(let s=0;s<a.length;s++){if(-1!=i.indexOf(a[s]))return this.$message.error(this.$t("i18n_disk")+a[s]+this.$t("i18n_duplicate_in_array")),!1;i.push(a[s])}return!0},getHardware(){l["a"].get("/bare-metal/hardwares/"+this.$attrs.bareMetalId,null,e=>{this.cpus=e.data.cpus,this.memories=e.data.memories;let t=this;e.data.disks&&e.data.disks.length>0&&(e.data.disks=n.orderBy(e.data.disks,["drive"],["asc"]),e.data.disks.forEach(e=>t.diskMap[e.drive]=e)),this.disks=e.data.disks,this.nics=e.data.nics,this.disks&&this.disks.length>0&&(this.enclosure=this.disks[0].enclosureId,this.payLoad.options["create-raid"].raidList.length>0&&n.forEach(this.payLoad.options["create-raid"].raidList,e=>{e.enclosure=this.disks[0].enclosureId}))})},getSelectDisks(e){let t=[];return e&&e.length&&e.forEach(e=>t.push(this.diskMap[e])),t}}},d=r,c=a("2877"),u=Object(c["a"])(d,i,s,!1,null,null,null);t["default"]=u.exports},"5fec":function(e,t,a){"use strict";a("931f")},"60b9":function(e,t,a){},"619f":function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l}));a("2ef0");function i(){let e=!1;if(arguments&&arguments.length>0)for(let t=0;t<arguments.length;t++)arguments[t]&&(!arguments[t]||""!=arguments[t]&&0!=arguments[t].length)||(e=!0);return e}function s(e){return e.replace(/([A-Z])/g,"_$1").toLowerCase()}function l(e){var t=e,a=/^(254|252|248|240|224|192|128|0)\.0\.0\.0|255\.(254|252|248|240|224|192|128|0)\.0\.0|255\.255\.(254|252|248|240|224|192|128|0)\.0|255\.255\.255\.(254|252|248|240|224|192|128|0)$/,i=t.match(a);return null!=i}},"65b1":function(e,t,a){"use strict";a("b669")},"65c0":function(e,t,a){"use strict";a.r(t);a("14d9");var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{attrs:{"label-width":"101px"}},[t("el-form-item",{attrs:{label:e.$t("custom_raid")}},[t("table",{staticClass:"detail-info"},[t("thead",[t("tr",[t("th",[e._v(e._s(e.$t("raid_type")))]),t("th",[e._v(e._s(e.$t("raid_disk")))]),t("th",[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(t){return e.payLoad.options["create-raid"].raidList.push({})}}})],1)])]),t("tbody",e._l(e.payLoad.options["create-raid"].raidList,(function(a,i){return t("tr",[t("td",[t("el-select",{model:{value:a.type,callback:function(t){e.$set(a,"type",t)},expression:"config.type"}},e._l(e.raidTypes,(function(a){return t("el-option",{attrs:{label:a,value:a}},[e._v(" "+e._s(a)+" ")])})),1)],1),t("td",[t("el-select",{attrs:{multiple:""},model:{value:a.drives,callback:function(t){e.$set(a,"drives",t)},expression:"config.drives"}},e._l(e.odisks,(function(a){return t("el-option",{attrs:{label:a.drives,value:a.enclosureId+"-"+a.drive}},[e._v(" "+e._s((a.type?a.type:e.$t("unknown"))+" raidLevel:"+(a.raid?a.raid:"无")+"-enclosureId:"+a.enclosureId+"-driveId:"+a.drive+"-"+a.size)+" ")])})),1)],1),t("td",[t("el-button",{attrs:{type:"primary",icon:"el-icon-minus",circle:""},on:{click:function(t){return e.payLoad.options["create-raid"]["raidList"].splice(i,1)}}})],1)])})),0)])])],1)],1)},s=[],l=a("b35c"),o=a("e8de");let n=a("2ef0");var r={activated(){},created(){},deactivated(){},data(){return{defaultPayLoad:{options:{"bootstrap-rancher":{dockerFile:"secure.erase.docker.tar.xz"},"create-raid":{createDefault:!1,controller:1,path:"/usr/Arcconf/arcconf",raidList:[{type:null,drives:[]}]}}},raidTypes:["raid0","raid1","raid5","raid10","raid50"],payLoad:this.$attrs.params?JSON.parse(JSON.stringify(this.$attrs.params)):{options:{"bootstrap-rancher":{dockerFile:"secure.erase.docker.tar.xz"},"create-raid":{createDefault:!1,controller:1,path:"/usr/Arcconf/arcconf",raidList:[{type:null,drives:[]}]}}},extraParams:this.$attrs.extraParams?JSON.parse(JSON.stringify(this.$attrs.extraParams)):{},cpus:[],memories:[],disks:[],diskMap:{},nics:[],validateResult:!1}},watch:{},computed:{odisks:function(){return n.orderBy(this.disks,["drive"],["asc"])}},mounted(){this.getHardware()},methods:{restoreParams:function(){this.restorePartition()},restorePartition:function(){this.payLoad=JSON.parse(JSON.stringify(this.defaultPayLoad))},valid:function(){let e=this.payLoad.options["create-raid"].raidList;if(0==e.length)return this.$message.error(this.$t("i18n_pls_os_must_choose_one_raid","请至少选择一组磁盘组建raid！")),!1;let t="";for(let s=0;s<e.length;s++){let a=e[s],i=a.type,l=a.drives;if(Object(o["a"])(this.getSelectDisks(l)))return void this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_yigou_disk"));if(t+=l+",",!i)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu_de_raid_not_config")),!1;if(!l||0==l.length)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu_de_raid_not_config")),!1;switch(i){case"raid1":if(2!=l.length)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid1_must_be_2")),!1;break;case"raid3":if(l.length<3)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid1_must_greater_than_3")),!1;break;case"raid5":if(l.length<3)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid5_must_greater_than_3")),!1;break;case"raid6":if(l.length<4)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid6_must_greater_than_4")),!1;break;case"raid10":if(l.length<4)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid10_must_greater_than_4")),!1;if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid10_must_be_2n")),!1;break;case"raid50":if(l.length<6)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid50_must_greater_than_6")),!1;if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid50_must_be_2n")),!1;break;case"raid60":if(l.length<8)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid56_must_be_greater_than_8")),!1;if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid60_must_be_2n")),!1;break}}if(0==t.length)return!1;let a=[],i=[];a=t.substr(0,t.length-1).split(",");for(let s=0;s<a.length;s++){if(-1!=i.indexOf(a[s]))return this.$message.error(this.$t("i18n_disk")+a[s]+this.$t("i18n_duplicate_in_array")),!1;i.push(a[s])}return!0},getHardware(){l["a"].get("/bare-metal/hardwares/"+this.$attrs.bareMetalId,null,e=>{if(this.cpus=e.data.cpus,this.memories=e.data.memories,this.disks=e.data.disks,e.data.disks&&e.data.disks.length>0){e.data.disks=n.orderBy(e.data.disks,["drive"],["asc"]);let t=this;e.data.disks.forEach(e=>t.diskMap[e.enclosureId+"-"+e.drive]=e)}this.nics=e.data.nics})},getSelectDisks(e){let t=[];return e&&e.length&&e.forEach(e=>t.push(this.diskMap[e])),t}}},d=r,c=a("2877"),u=Object(c["a"])(d,i,s,!1,null,null,null);t["default"]=u.exports},"69d3":function(e,t,a){"use strict";a.r(t),t["default"]={cancel:"Cancel",Networks:"Networks","hostname_must_not_have_invalid_word!":"The hostname naming is invalid!",Configuration:"Configuration",fs_type:"Partition Format",proc_socket:"Processor Socket",del:"Delete",Languages:"Language",cannt_be_null:"The miserable number cannot be empty",hostname:"HOSTNAME",ExecutionLog:"Deployment Log",password:"Password",add_network:"Add network cheese",Endpoint:"Endpoint",controller_id:"controller number","param_cannot_be_null!":"The tragedy cannot be empty!","delete_success!":"Delete successfully",english:"English",mem_mod_size:"Memory Capacity",disk_detail:"Disk Details",ERROR:"Failed",edit_success:"Edit success",nic_number:"NIC number",pls_input_email:"Please enter email",user_settable:"Configuration",edit:"Edit",edit_system_parameter:"Edit system parameter",Images:"Mirror",Workflow:"Workflow",delete_fail:"Deletion failed",batch_del:"Batch delete",size:"Capacity",en_US:"English",detail:"Detail",drive:"Slot Number",param_value:"param value",role:"role",user_name:"UserName",bare_metal:"Bare Metal",pls_input_vlan_id:"Please enter vlanId",add_outband:"Add Outband",add_workflow:"Add Workflow",network_card:"Network Card",endpoint:"Node",pls_select_bare_metal:"Please select a bare metal server",start_ip:"Start IP",edit_execution_log:"Edit deployment log",pls_input_start_ip:"Please enter the start ip",disabled:"No",sn:"Serial Number",close:"Close",email:"Email",discovering:"Information Collection",brands:"Supported Brands",validate_error:"Cause verification error",SUCCESS:"Success",delete_success:"Delete successfully",refresh:"Refresh","origin-password":"Original Password",Run:"Execute",confirm:"Confirm",discoveryed_devices:"Internet cheese devices have been discovered",pls_input_user_name:"Please enter a user name",root_pwd:"ROOT password",pls_select_workflow:"Please select a workflow",network_devices:"Network card ip settings",deploying:"Deploying",raid_disk:"RAID Disk",operation:"operation",vlan_id:"VlanId",pls_select_discovery:"Please select a discovery rule",pls_select_image:"Please select an image",obms:"Out-of-band information",sync_time:"Sync time",confirm_to_del:"Confirm Delete ?","edit_discovery-devices":"Edit discovered devices",edit_discovery:"Edit Discovery Rules",pls_input_password:"Please enter a password",chinese:"中文",view:"View",management_ip:"Out-of-band IP",proc_num_threads:"Number of threads",memory_detail:"Memory Details",onrack:"Onrack",username_pwd_error_login_fail:"Incorrect username/password",info:"Info",add:"Add",endIp:"End IP",image:"Mirror",create_time:"Create Time",vlanId:"VlanId",pls_select_:"Please select",please_select:"Please select",sync:"Sync",Role:"Role",opt:"Operation",pxe_enable:"Whether to enable PXE",success:"Success",name:"Name",desc:"Description",memory:"Memory",show:"Show",description:"Description",cpu_detail:"CPU Details",pls_select:"Please select",Control:"Control",mem_cpu_num:"Memory CPU Number",SystemParameter:"System Parameter",GB:"GB",OBM:"Out of Band",change_pwd:"Change Password",ip_invalid_format:"IP format error",invalid_format:"Format error",OverView:"Overview",param_check_error:"The miserable check failed!",mask:"Subnet Mask",last_sync_timestamp:"Last sync time",pls_input_os_version:"Please enter the OS version number","not_supported_brand!":"The brand is not supported-",Info:"Personal Information",input_key_search:"model/serial number/IP",input_key_search_switch:"Name/IP",add_endpoint:"Add node",pxeboot:"PXE reboot",edit_fail:"Edit failed",proc_speed:"Processor Frequency","Bare Metal Server":"Bare Metal Server",pls_select_network:"Please select a subnet",os_vesion:"OS version",obm:"Out-of-band management",time:"Time",ip_addr:"IP address",gateway:"Gateway",username:"UserName",fanti:"Traditional",pls_input_pwd:"Please enter the password",edit_network:"Edit Network Case",type:"Type",Image:"Mirror",tips:"tips",hostname_must_not_have_invalid_word:"hostname is invalid",output:"Output",default_params:"Default params",logout:"Logout",event_type:"Event Type",enable:"Enable",Network:"Network Cheese",id:"ID",proc_num_cores:"Number of processor cores",view_detail:"View Details",selected_workflows:"Workflows to be Executed",IP:"IP",ip:"IP",pls_input_phone:"Please enter the phone number",add_execution_log:"Add deployment log",Login:"Login",add_system_parameter:"Add system parameters",pls_select_node:"Please select a server",system:"System",pls_select_obm:"Please select out-of-band information",phone:"Mobile Number",pls_input_url:"Please enter the URL or upload the ISO file directly",reset:"Reset",sync_status:"Sync Status",pls_input_username:"Please enter a username",pwd:"Password",Subnet:"DHCP Subnet",add_success:"Add success",view_execution_log:"View deployment log",status:"Status",submitting:"Submitting",poweron:"Start",pls_select_username:"Please choose a username","add_discovery-devices":"Add to Discovery",edit_role:"Edit role",mac:"mac address",enabled:"Yes",capacity:"Capacity",pls_set_params:"Please set params",update_time:"Update time",pls_fill_in_blanks:"Please fill in the blanks",pls_input_end_ip:"Please enter the end IP",add_to_device:"Add to bare metal",pls_input_param_value:"Please enter a miserable value",set_workflow_param:"Set Workflow Param",poweroff:"Close",edit_outband:"Edit Outband",pls_select_system_parameter:"Please select the system rameter",os_version:"OS version",execution_log:"Deployment Log",machine_model:"Machine Brand/Model",machine_sn:"Serial Number",PENDING:"Syncing","new-password":"New Password",url:"URL",mem_mod_num:"Memory slot number",mem_mod_part_num:"Memory Model",discovery:"Discovery",disable:"Close",edit_endpoint:"Edit Node",raid_type:"RAID Type","Execution Log":"Deployment Log",powercycle:"Power Cycle",mem_mod_min_volt:"Minimum Memory Voltage",same_workflow_node:"The same node cannot execute the same workflow multiple times at the same time",CPU:"CPU",custom_partition:"Custom Partition",pls_input_hostname:"Please enter hostname",custom_raid:"Custom RAID",opt_fail:"Operation failed",pls_input_netmask:"Please enter the subnet mask",view_url:"View URL",edit_image:"Edit image",login_timeout:"Login timeout",end_ip:"End IP","confirm-password":"Confirm new password",machine_status:"Machine Status",mem_mod_frequency:"Memory Frequency",copy_success:"Copy success",param_config:"Miscellaneous configuration",Resource:"Resource",Discovery:"Discovery",cpu:"CPU",manufactor:"Manufacturer",add_fail:"Add failed",pls_select_password:"Please select a password",disk:"Disk",network_card_mac:"Network card MAC address",pls_input_params:"This cannot be null",pls_input_name:"Please enter a name","pls_select_discovery-devices":"Please select discovered devices",dhcp_enable:"Whether to enable DHCP",injectable_name:"Workflow Template",proc_name:"Processor Model",no_nessary_to_set:"No nessary to set",raid:"Raid Level",startIp:"Start IP",User:"User",enclosure_id:"EnclosureId",deployed:"Deployed",bmc_mac:"Out-of-band MAC",error:"Error",delete:"Delete",mem_mod_type:"Memory Type",settable:"Settable",zh_TW:"繁體中文",add_image:"Add image",netmask:"Subnet Mask",param_key:"Misery Key",ready:"Ready",add_to_selected_wf_list:"Add to workflow to be run",provisioning:"Provisioning",allocated:"Allocated",friendly_name:"Name",os:"OS",opt_success:"Operation successful",nic_detail:"NIC Details",endpointId:"Node ID",mount_point:"Mount Point",pls_select_endpoint:"Please select a node","no_valid_image!":"The image is not found, please upload the image file first!",add_discovery:"Add Discovery Protocol",login_fail:"Failed to log on to six",zh_CN:"简体中文",Machines:"Bare Metal Server",user:"User",Wizard:"Use Wizard",edit_workflow:"Edit Workflow",Plugin:"Plugin",FILL_OBMS:"Supplementary OBM Information",PXE_BOOT_START:"PXE boot",PXE_BOOT_END:"PXE boot completed",PXE_BOOT_CANCEL:"Cancel PXE boot",POST_DISCOVERY_WORKFLOW_START:"Post a discovery workflow",POST_DISCOVERY_WORKFLOW_END:"Found that the workflow has been executed",POST_DISCOVERY_WORKFLOW_CANCEL:"Cancel discovery of worflow",POST_OTHER_WORKFLOW_START:"Send general workflow",POST_OTHER_WORKFLOW_END:"workflow execution completed",POST_OTHER_WORKFLOW_CANCEL:"Cancel workflow",POST_OS_WORKFLOW_START:"Send installation system workflow",POST_OS_WORKFLOW_END:"The installation system workflow has been executed",POST_OS_WORKFLOW_CANCEL:"Cancel installation of system workflow",device:"device",START:"Start",TERMINATE:"User Termination",END:"End",SUBMIT:"SUBMIT",PROCESSING:"PROCESSING",email_format_error:"Invalid Email Format",phone_format_error:"Invalid Phone Format",admin:"admin",i18n_mount_point_cant_be_null:"The mount point cannot be empty!",i18n_capacity_cant_be_null:"Capacity cannot be empty!",i18n_must_be_root_swap_boot:"There must be root, swap and /boot partitions, and the minimum capacity of all partitions cannot be less than 1GB!",i18n_auto_or_number_0_or_1:"The partition capacity can only be number or auto, and the partition capacity of auto can only be 0 or 1!",i18n_must_be_auto_or_number:"The partition capacity must be auto or a number!",i18n_swap_must:"The swap partition format must be swap!",raidDisk:"raidDisk",i18n_file_type_cant_be_null:"File type cannot be empty!",i18n_all_greater_than_1_gb:"The minimum capacity of all partitions cannot be less than 1GB!",i18n_mut_only_one:"There must be one and only one root, swap and /boot partition!",only_iso_no_more_than_10g:" can only upload ISO files, and no more than 10GB ，only support full type, not minimal!",drag_file_into_or:"Drag the file here, or ",click_to_upload:" click to Upload ",uefi_boot:"UEFI BOOT",not_detected:"Not Detected",not_exists:"Not Detected",detected:"Detected",obm_not_exists:"OBM Info Not Set",help_doc:"Help Document",created:"to be executed",running:"running",failed:"failed",succeeded:"successful",Task:"Task",instance_id:"Instance Id",i18n_zu:"Group",i18n_raid60_must_be_2n:"raid60 the number of disk must be multiples of the number two！",i18n_di:"The number ",i18n_raid1_must_be_2:"Inspur raid1 the number of disk must be two！",i18n_raid1_must_be_2n:"raid1 the number of disk must be multiples of the number two！",i18n_raid10_must_be_2n:"raid10 the number of disk must be multiples of the number two！",i18n_raid50_must_be_2n:"raid50 the number of disk must be multiples of the number two！",i18n_raid5_must_greater_than_3:"raid5 the number of disk cannot less than three！",i18n_raid10_must_greater_than_4:"raid10 the number of disk cannot less than four！",i18n_raid56_must_be_greater_than_8:"raid60 the number of disk cannot less than eight！",i18n_pls_os_must_choose_one_raid:"please select at least one disk to config raid！",i18n_raid6_must_greater_than_4:"raid6 the number of disk cannot less than four！",i18n_raid50_must_greater_than_6:"raid50 the number of disk cannot less than six！",i18n_zu_de_raid_not_config:"'s raid is not configured！",i18n_raid1_must_greater_than_3:"raid3 the number of disk cannot less than three！",i18n_disk:"Disk:",i18n_duplicate_in_array:"Repeatedly selected into multiple arrays！",view_log:"View logs",not_ready:"Not Ready",power:"Power",unknown:"Unknown",on:"ON",off:"OFF",detect_params:"Detect Params",protocol:"Protocol",possible_params:"Possible Params",community:"Community",port:"Port",founded_machine_number:"Founded Number",Discovery_Rule:"Discovery Rule",username_or_id:"ID or Email",welcome:"Welcome Come Back，Input UserName and Password to Login to   RackShift",no_more_logs:"No More Logs...",about:"About",about_us:"About",server_message:"Workflow Message",power_on:" Power On",power_off:" Power Off",power_pxe:" PXE Reset",power_reset:"Hard Power Reset",sync_success:"sync success",sync_fail:"sync fail",Executor:"Executor",upload:"upload ",upload_success_submit:"Submit before uploaded",selected:"Selected",tai:"",power_text:"Only if correct OBM is set IPMI can read the power status",machine_brand:"Brand",cancel_task_success:"Cancel success!wait until it refresh it‘s status",add_protocol_param:"Add protocol param","IPMI+Rest":"IPMI with BMC",workflow_submitted:"workflow submitted , please open Task page to view ",opt_fail_pxe:"please PXE first till full hardware info is discovered ","安装Centos7 64位版":"Install Centos7 64","创建HPE服务器磁盘Raid虚拟磁盘":"Create HPE RAID","搜集HPE服务器磁盘Raid信息":"Catalog HPE RAID","清空HPE服务器磁盘和Raid信息":"Erase HPE RAID","创建Inspur服务器磁盘Raid虚拟磁盘":"Create Inspur RAID","清空Inspur服务器磁盘和Raid信息":"Erase Inspur RAID","搜集Inspur服务器磁盘Raid信息":"Catalog Inspur RAID","创建Dell服务器磁盘Raid虚拟磁盘":"Create Dell RAID","清空Dell服务器磁盘和Raid信息":"Erase Dell RAID","搜集Dell服务器磁盘Raid信息":"Catalog Dell RAID","安装 RedHat7 64位版":"Install RHEL7 64","安装 windowsServer 2012 标准版":"Install WindowsServer 2012 SE","安装 windowsServer 2016 标准版":"Install WindowsServer 2016 SE","安装 ESXI 6.7":"Install ESXI 6.7","下发安装系统workflow":"Install OS Workflow","下发通用workflow":"Normal Workflow","补充OBM信息":"OBM Info","下发发现workflow":"Discovery Workflow","主节点":"Main Endpoint","从节点":"Slave Endpoint",version:"Version","搜集New H3C Technologies Co., Ltd.服务器磁盘Raid信息":"Catalog H3C RAID","清空New H3C Technologies Co., Ltd.服务器磁盘和Raid信息":"Erase H3C RAID","创建New H3C Technologies Co., Ltd.服务器磁盘Raid虚拟磁盘":"Create H3C RAID","搜集 InspurM5 服务器磁盘 Raid 信息":"Catalog InspurM5 RAID","清空 InspurM5 服务器磁盘 Raid 信息":"Erase InspurM5 RAID","创建 InspurM5 服务器磁盘 Raid 虚拟磁盘":"Create InspurM5 RAID",batch_params:"Config Params",common_params:"Common Params",nic:"NIC Number",productkey:"Product Key",smb_user:"SAMBA UserName",smb_password:"SAMBA Password",windwos_param:"Windows Param Config",domain:"Domain",host_increase:"Increase",increase_host_desc:"HOSTNAME1,HOSTNAME2,...",base_number:"HOSTNAME BaseNumber",platform:"Platform",samba:"SAMBA",msg:"Message",instruction_content:"Instruction Content",set_detect_params:"Set Detect p",Instruction:"Instruction",pls_select_task:"Please select task",base_instruction:"Instruction template",pls_select_plugin:"Please select plugin",logs:"Logs",view_plugin:"View Plugin",item:"Item",workflow:"Worfklow",edit_instruction:"Edit Instruction",add_instruction:"add Instruction",select_machine:"Select Machine",add_plugin:"Add Plugin","delete_fail!":"Delete Fail",view_instructions:"View Instructions",edit_plugin:"Edit Plugin",pls_select_instruction:"Please Select Instruction",PXE:"PXE",execute_instruction:"Execute Instruction",pls_select_log:"Please Select Logs",scan_over:"Scan Over!",confirm_to_del_endpoint:"Deleting node will delete all resources under the node at the same time. Confirm deletion?","Centos 64位":"CentOS 64 Bit Version","RedHat 64位":"RHEL 64 Bit Version",network_error:"Network Error，Please Check it out~",cancelled:"cancelled",netmask_validate_error:"Netmask is illegal!",i18n_yigou_disk:" the group has heterogeneous disks (such as mechanical and solid state), so raid cannot be created! ",COMPLETE:"complete",not_discoveryed:"active discovery has not been completed, please restart the server by PXE! ",is_pxe:"PXE Card",params_not_valid_json:"params is not valid json format!",pls_input_vlan:"Input vlanId please，use comma to split multiple vlan",like_vlan:"1",must_be_number:"Must be number",i18n_mac_dup:"Duplicated mac !",add_network_card:"Add network",del_network_card:"Del network",add_switch:"Add vSwitch",del_switch:"Del vSwitch",i18n_at_least_sw0:"At least one vSwitch0",i18n_at_least_dns:"At least one dns",i18n_at_least_ntp:"At least one ntp",multiple:" duplicate",nic_not_found:"Cannot find Nic",cannot_add_more:"Cannot add more nic!",cannot_add_more_vs:"Cannot add more vSwitch!",i18n_ms_7_long:"at least be 7 characters long",no_vlan:" no vlan",must_between_0_4095:"must between 0 - 4095",change_ipmipwd:"Reset IPMI password",twp_pwd_notsame:"Two password not the same!","安装 Ubuntu 18.04 64位版":"Install Ubuntu 18.04 64",add_bond:"Add BOND",del_bond:"Del BOND",deviceName:"Linux deviceName",switch_port:"Switch Port",switch_name:"Switch Name",Switch:"Switch",switch:"Switch",snmp_community:"SNMP Community",snmp_port:"SNMP Port",ssh_port:"SSH Port",telnet_port:"Telent Port",view_vendor:"View vendor",Switch_Discovery_Rule:"Switch Discovery Rule","edit_switch-discovery":"Edit Switch Rule",vendor:"Vendor",active_ports:"Active Ports",port_detail:"Port Detail",api_key:"API KEY",create:"Create",access_key:"Access Key",secret_key:"Secret Key",hide:"HIDE",param:"PARAM",copy:"COPY",copied:"COP",device_type:"Device Type",volume_group:"Volume Group",lvm:"LVM",standard_partition:"Standard Partition",lvm_name:"LVM Name",partition_tips:"default kickstart autopart",ubuntu_pwd:"Default user/pwd ubuntu/root",open_webkvm:"Remote KVM Console",post_install:"POST-INSTALL Script",view_example:"View Example",Profile:"Profile",InstallScript:"InstallScript","Profile already exists!":"Profile already exists!",add_profile:"Add Profile",edit_profile:"Edit Profile",content:"Content",profile:"Profile","Template already exists!":"Template already exists!",add_template:"Add Template",edit_template:"Edit Template",template:"Template",more_than_3:"more than 3 words",pls_input:"please input",not_support_validate:"UI param will not be supported",backend_upload:"Mount",front_upload:"Upload",mount_text:"default mount point is under /opt/rackshift/rackhd/files/mount/common，third part http server is also available",i18n_lvmname_null:"LVM Name can not be null",no_param:"No param!",pxe_mac:"PXE MAC",remark:"remark",why:"WHY?",pxe_desc:"The installed platform uses the MAC address of the network card as the unique identifier to distinguish the physical machines in PXE to achieve different boot processes for different machines",not_required:" Not required"}},"6ff2":function(e,t,a){},"714f":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"machine-title2"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(a){return t("el-table-column",{attrs:{prop:a.prop,formatter:e.getValidProText,label:a.label,align:"left",sortable:a.sort}})})),t("el-table-column",{attrs:{prop:"updateTime",label:e.$t("update_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.updateTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"button",icon:"el-icon-edit"},on:{click:function(t){return e.handleEdit(a.row,"edit")}}},[e._v(e._s(e.$t("edit"))+" ")]),t("el-button",{staticClass:"red",attrs:{type:"button",icon:"el-icon-delete"},on:{click:function(t){return e.handleEdit(a.row,"del")}}},[e._v(e._s(e.$t("del"))+" ")])]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_outband"):e.$t("add_outband"),visible:e.editDialogVisible,direction:"rtl",wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{attrs:{model:e.editObj}},[t("el-form-item",{attrs:{label:e.$t("ip")}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.ip,callback:function(t){e.$set(e.editObj,"ip",t)},expression:"editObj.ip"}})],1),t("el-form-item",{attrs:{label:e.$t("user_name")}},[t("el-input",{attrs:{autocomplete:"off",placeholder:e.$t("pls_input_user_name"),maxlength:"30"},model:{value:e.editObj.userName,callback:function(t){e.$set(e.editObj,"userName",t)},expression:"editObj.userName"}})],1),t("el-form-item",{attrs:{label:e.$t("pwd")}},[t("el-input",{attrs:{autocomplete:"off",type:"password",placeholder:e.$t("pls_input_pwd")},model:{value:e.editObj.pwd,callback:function(t){e.$set(e.editObj,"pwd",t)},expression:"editObj.pwd"}})],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)},s=[],l=a("b35c");let o=a("2ef0");var n={data(){return{query:{name:"",pageIndex:1,pageSize:10},tableData:[],multipleSelection:[],delList:[],form:{},editVisible:!1,pageTotal:0,loading:!1,enables:[{id:"enable",name:this.$t("enable")},{id:"disable",name:this.$t("disable")}],columns:[{label:this.$t("ip"),prop:"ip",sort:!0},{label:this.$t("user_name"),prop:"userName"}],editDialogVisible:!1,editType:"edit",editObj:{name:null,description:null,type:null},allOs:[],allOsVersion:[],loadingList:!1}},mounted(){this.getData()},methods:{getValidProText(e,t,a,i){return 1==a?this.$t("enabled"):a&&0==a?this.$t("disabled"):a},getData(){this.loadingList=!0,l["a"].post("/outband/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},confirmEdit(){this.loading=!0,"edit"==this.editType?l["a"].put("/outband/update",this.editObj,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("edit_success")),this.loadingList=!1,this.getData()}):l["a"].post("/outband/add",this.editObj,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("add_success")),this.loadingList=!1,this.getData()})},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=o.map(this.delList,e=>e.id);return e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{l["a"].post("/outband/del",e,e=>{this.$message.success(this.$t("delete_success")),this.getData()}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select_obm")+"!")},handleEdit(e,t){"edit"==t?(this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e))):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{l["a"].delete("/outband/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})}):(this.editDialogVisible=!0,this.editType=t,this.editObj={})},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},r=n,d=(a("a580"),a("2877")),c=Object(d["a"])(r,i,s,!1,null,"189d8643",null);t["a"]=c.exports},"78f5":function(e,t,a){},"79b7":function(e,t,a){},"7a04":function(e,t,a){},"7db0":function(e,t,a){"use strict";a("0f9a")},8321:function(e,t,a){"use strict";a("8dbe")},8460:function(e,t,a){"use strict";a("edc7")},"86a4":function(e,t,a){},"8a5f":function(e,t,a){"use strict";a("6ff2")},"8ba9":function(e,t,a){},"8dbe":function(e,t,a){},9109:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"form",attrs:{"label-width":"130px",rules:e.rules,model:e.payLoad.options.defaults,"label-position":"right"}},[t("el-row",[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:e.$t("hostname"),prop:"hostname"}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"20"},model:{value:e.payLoad.options.defaults.hostname,callback:function(t){e.$set(e.payLoad.options.defaults,"hostname",t)},expression:"payLoad.options.defaults.hostname"}})],1),t("el-form-item",{attrs:{label:e.$t("domain"),prop:"domain"}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"20"},model:{value:e.payLoad.options.defaults.domain,callback:function(t){e.$set(e.payLoad.options.defaults,"domain",t)},expression:"payLoad.options.defaults.domain"}})],1),t("el-form-item",{attrs:{label:e.$t("root_pwd"),prop:"rootPassword"}},[t("el-input",{attrs:{autocomplete:"off","show-password":"",maxlength:"20"},model:{value:e.payLoad.options.defaults.rootPassword,callback:function(t){e.$set(e.payLoad.options.defaults,"rootPassword",t)},expression:"payLoad.options.defaults.rootPassword"}})],1),t("el-form-item",{attrs:{label:e.$t("image"),prop:"repo"}},[t("el-select",{staticClass:"input-element",attrs:{filterable:"","allow-create":"","default-first-option":""},model:{value:e.payLoad.options.defaults.repo,callback:function(t){e.$set(e.payLoad.options.defaults,"repo",t)},expression:"payLoad.options.defaults.repo"}},e._l(e.allImages,(function(e){return t("el-option",{attrs:{label:e.name,value:e.url}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("network_card")}},[t("RSButton",{attrs:{type:"add",tip:e.$t("add_network_card")},on:{click:e.addNet}}),t("el-collapse",{model:{value:e.nicActiveNames,callback:function(t){e.nicActiveNames=t},expression:"nicActiveNames"}},e._l(e.payLoad.options.defaults.networkDevices,(function(a,i){return t("el-collapse-item",{attrs:{title:e.getNetworkName(a),name:i+""}},[t("RSButton",{attrs:{type:"del",tip:e.$t("del_network_card")},on:{click:function(t){return e.delNet(i)}}}),t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:a,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"esxSwitchName",label:e.$t("esxSwitchName")}},[t("el-input",{staticClass:"input-element",attrs:{disabled:""},model:{value:a.esxSwitchName,callback:function(t){e.$set(a,"esxSwitchName",t)},expression:"d.esxSwitchName"}})],1),t("el-form-item",{attrs:{prop:"device",label:e.$t("pls_select_")+e.$t("network_card")}},[t("el-select",{staticClass:"input-element",on:{change:function(t){return e.changeSwitchName()}},model:{value:a.device,callback:function(t){e.$set(a,"device",t)},expression:"d.device"}},e._l(e.nics,(function(a){return t("el-option",{attrs:{value:a.mac}},[t("span",[e._v(" "+e._s(a.number+"("+a.mac+")")+" "),a.pxe?t("span",{staticStyle:{color:"red"}},[e._v(e._s(" "+e.$t("is_pxe")))]):e._e()])])})),1)],1),t("el-form",{ref:"nic2Form",refInFor:!0,attrs:{model:a.ipv4,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"ipAddr",label:e.$t("ip_addr")}},[t("el-input",{model:{value:a.ipv4.ipAddr,callback:function(t){e.$set(a.ipv4,"ipAddr",t)},expression:"d.ipv4.ipAddr"}})],1),t("el-form-item",{attrs:{prop:"gateway",label:e.$t("gateway")}},[t("el-input",{model:{value:a.ipv4.gateway,callback:function(t){e.$set(a.ipv4,"gateway",t)},expression:"d.ipv4.gateway"}})],1),t("el-form-item",{attrs:{prop:"netmask",label:e.$t("netmask")}},[t("el-input",{model:{value:a.ipv4.netmask,callback:function(t){e.$set(a.ipv4,"netmask",t)},expression:"d.ipv4.netmask"}})],1),t("el-form-item",{attrs:{prop:"vlanIds",label:e.$t("VLAN")}},[t("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:e.$t("pls_input_vlan")},on:{change:function(t){return e.changeInt(a)}},model:{value:a.ipv4.vlanIds,callback:function(t){e.$set(a.ipv4,"vlanIds",t)},expression:"d.ipv4.vlanIds"}},e._l(e.objs,(function(a){return t("el-option",{attrs:{label:e.$t(a.name),value:a.value}})})),1)],1)],1)],1)],1)})),1)],1)],1),t("el-col",{attrs:{span:13}},[t("el-form-item",{attrs:{label:e.$t("DNS"),prop:"dnsServers"}},[t("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.payLoad.options.defaults.dnsServers,callback:function(t){e.$set(e.payLoad.options.defaults,"dnsServers",t)},expression:"payLoad.options.defaults.dnsServers"}})],1),t("el-form-item",{attrs:{label:e.$t("ntpServers"),prop:"ntpServers"}},[t("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.payLoad.options.defaults.ntpServers,callback:function(t){e.$set(e.payLoad.options.defaults,"ntpServers",t)},expression:"payLoad.options.defaults.ntpServers"}})],1),t("el-form-item",{attrs:{label:e.$t("vSwitch")}},[t("RSButton",{attrs:{type:"add",tip:e.$t("add_switch")},on:{click:e.addSwitch}}),t("el-collapse",{model:{value:e.switchActiveNames,callback:function(t){e.switchActiveNames=t},expression:"switchActiveNames"}},e._l(e.payLoad.options.defaults.switchDevices,(function(a,i){return t("el-collapse-item",{attrs:{title:a.switchName,name:"switch"+i}},[t("RSButton",{attrs:{type:"del",tip:e.$t("del_switch")},on:{click:function(t){return e.delSwitch(i)}}}),t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:a,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"esxSwitchName",label:e.$t("esxSwitchName")}},[t("el-input",{staticClass:"input-element",on:{input:function(t){return e.changeSwitchName()}},model:{value:a.switchName,callback:function(t){e.$set(a,"switchName",t)},expression:"d.switchName"}})],1),t("el-form-item",{attrs:{prop:"uplinks",label:e.$t("pls_select_")+e.$t("network_card")}},[t("el-select",{staticClass:"input-element",attrs:{multiple:""},on:{change:function(t){return e.changeSwitchName()}},model:{value:a.uplinks,callback:function(t){e.$set(a,"uplinks",t)},expression:"d.uplinks"}},e._l(e.nics,(function(a){return t("el-option",{attrs:{value:a.mac}},[t("span",[e._v(" "+e._s(a.number+"("+a.mac+")")+" "),a.pxe?t("span",{staticStyle:{color:"red"}},[e._v(e._s(" "+e.$t("is_pxe")))]):e._e()])])})),1)],1)],1)],1)})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}}),t("el-col",{attrs:{span:12}})],1)],1)],1)},s=[],l=(a("14d9"),a("b35c")),o=a("619f"),n=a("30d1");let r=a("2ef0");var d={activated(){},created(){},deactivated(){},data(){return{objs:[{name:"no_vlan",value:0}],nicActiveNames:"0",switchActiveNames:"switch0",rules:{hostname:[{validator:n["d"],trigger:"blur",vue:this}],dnsServers:[{validator:n["a"],trigger:"change",vue:this}],ntpServers:[{validator:n["a"],trigger:"change",vue:this}],rootPassword:[{validator:n["j"],trigger:"blur",vue:this}],repo:[{validator:n["h"],trigger:"blur",vue:this,name:"image"}]},nicRules:{device:[{validator:n["i"],trigger:"blur",vue:this,name:"device"}],ipAddr:[{validator:n["e"],trigger:"blur",vue:this}],netmask:[{validator:n["e"],trigger:"blur",vue:this}],gateway:[{validator:n["e"],trigger:"blur",vue:this}],vlanIds:[{validator:n["k"],trigger:"change",vue:this,require:!0}],switchName:[{validator:n["j"],trigger:"blur",vue:this}],uplinks:[{validator:n["j"],trigger:"change",vue:this}]},uefi:!1,defaultPayLoad:{options:{defaults:{version:"6.7",repo:"http://172.31.128.1:8080/esxi/6.7",rootPassword:"RackHDRocks!",hostname:"rackhd-node",domain:"example.com",users:[{name:"rackhd1",password:"123456"}],dnsServers:["172.12.88.91","192.168.20.77"],ntpServers:["0.vmware.pool.ntp.org","1.vmware.pool.ntp.org"],networkDevices:[{device:null,ipv4:{ipAddr:"172.31.128.7",gateway:"172.31.128.1",netmask:"255.255.255.0",vlanIds:[10]},esxSwitchName:"vSwitch0"}],installDisk:"/dev/sda",switchDevices:[{switchName:"vSwitch0",uplinks:["vmnic4"]}],postInstallCommands:["echo This command will run at the end ","echo of the post installation step"]}}},payLoad:this.$attrs.params,extraParams:this.$attrs.extraParams?JSON.parse(JSON.stringify(this.$attrs.extraParams)):{unit:"MB"},allImages:[],cpus:[],memories:[],disks:[],nics:[],units:["GB","MB"],fsType:["ext3","ext4","swap","xfs","biosboot"],validateResult:!1}},mounted(){this.getAllImage(),this.getHardware()},methods:{changeInt(e){let t=[];e.ipv4.vlanIds.forEach(e=>t.push(Number(e))),e.ipv4.vlanIds=t},changeSwitchName(){r.forEach(this.payLoad.options.defaults.networkDevices,e=>{r.forEach(this.payLoad.options.defaults.switchDevices,t=>{e.device&&t.uplinks&&-1!=t.uplinks.indexOf(e.device)&&(e.esxSwitchName=t.switchName),t.uplinks&&-1==t.uplinks.indexOf(e.device)&&t.switchName==e.esxSwitchName&&t.uplinks.push(e.device)})})},getNetworkName(e){return e.device?this.$t("network_card_mac")+" "+e.device:this.$t("network_card_mac")},delNet(e){this.payLoad.options.defaults.networkDevices.length-1>0&&this.payLoad.options.defaults.networkDevices.splice(e,1)},addNet(){0!=this.nics.length?this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length==this.nics.length?this.$message.warning(this.$t("cannot_add_more")):this.payLoad.options.defaults.networkDevices.push({device:null,ipv4:{ipAddr:"192.168.1.10",gateway:"192.168.1.1",netmask:"255.255.255.0"}}):this.$message.warning(this.$t("nic_not_found"))},delSwitch(e){this.payLoad.options.defaults.switchDevices.length-1>0&&this.payLoad.options.defaults.switchDevices.splice(e,1)},addSwitch(){this.payLoad.options.defaults.switchDevices&&this.payLoad.options.defaults.switchDevices.length==this.nics.length?this.$message.warning(this.$t("cannot_add_more")):this.payLoad.options.defaults.switchDevices.push({switchName:"vSwitch"+this.payLoad.options.defaults.switchDevices.length,uplinks:[]})},restoreParams:function(){this.restorePartition()},restorePartition:function(){this.payLoad=JSON.parse(JSON.stringify(this.defaultPayLoad)),this.getAllImage()},valid:function(){this.validateResult=!0;let e=this;if(this.$refs["form"].validate(t=>{t?(e.$refs["nicForm"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})}),e.$refs["nic2Form"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})})):e.validateResult=!1}),!e.validateResult)return void this.$message.error(this.$t("param_check_error"));let t=this.payLoad.options.defaults.hostname,a=this.payLoad.options.defaults.rootPassword,i=this.payLoad.options.defaults.networkDevices[0].device,s=this.payLoad.options.defaults.networkDevices[0].ipv4.ipAddr,l=this.payLoad.options.defaults.networkDevices[0].ipv4.gateway,n=this.payLoad.options.defaults.networkDevices[0].ipv4.netmask;if(Object(o["c"])(t,a,i,s,l,n))return this.$message.error(this.$t("param_cannot_be_null!")),!1;if(/[^0-9a-zA-Z\-]+/.test(t))return this.$message.error(this.$t("hostname_must_not_have_invalid_word!")),!1;let d=[];if(this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length>0)for(let o=0;o<this.payLoad.options.defaults.networkDevices.length;o++)this.payLoad.options.defaults.networkDevices[o].device&&d.push(this.payLoad.options.defaults.networkDevices[o].device);if(d=r.groupBy(d,(function(e){return e})),r.forEach(d,t=>{t.length>1&&(this.$message.error(this.$t("i18n_mac_dup")),e.validateResult=!1)}),this.payLoad.options.defaults.switchDevices&&this.payLoad.options.defaults.switchDevices.length>0){let t={},a={};r.forEach(this.payLoad.options.defaults.switchDevices,e=>t[e.switchName]?t[e.switchName]=t[e.switchName]+1:t[e.switchName]=1),Object.keys(t).forEach(a=>{if(t[a]>1)return e.$message.error(a+e.$t("multiple")),void(e.validateResult=!1)}),r.forEach(this.payLoad.options.defaults.switchDevices,e=>{r.forEach(e.uplinks,e=>a[e]?a[e]=a[e]+1:a[e]=1)}),Object.keys(a).forEach(t=>{if(a[t]>1)return e.$message.error(t+e.$t("multiple")),void(e.validateResult=!1)})}if(this.payLoad.options.defaults.switchDevices&&this.payLoad.options.defaults.switchDevices.length>0&&0==r.filter(this.payLoad.options.defaults.switchDevices,e=>"vSwitch0"==e.switchName).length&&(this.$message.error(this.$t("i18n_at_least_sw0")),e.validateResult=!1),this.payLoad.options.defaults.dnsServers&&0==this.payLoad.options.defaults.dnsServers.length&&(this.$message.error(this.$t("i18n_at_least_dns")),e.validateResult=!1),this.payLoad.options.defaults.ntpServers&&0==this.payLoad.options.defaults.ntpServers.length&&(this.$message.error(this.$t("i18n_at_least_ntp")),e.validateResult=!1),(!this.payLoad.options.defaults.rootPassword||this.payLoad.options.defaults.rootPassword.length<7)&&(this.$message.error(this.$t("i18n_ms_7_long")),e.validateResult=!1),this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length>0)for(let o=0;o<this.payLoad.options.defaults.networkDevices.length;o++)this.payLoad.options.defaults.networkDevices[o].ipv4.vlanIds&&0==this.payLoad.options.defaults.networkDevices[o].ipv4.vlanIds.length&&delete this.payLoad.options.defaults.networkDevices[o].ipv4.vlanIds;return this.validateResult},getAllImage:function(){l["a"].post("/image/allImage",{},e=>{if(this.allImages=r.filter(e.data,e=>"esxi"==e.os),this.allImages&&this.allImages.length){if(!this.payLoad.options.defaults.repo){let e=r.find(this.allImages,e=>"esxi"==e.os);e?this.payLoad.options.defaults.repo=e.url:this.$message.error(this.$t("no_valid_image!"))}}else this.$message.error(this.$t("no_valid_image!"))})},getHardware(){l["a"].get("/bare-metal/hardwares/"+this.$attrs.bareMetalId,null,e=>{this.cpus=e.data.cpus,this.memories=e.data.memories,this.disks=e.data.disks,this.nics=e.data.nics,"em1"==this.payLoad.options.defaults.networkDevices[0].device&&this.nics.length>0&&(this.payLoad.options.defaults.networkDevices[0].device=this.nics[0].mac)})}}},c=d,u=a("2877"),p=Object(u["a"])(c,i,s,!1,null,null,null);t["default"]=p.exports},"931f":function(e,t,a){},"99cb":function(e,t,a){"use strict";a("3d74")},"9bd2":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",[t("el-button",{staticClass:"el-button el-button--default el-button--mini is-plain pointer",on:{click:e.back}},[t("i",{staticClass:"el-icon-back"}),e._v("    "+e._s(e.$t("back"))+" ")]),t("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(e.$t("Discovery_Rule")))]),t("div",{staticClass:"container-discovery"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.handleEdit({},"add")}}},[e._v(e._s(e.$t("add"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"sort-change":function(t){return e.sortChange(t)},"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(a){return t("el-table-column",{attrs:{prop:a.dbProp,label:e.$t(a.label),align:"left",sortable:a.sort}})})),t("el-table-column",{attrs:{prop:"syncStatus",label:e.$t("sync_status"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[-1!=a.row.syncStatus.indexOf("ING")?t("i",{staticClass:"el-icon-loading"}):e._e(),e._v(" "+e._s(e.$t(a.row.syncStatus))+" ")]}}])}),t("el-table-column",{attrs:{prop:"number",label:e.$t("founded_machine_number"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return["0"!=a.row.number?t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.showMachine(a.row)}}},[e._v(" "+e._s(a.row.number)+" ")]):e._e(),"0"==a.row.number?t("span",[e._v(e._s(a.row.number))]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"lastSyncTimestamp",label:e.$t("last_sync_timestamp"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.lastSyncTimestamp))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}}),t("RSButton",{attrs:{type:"sync",tip:e.$t("sync")},on:{click:function(t){return e.handleEdit(a.row,"sync")}}})]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_discovery"):e.$t("add_discovery"),visible:e.editDialogVisible,direction:"rtl",modal:!0,wrapperClosable:!1,appendToBody:!0,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"form",attrs:{model:e.editObj,rules:e.rules,"label-width":"50px","label-position":e.labelPosition}},[t("el-form-item",{attrs:{label:e.$t("name"),prop:"name"}},[t("el-input",{attrs:{autocomplete:"off",maxlength:"30"},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),t("el-form-item",{attrs:{label:e.$t("start_ip"),prop:"startIp"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.startIp,callback:function(t){e.$set(e.editObj,"startIp",t)},expression:"editObj.startIp"}})],1),t("el-form-item",{attrs:{label:e.$t("end_ip"),prop:"endIp"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.endIp,callback:function(t){e.$set(e.editObj,"endIp",t)},expression:"editObj.endIp"}})],1),t("el-form-item",{attrs:{label:e.$t("mask"),prop:"mask"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.mask,callback:function(t){e.$set(e.editObj,"mask",t)},expression:"editObj.mask"}})],1),t("el-form-item",{attrs:{label:e.$t("detect_params"),prop:"params"}},[t("el-switch",{model:{value:e.editObj.config,callback:function(t){e.$set(e.editObj,"config",t)},expression:"editObj.config"}},[e._v(e._s(e.$t("set_detect_params")))]),e.editObj.config?t("table",{staticClass:"test-protocol"},[t("tr",[t("td",[e._v(e._s(e.$t("protocol")))]),t("td",[e._v(e._s(e.$t("possible_params")))]),t("td",[t("RSButton",{attrs:{type:"add",tip:e.$t("add_protocol_param")},on:{click:e.addTestProtocol}})],1)]),e._l(e.editObj.credentialParam,(function(a,i){return t("tr",[t("td",[t("el-select",{model:{value:a.protocol,callback:function(t){e.$set(a,"protocol",t)},expression:"p.protocol"}},e._l(e.protocols,(function(a){return t("el-option",{attrs:{value:a.name,label:e.$t(a.name)}})})),1)],1),t("td",[t("el-form",{ref:"protocolForm",refInFor:!0,attrs:{rules:e.protocolRules,model:a}},e._l(e.findProtocol(a),(function(i){return a&&a.protocol?t("el-form-item",{attrs:{label:e.$t(i.label),prop:i.prop}},["password"==i.type?t("el-input",{attrs:{type:i.type,"show-password":""},model:{value:a[i.prop],callback:function(t){e.$set(a,i.prop,t)},expression:"p[param.prop]"}}):e._e(),"password"!=i.type?t("el-input",{attrs:{type:i.type},model:{value:a[i.prop],callback:function(t){e.$set(a,i.prop,t)},expression:"p[param.prop]"}}):e._e()],1):e._e()})),1)],1),t("td",{staticStyle:{"vertical-align":"center"}},[t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.delTestProtocol(i)}}})],1)])}))],2):e._e()],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)],1)},s=[],l=(a("14d9"),a("b35c")),o=a("30d1"),n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"machine-title"},[t("el-button-group",{staticClass:"batch-button"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v(e._s(e.$t("del"))+" ")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(e._s(e.$t("refresh")))])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingList,expression:"loadingList"}],ref:"multipleTable",staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"left"}}),e._l(e.columns,(function(e){return t("el-table-column",{attrs:{prop:e.prop,label:e.label,align:"left",sortable:e.sort}})})),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("create_time"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"",label:e.$t("opt"),align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("RSButton",{on:{click:function(t){return e.handleEdit(a.row,"edit")}}}),t("RSButton",{attrs:{type:"del"},on:{click:function(t){return e.handleEdit(a.row,"del")}}}),t("RSButton",{attrs:{type:"add",tip:e.$t("add_to_device")},on:{click:function(t){return e.handleEdit(a.row,"addToDevice")}}})]}}])})],2),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.query.pageIndex,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange}})],1),t("el-dialog",{attrs:{title:e.$t("add_to_device"),visible:e.deviceDialogVisible},on:{"update:visible":function(t){e.deviceDialogVisible=t}}},[t("el-form",[t("el-row",[t("el-col",{attrs:{span:e.deviceDialogWidth}},[t("el-form-item",{attrs:{label:e.$t("machine_model"),"label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.curObm.machineModel,callback:function(t){e.$set(e.curObm,"machineModel",t)},expression:"curObm.machineModel"}})],1)],1),t("el-col",{attrs:{span:e.deviceDialogWidth}},[t("el-form-item",{attrs:{label:e.$t("management_ip"),"label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.curObm.managementIp,callback:function(t){e.$set(e.curObm,"managementIp",t)},expression:"curObm.managementIp"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:e.deviceDialogWidth}},[t("el-form-item",{attrs:{label:e.$t("endpoint"),"label-width":e.formLabelWidth}},[t("el-select",{attrs:{placeholder:e.$t("pls_select")},model:{value:e.curObm.endpointId,callback:function(t){e.$set(e.curObm,"endpointId",t)},expression:"curObm.endpointId"}},e._l(e.allEndPoints,(function(e,a){return t("el-option",{attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.deviceDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.obmLoading},on:{click:e.submitOBM}},[e._v(e._s(e.$t("confirm")))])],1)],1),t("el-drawer",{attrs:{title:"edit"==e.editType?e.$t("edit_discovery-devices"):e.$t("add_discovery-devices"),visible:e.editDialogVisible,direction:"rtl",size:"40%",wrapperClosable:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("div",{staticClass:"demo-drawer__content"},[t("el-form",{ref:"form",attrs:{model:e.editObj,rules:e.rules,"label-width":"50px","label-position":e.labelPosition}},[t("el-form-item",{attrs:{label:e.$t("name"),prop:"name"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}})],1),t("el-form-item",{attrs:{label:e.$t("ip"),prop:"ip"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.ip,callback:function(t){e.$set(e.editObj,"ip",t)},expression:"editObj.ip"}})],1),t("el-form-item",{attrs:{label:e.$t("description"),prop:"description"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.description,callback:function(t){e.$set(e.editObj,"description",t)},expression:"editObj.description"}})],1)],1),t("div",{staticClass:"demo-drawer__footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmEdit}},[e._v(e._s(e.loading?e.$t("submitting")+"...":e.$t("confirm"))+" ")])],1)],1)])],1)},r=[];let d=a("2ef0");var c={data(){return{rules:{name:[{validator:o["j"],trigger:"blur",vue:this}],ip:[{validator:o["e"],trigger:"blur",vue:this}],description:[{validator:o["j"],trigger:"blur",vue:this}]},deviceDialogWidth:10,query:{name:"",pageIndex:1,pageSize:10},tableData:[],loadingList:[],multipleSelection:[],delList:[],editVisible:!1,labelPosition:"top",pageTotal:0,idx:-1,id:-1,loading:!1,formLabelWidth:"80px",columns:[{label:this.$t("ip"),prop:"ip",sort:!0},{label:this.$t("description"),prop:"description",sort:!0}],editDialogVisible:!1,deviceDialogVisible:!1,obmLoading:!1,curObm:{},editType:"edit",editObj:{name:null},allOs:[],allOsVersion:[],allEndPoints:[],fileName:null}},computed:{action:function(){return"/discovery-devices/upload?fileName="+this.fileName}},mounted(){this.getData(),this.getAllEndPoints()},methods:{getData(){this.loadingList=!0,l["a"].post("/discovery-devices/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},confirmEdit(){this.validateResult=!0,this.$refs.form.validate(e=>{e||(this.validateResult=!1)}),this.validateResult?(this.loading=!0,this.editObj.brands=JSON.stringify(this.editObj.brands),"edit"==this.editType?l["a"].post("/discovery-devices/update",this.editObj,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("edit_success")),this.getData(),this.loading=!1}):l["a"].post("/discovery-devices/add",this.editObj,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("add_success")),this.getData(),this.loading=!1})):this.$message.error(this.$t("validate_error"))},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=d.map(this.delList,e=>e.id);return e},delAllSelection(){this.multipleSelection.length;let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{l["a"].post("/discovery-devices/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData()):this.$message.success(this.$t("delete_fail"))}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select_discovery-devices")+"!")},handleEdit(e,t){"edit"==t?(this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e))):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{l["a"].get("/discovery-devices/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})}):"addToDevice"==t?(this.deviceDialogVisible=!0,this.curObm={managementIp:e.ip,machineModel:e.name,ruleId:e.bareMetalRuleId}):(this.editDialogVisible=!0,this.editType=t,this.editObj={endpointId:d.find(this.allEndPoints,e=>"main_endpoint"==e.type).id,url:null})},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()},submitOBM(){l["a"].post("discovery-devices/addToBareMetal",this.curObm,e=>{e.data?this.$message.success(this.$t("opt_success")):this.$message.success(this.$t("opt_fail")),this.deviceDialogVisible=!1})},getAllEndPoints(){l["a"].get("/endpoint/getAllEndPoints",{},e=>{this.allEndPoints=e.data,localStorage.setItem("allEndPoints",JSON.stringify(e.data))})}}},u=c,p=(a("3cea"),a("2877")),m=Object(p["a"])(u,n,r,!1,null,"5982fc98",null),_=m.exports,h=a("f395"),f=a("619f");let b=a("2ef0");var g={data(){return{websocket:null,protocols:[{name:"IPMI+Rest",params:[{type:"text",prop:"userName",label:"user_name"},{type:"password",prop:"pwd",label:"pwd"}]},{name:"SNMP",params:[{type:"text",prop:"community",label:"community"},{type:"number",prop:"port",label:"port"}]}],activeName:"discovery",rules:{name:[{validator:o["j"],trigger:"blur",vue:this}],startIp:[{validator:o["e"],trigger:"blur",vue:this}],endIp:[{validator:o["e"],trigger:"blur",vue:this}],mask:[{validator:o["f"],trigger:"blur",vue:this}]},protocolRules:{userName:[{validator:o["j"],trigger:"blur",vue:this}],pwd:[{validator:o["j"],trigger:"blur",vue:this}],community:[{validator:o["j"],trigger:"blur",vue:this}],port:[{validator:o["j"],trigger:"blur",vue:this}]},queryVO:{searchKey:null},query:{name:"",pageIndex:1,pageSize:10},tableData:[],loadingList:[],multipleSelection:[],delList:[],editVisible:!1,labelPosition:"top",pageTotal:0,idx:-1,id:-1,loading:!1,columns:[{label:"name",prop:"name",dbProp:"name",sort:!1},{label:"start_ip",prop:"start_ip",dbProp:"startIp",sort:!1},{label:"end_ip",prop:"end_ip",dbProp:"endIp",sort:!1},{label:"mask",prop:"mask",dbProp:"mask"}],editDialogVisible:!1,editType:"edit",editObj:{name:null},allOs:[],allOsVersion:[],allEndPoints:[],fileName:null}},computed:{action:function(){return"/discovery/upload?fileName="+this.fileName}},components:{Devices:_},mounted(){this.websocket||(this.websocket=new h["a"],this.websocket.openSocket("discovery",this.notify),this.getData())},destroyed(){this.websocket&&this.websocket.close()},methods:{sortChange(e){e.order?this.queryVO.sort=Object(f["b"])(e.prop)+" "+e.order.replace("ending",""):delete this.queryVO.sort,this.getData()},notify(e){this.getData(),this.$notify({title:this.$t("server_message"),message:this.$t("scan_over")})},showMachine(e){e.number&&(this.$emit("queryByRuleId",e.id),this.back())},back(){this.$emit("back"),this.websocket&&this.websocket.close()},delTestProtocol(e){this.editObj.credentialParam.splice(e,1)},addTestProtocol(){this.editObj.credentialParam||(this.editObj.credentialParam=[]),this.editObj.credentialParam.push({protocol:"IPMI+Rest"})},findProtocol(e){return e.protocol?b.find(this.protocols,t=>t.name==e.protocol).params:[]},getData(){this.loadingList=!0,l["a"].post("/discovery/list/"+this.query.pageIndex+"/"+this.query.pageSize,this.queryVO,e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},refreshChildData(){this.$refs.device.getData()},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},confirmEdit(){if(this.validateResult=!0,this.$refs.form.validate(e=>{e||(this.validateResult=!1)}),this.$refs.protocolForm&&this.$refs.protocolForm.forEach(e=>{e.validate(e=>{e||(this.validateResult=!1)})}),!this.validateResult)return void this.$message.error(this.$t("validate_error"));let e=JSON.parse(JSON.stringify(this.editObj));Object(f["a"])(e.mask)?(e.credentialParam=JSON.stringify(this.editObj.credentialParam),this.loading=!0,"edit"==this.editType?l["a"].put("/discovery/update",e,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("edit_success")),this.getData(),this.loading=!1}):l["a"].post("/discovery/add",e,e=>{this.editDialogVisible=!1,this.$message.success(this.$t("add_success")),this.getData(),this.loading=!1})):this.$message.error(this.$t("netmask_validate_error"))},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=b.map(this.delList,e=>e.id);return e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{l["a"].post("/discovery/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData()):this.$message.success(this.$t("delete_fail"))}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select_discovery")+"!")},handleEdit(e,t){if("edit"==t)this.editDialogVisible=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e)),this.editObj.credentialParam=this.editObj.credentialParam?JSON.parse(this.editObj.credentialParam):[],this.resetFields();else if("del"==t)this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{l["a"].delete("/discovery/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})});else if("sync"==t)l["a"].post("/discovery/sync",[e.id],e=>{this.$message.success(this.$t("opt_success")),this.getData()});else{this.editDialogVisible=!0,this.editType=t;let e=b.find(this.allEndPoints,e=>"main_endpoint"==e.type);this.resetFields(),this.editObj={endpointId:e?e.id:null,url:null,config:!0,credentialParam:[{protocol:"IPMI+Rest"}]}}},resetFields(){this.$refs.form&&this.$refs.form.resetFields()},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}},v=g,y=(a("f196"),Object(p["a"])(v,i,s,!1,null,"d36f96bc",null));t["a"]=y.exports},a580:function(e,t,a){"use strict";a("7a04")},a5e7:function(e,t,a){"use strict";a.r(t),t["default"]={cancel:"取消",Networks:"网络","hostname_must_not_have_invalid_word!":"hostname 命名不合法！",Configuration:"配置",fs_type:"分区格式",proc_socket:"处理器插槽",del:"删除",Languages:"语言",cannt_be_null:"参数不能为空",hostname:"HOSTNAME",ExecutionLog:"部署日志",password:"密码",add_network:"添加网络",Endpoint:"Endpoint",controller_id:"控制器号","param_cannot_be_null!":"参数不能为空！","delete_success!":"删除成功",english:"英语",mem_mod_size:"内存容量",disk_detail:"磁盘详情",ERROR:"失败",edit_success:"编辑成功",nic_number:"网卡编号",pls_input_email:"请输入邮箱",user_settable:"配置",edit:"编辑",edit_system_parameter:"编辑系统",Images:"镜像",Workflow:"工作流",delete_fail:"删除失败",batch_del:"批量删除",size:"容量",en_US:"English",detail:"详情",drive:"插槽号",param_value:"参数值",role:"角色",user_name:"用户名",bare_metal:"服务器",pls_input_vlan_id:"请输入vlanId",add_outband:"添加带外",add_workflow:"添加工作流",network_card:"网卡",endpoint:"节点",pls_select_bare_metal:"请选择将执行工作流的服务器",start_ip:"起始 IP",edit_execution_log:"编辑部署日志",pls_input_start_ip:"请输入开始ip",disabled:"否",sn:"序列号",close:"关闭",email:"邮箱",discovering:"发现中",brands:"支持的品牌",validate_error:"参数校验错误",SUCCESS:"成功",delete_success:"删除成功",refresh:"刷新","origin-password":"原密码",Run:"执行",confirm:"确定",discoveryed_devices:"已发现网络设备",pls_input_user_name:"请输入用户名",root_pwd:"ROOT 密码",pls_select_workflow:"请选择工作流",network_devices:"网卡ip设置",deploying:"部署中",raid_disk:"RAID磁盘",operation:"操作",vlan_id:"VlanId",pls_select_discovery:"请选择发现规则",pls_select_image:"请选择镜像",obms:"带外信息",sync_time:"同步时间",confirm_to_del:"确认删除 ？","edit_discovery-devices":"编辑已发现设备",edit_discovery:"编辑发现规则",pls_input_password:"请输入密码",chinese:"中文",view:"查看",management_ip:"带外 IP",proc_num_threads:"线程数",memory_detail:"内存详情",onrack:"已上架",username_pwd_error_login_fail:"用户名/密码错误",info:"信息",add:"添加",endIp:"结束 IP",image:"镜像",create_time:"创建时间",vlanId:"VlanId",pls_select_:"请选择",please_select:"请选择",sync:"同步",Role:"角色",opt:"操作",pxe_enable:"是否开启 PXE",success:"成功",name:"名称",desc:"描述",memory:"内存",show:"显示",description:"描述",cpu_detail:"CPU 详情",pls_select:"请选择",Control:"控制",mem_cpu_num:"内存 CPU 编号",SystemParameter:"系统",GB:"GB",OBM:"带外",change_pwd:"修改密码",ip_invalid_format:"IP 格式错误",invalid_format:"格式错误",OverView:"概览",param_check_error:"参数校验失败！",mask:"子网掩码",last_sync_timestamp:"上次同步时间",pls_input_os_version:"请输入 OS 版本号","not_supported_brand!":"不支持品牌-",Info:"个人信息",input_key_search:"型号/序列号/IP",input_key_search_switch:"名称/IP",add_endpoint:"添加节点",pxeboot:"PXE 重启",edit_fail:"编辑失败",proc_speed:"处理器频率","Bare Metal Server":"服务器",pls_select_network:"请选择子网",os_vesion:"OS 版本",obm:"带外管理",time:"时间",ip_addr:"IP 地址",gateway:"网关",username:"用户名",fanti:"繁体",pls_input_pwd:"请输入密码",edit_network:"编辑网络",type:"类型",Image:"镜像",tips:"提示",hostname_must_not_have_invalid_word:"hostname 不合法",output:"输出",default_params:"默认参数",logout:"退出",event_type:"事件类型",enable:"开启",Network:"网络",id:"ID",proc_num_cores:"处理器核心数",view_detail:"查看详情",selected_workflows:"待执行工作流",IP:"IP",ip:"IP",pls_input_phone:"请输入手机号",add_execution_log:"添加部署日志",Login:"登录",add_system_parameter:"添加系统",pls_select_node:"请选择服务器",system:"系统",pls_select_obm:"请选择带外信息",phone:"手机号",pls_input_url:"请输入 URL 或直接上传 ISO 文件",reset:"重置",sync_status:"同步状态",pls_input_username:"请输入用户名",pwd:"密码",Subnet:"DHCP 子网",add_success:"添加成功",view_execution_log:"查看部署日志",status:"状态",submitting:"提交中",poweron:"启动",pls_select_username:"请选择用户名","add_discovery-devices":"添加到已发现",edit_role:"编辑角色",mac:"mac地址",enabled:"是",capacity:"容量",pls_set_params:"请设置参数",update_time:"更新时间",pls_fill_in_blanks:"请填空",pls_input_end_ip:"请输入结束 IP",add_to_device:"添加到服务器",pls_input_param_value:"请输入参数值",set_workflow_param:"设置工作流参数",poweroff:"关闭",edit_outband:"编辑带外",pls_select_system_parameter:"请选择系统",os_version:"OS 版本",execution_log:"部署日志",machine_model:"品牌/型号",machine_sn:"序列号",PENDING:"同步中","new-password":"新密码",url:"URL",mem_mod_num:"内存插槽号",mem_mod_part_num:"内存型号",discovery:"发现",disable:"关闭",edit_endpoint:"编辑节点",raid_type:"RAID 类型","Execution Log":"部署日志",powercycle:"电源循环",mem_mod_min_volt:"内存最低电压",same_workflow_node:"同一节点不可以同时执行多次同样的工作流",CPU:"CPU",custom_partition:"自定义分区",pls_input_hostname:"请输入 hostname",custom_raid:"自定义 RAID",opt_fail:"操作失败",pls_input_netmask:"请输入子网掩码",view_url:"查看 URL",edit_image:"编辑镜像",login_timeout:"登录超时",end_ip:"结束 IP","confirm-password":"确认新密码",machine_status:"状态",mem_mod_frequency:"内存频率",copy_success:"复制成功",param_config:"参数配置",Resource:"资源",Discovery:"发现",cpu:"CPU",manufactor:"制造商",add_fail:"添加失败",pls_select_password:"请选择密码",disk:"磁盘",network_card_mac:"网卡 MAC 地址",pls_input_params:"该项不能为空",pls_input_name:"请输入名称","pls_select_discovery-devices":"请选择已发现设备",dhcp_enable:"是否开启 DHCP",injectable_name:"工作流模板",proc_name:"处理器型号",no_nessary_to_set:"无参数设置",raid:"RAID级别",startIp:"开始 IP",User:"用户",enclosure_id:"EnclosureId",deployed:"已部署",bmc_mac:"带外 MAC",error:"错误",delete:"删除",mem_mod_type:"内存类型",settable:"是否可设置参数",zh_TW:"繁體中文",add_image:"添加镜像",netmask:"子网掩码",param_key:"参数 Key",ready:"就绪",add_to_selected_wf_list:"添加至待执行工作流",provisioning:"准备中",allocated:"已分配",friendly_name:"名称",os:"OS",opt_success:"操作成功",nic_detail:"网卡详情",endpointId:"节点 ID",mount_point:"挂载点",pls_select_endpoint:"请选择节点","no_valid_image!":"没有找到镜像，请先上传镜像文件！",add_discovery:"添加发现规则",login_fail:"登录失败",zh_CN:"简体中文",Machines:"服务器",user:"用户",Wizard:"使用向导",edit_workflow:"编辑工作流",Plugin:"插件",FILL_OBMS:"补充 OBM 信息",PXE_BOOT_START:"PXE 启动",PXE_BOOT_END:"PXE 启动完毕",PXE_BOOT_CANCEL:"取消 PXE 启动",POST_DISCOVERY_WORKFLOW_START:"下发发现工作流",POST_DISCOVERY_WORKFLOW_END:"发现工作流执行完毕",POST_DISCOVERY_WORKFLOW_CANCEL:"取消发现工作流",POST_OTHER_WORKFLOW_START:"下发通用工作流",POST_OTHER_WORKFLOW_END:"工作流执行完毕",POST_OTHER_WORKFLOW_CANCEL:"取消工作流",POST_OS_WORKFLOW_START:"下发安装系统工作流",POST_OS_WORKFLOW_END:"安装系统工作流执行完毕",POST_OS_WORKFLOW_CANCEL:"取消安装系统工作流",device:"设备",START:"开始",TERMINATE:"用户终止",END:"结束",SUBMIT:"提交",PROCESSING:"处理中",email_format_error:"邮箱格式错误",phone_format_error:"手机格式错误",admin:"管理员",i18n_mount_point_cant_be_null:"挂载点不能为空！",i18n_capacity_cant_be_null:"容量不能为空！",i18n_must_be_root_swap_boot:"必须有根，swap和/boot分区，并且所有分区最低容量不能小于1GB！",i18n_auto_or_number_0_or_1:"分区容量只能是数字或者auto，并且容量为auto的分区只能为0个或者1个!",i18n_must_be_auto_or_number:"分区容量必须是auto或数字！",i18n_swap_must:"swap分区格式必须是swap！",raidDisk:"raidDisk",i18n_file_type_cant_be_null:"文件类型不能为空！",i18n_all_greater_than_1_gb:"所有分区最低容量不能小于1GB！",i18n_mut_only_one:"必须有且仅有一个根，swap和/boot分区！",only_iso_no_more_than_10g:"只能上传ISO文件，且不超过10GB,默认支持官方完整版镜像，如果需要 Minimal 版本，请到 https://docs.rackshift.io/iso/ 下载 ！",drag_file_into_or:"将文件拖到此处，或",click_to_upload:"点击上传",uefi_boot:"UEFI 引导",not_detected:"未在位",not_exists:"未检测到",detected:"在位",obm_not_exists:"带外信息未配置",help_doc:"帮助文档",created:"待执行",running:"执行中",failed:"失败",succeeded:"成功",Task:"任务",instance_id:"任务 Id",i18n_zu:"组",i18n_raid60_must_be_2n:"raid60磁盘数必须是2的倍数！",i18n_di:"第",i18n_raid1_must_be_2:"浪潮机器 raid1 只能是2块磁盘！",i18n_raid1_must_be_2n:"raid1只能是2块或者2n块磁盘！",i18n_raid10_must_be_2n:"raid10磁盘数必须是2的倍数！",i18n_raid50_must_be_2n:"raid50磁盘数必须是2的倍数！",i18n_raid5_must_greater_than_3:"raid5不能少于3块磁盘！",i18n_raid10_must_greater_than_4:"raid10不能少于4块磁盘！",i18n_raid56_must_be_greater_than_8:"raid60不能少于8块磁盘！",i18n_pls_os_must_choose_one_raid:"请至少选择一组磁盘组建raid！",i18n_raid6_must_greater_than_4:"raid6不能少于4块磁盘！",i18n_raid50_must_greater_than_6:"raid50不能少于6块磁盘！",i18n_zu_de_raid_not_config:"组的RAID策略没有设置！",i18n_raid1_must_greater_than_3:"raid3不能少于3块磁盘！",i18n_disk:"磁盘：",i18n_duplicate_in_array:"被重复选择进多个阵列，请检查！",view_log:"查看日志",not_ready:"未就绪",back:"回退",power:"电源",unknown:"未知",on:"开机",off:"关机",detect_params:"扫描配置",protocol:"协议",possible_params:"探测参数",community:"社区名称",port:"端口号",founded_machine_number:"已发现数量",Discovery_Rule:"发现规则",username_or_id:"ID 或邮箱",welcome:"欢迎回来，请输入用户名和密码登录RackShift",no_more_logs:"无更多日志...",about:"关于",about_us:"关于",server_message:"工作流消息",power_on:"开机",power_off:"关机",power_pxe:"PXE 重启",power_reset:"硬重启",sync_success:"同步成功",sync_fail:"同步失败",Executor:"工作流执行器",upload:"上传",upload_success_submit:"请等待上传成功之后再点击提交按钮",selected:"已选择",tai:"台",power_text:"只有配置了正确的带外信息才能通过 IPMI 获取电源状态",machine_brand:"品牌",cancel_task_success:"取消任务成功！请等待任务自动结束！",pxe_open_tip:"该节点将会开启 DHCP PXE 功能，所有该网段的物理机 PXE 启动将会被 RackShift 代理 ",add_protocol_param:"添加一个探测参数","IPMI+Rest":"IPMI 带外控制卡",workflow_submitted:"工作流已下发，请到任务页面查看执行日志",opt_fail_pxe:"操作失败！请先 PXE 启动机器等待物理机走完发现流程补充完整信息之后再补充带外信息","安装Centos7 64位版":"安装 CentOS7 64位版","创建HPE服务器磁盘Raid虚拟磁盘":"创建 HPE 服务器 RAID","搜集HPE服务器磁盘Raid信息":"搜集 HPE 服务器 RAID","清空HPE服务器磁盘和Raid信息":"清空 HPE 服务器 RAID","创建Inspur服务器磁盘Raid虚拟磁盘":"创建 Inspur 服务器 RAID","清空Inspur服务器磁盘和Raid信息":"清空 Inspur 服务器 RAID","搜集Inspur服务器磁盘Raid信息":"搜集 Inspur 服务器 RAID","创建Dell服务器磁盘Raid虚拟磁盘":"创建 Dell 服务器 RAID","清空Dell服务器磁盘和Raid信息":"清空 Dell 服务器 RAID","搜集Dell服务器磁盘Raid信息":"搜集 Dell 服务器 RAID","安装 RedHat7 64位版":"安装 RHEL7 64位版","安装 windowsServer 2012 标准版":"安装 WindowsServer 2012 标准版","安装 windowsServer 2016 标准版":"安装 WindowsServer 2016 标准版","安装 ESXI 6.7":"安装 ESXI 6.7","下发安装系统workflow":"安装系统 WORKFLOW 事件","下发通用workflow":"通用 WORKFLOW 事件","补充OBM信息":"补充 OBM 信息","下发发现workflow":"下发发现 WORKFLOW","主节点":"主节点","从节点":"从节点",version:"版本","搜集New H3C Technologies Co., Ltd.服务器磁盘Raid信息":"搜集 H3C 服务器 RAID","清空New H3C Technologies Co., Ltd.服务器磁盘和Raid信息":"清空 H3C 服务器 RAID","创建New H3C Technologies Co., Ltd.服务器磁盘Raid虚拟磁盘":"创建 H3C 服务器 RAID","搜集 InspurM5 服务器磁盘 Raid 信息":"搜集 InspurM5 服务器 RAID","清空 InspurM5 服务器磁盘 Raid 信息":"清空 InspurM5 服务器 RAID","创建 InspurM5 服务器磁盘 Raid 虚拟磁盘":"创建 InspurM5 服务器 RAID",batch_params:"批量参数设置",common_params:"通用装机参数",nic:"业务网卡编号",productkey:"密钥",smb_user:"SAMBA 用户名",smb_password:"SAMBA 密码",windwos_param:"Windows 参数配置",domain:"域",host_increase:"自增",increase_host_desc:"HOSTNAME1,HOSTNAME2,...",base_number:"HOSTNAME 增长基数",platform:"平台",samba:"SAMBA",msg:"消息",instruction_content:"命令内容",set_detect_params:"设置检查参数",Instruction:"命令",pls_select_task:"请选择任务",base_instruction:"指令模板",pls_select_plugin:"请选择插件",logs:"日志",view_plugin:"查看插件",item:"项目",workflow:"工作流",edit_instruction:"编辑命令",add_instruction:"添加命令",select_machine:"选择物理机",add_plugin:"添加插件","delete_fail!":"删除失败",view_instructions:"查看命令",edit_plugin:"编辑插件",pls_select_instruction:"请选择指令",PXE:"PXE",execute_instruction:"执行命令",pls_select_log:"请选择日志",scan_over:"扫描结束",confirm_to_del_endpoint:"删除节点将会同时删除节点下的所有资源，确认删除？","Centos 64位":"CentOS 64位","RedHat 64位":"RHEL 64位",network_error:"网络错误，请检查网络~",cancelled:"已取消",netmask_validate_error:"子网掩码不合法！",i18n_yigou_disk:" 组存在异构磁盘（比如机械和固态），不能创建 RAID!",COMPLETE:"完成",not_discoveryed:"未完成主动发现搜集其 PXE MAC 地址，请执行对服务器进行 PXE重启！再执行工作流！",is_pxe:"PXE 网卡",true:"是",false:"否",params_not_valid_json:"参数不是标准 json 格式！",cannot_add_more:"不能添加更多网卡配置了！",cannot_add_more_vs:"不能添加更多vSwitch配置了！",pls_input_vlan:"请输入vlanId，多个请用英文”，“隔开！",like_vlan:"例如：vlanId = 1， 填写 ‘1’ 即可，多个请用英文逗号分隔",must_be_number:"只能是数字",i18n_mac_dup:"mac 地址不能重复",add_network_card:"添加网卡",del_network_card:"删除网卡",esxSwitchName:"vSwitch",add_switch:"添加 vSwitch",del_switch:"删除 vSwitch",i18n_at_least_sw0:"至少有一个 vSwitch0",i18n_at_least_dns:"至少有一个 dns",i18n_at_least_ntp:"至少有一个 ntp",multiple:" 重复",nic_not_found:"没有找到网卡",i18n_ms_7_long:"必须大于等于7个字符",no_vlan:" 无 vlan",must_between_0_4095:"必须是 0 - 4095",change:"修改",change_ipmipwd:"修改 IPMI 密码",twp_pwd_notsame:"两次密码不一致","安装 Ubuntu 18.04 64位版":"安装 Ubuntu 18.04 64位版",add_bond:"添加 BOND",del_bond:"删除 BOND",deviceName:"Linux 设备名",switch_port:"交换机端口号",switch_name:"交换机名称",Switch:"交换机",switch:"交换机",snmp_community:"SNMP 社区",snmp_port:"SNMP 端口",ssh_port:"SSH 端口",telnet_port:"TELNET 端口",view_vendor:"设备制造商",Switch_Discovery_Rule:"交换机扫描规则","edit_switch-discovery":"编辑交换机扫描规则",vendor:"制造商",active_ports:"活跃端口",port_detail:"端口详情",api_key:"API KEY",create:"创建",access_key:"Access Key",secret_key:"Secret Key",hide:"隐藏",param:"参数",copy:"复制",copied:"已复制",device_type:"设备类型",volume_group:"LVM 卷组",lvm:"LVM",standard_partition:"标准分区",lvm_name:"LVM 卷名",partition_tips:"自动分配默认等于 kickstart autopart，自定义分区默认只操作第一块磁盘 不管是 standard 标准设备还是 lvm 逻辑设备",ubuntu_pwd:"默认账号密码 ubuntu/root",open_webkvm:"远程 KVM 控制台",post_install:"POST-INSTALL 脚本",view_example:"查看示例",Profile:"引导文件",Template:"安装脚本","Profile already exists!":"引导文件已经存在",add_profile:"添加引导文件",edit_profile:"编辑引导文件",content:"内容",profile:"引导文件",InstallScript:"安装脚本","Template already exists!":"安装脚本已经存在",add_template:"添加安装脚本",edit_template:"编辑安装脚本",template:"安装脚本",more_than_3:"至少3个字符",pls_input:"请输入",not_support_validate:"已选择的镜像已有装机脚本，因此 UI 填写的参数将可能不会生效",backend_upload:"后端挂载",front_upload:"前端上传",mount_text:"默认 http 服务器挂载地址在 /opt/rackshift/rackhd/files/mount/common，也可以直接使用其他第三方 http 服务器",i18n_lvmname_null:"LVM 卷名不能为空",no_param:"参数不存在",pxe_mac:"PXE MAC",remark:"备注",why:"为什么？",pxe_desc:"装机平台以网卡的 MAC 地址为唯一标识，对 PXE 中的物理机进行区分以实现不同机器不同引导流程",not_required:"(非必选，需要自定义脚本时可选择)"}},a788:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("14d9"),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("b35c"),vue__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("2b0e"),_i18n_i18n__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("0692"),_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("30d1");vue__WEBPACK_IMPORTED_MODULE_2__["default"].filter("eventFormat",(function(e){if(!e||0==e.length)return"";let t=[];return localStorage.getItem("allEventType")?t=JSON.parse(localStorage.getItem("allEventType")):_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("workflow/listallEventType",null,e=>{localStorage.setItem("allEventType",JSON.stringify(e.data)),t=e.data}),_i18n_i18n__WEBPACK_IMPORTED_MODULE_3__["default"].t(_.find(t,t=>t.value==e).name)}));let _=__webpack_require__("2ef0");__webpack_exports__["a"]={data(){return{rules:{injectableName:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_4__["i"],trigger:"blur",vue:this}],friendlyName:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_4__["j"],trigger:"blur",vue:this}],eventType:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_4__["i"],trigger:"blur",vue:this}],brands:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_4__["i"],trigger:"blur",vue:this,name:this.$t("brands")}],type:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_4__["j"],trigger:"blur",vue:this}]},activeName:"workflow",query:{name:"",pageIndex:1,pageSize:10},labelPosition:"top",tableData:[],multipleSelection:[],delList:[],editVisible:!1,loadingList:!1,pageTotal:0,form:{},idx:-1,id:-1,loading:!1,columns:[{label:this.$t("type"),prop:"type"}],editDialogVisible:!1,editType:"edit",editObj:{injectableName:null,friendlyName:null,settable:!1,brands:[],defaultParams:null},allEventType:[],allBrands:[],allRackHDWorkflows:[],workflowMap:{}}},mounted(){this.getData(),this.getAllRackHDWorkflows(),this.getAllEventType(),this.getAllBrands()},filters:{enabled:function(e){return e?_i18n_i18n__WEBPACK_IMPORTED_MODULE_3__["default"].t("enabled"):_i18n_i18n__WEBPACK_IMPORTED_MODULE_3__["default"].t("disabled")}},methods:{getAllBrands(){_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("/bare-metal/allBrands",{},e=>{e.success&&(this.allBrands=e.data)})},i18n(e){return this.$t(e)},getValidProText(e,t,a,i){return"type"==t.property?"user"==a?this.$t("custom"):this.$t(a):!0===a?this.$t("enabled"):!1===a?this.$t("disabled"):a},getAllRackHDWorkflows:function(){_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("workflow/listallRackHDWorkflows",null,e=>{this.workflowMap=e.data;let t=this;Object.keys(this.workflowMap).forEach(e=>{t.allRackHDWorkflows.push(t.workflowMap[e])})})},getAllEventType:function(){localStorage.getItem("allEventType")?this.allEventType=JSON.parse(localStorage.getItem("allEventType")):_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("workflow/listallEventType",null,e=>{localStorage.setItem("allEventType",JSON.stringify(e.data)),this.allEventType=e.data})},changeFriendlyName:function(){let e=JSON.parse(JSON.stringify(this.workflowMap[this.editObj.injectableName]));this.editObj.friendlyName=e.friendlyName,this.editObj.settable=!!e.options,this.editObj.defaultParams=JSON.stringify(e.options)},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=_.map(this.delList,e=>e.id);return e},getData(){this.loadingList=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/workflow/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},confirmEdit(){if(this.validateResult=!0,this.$refs.form.validate(e=>{e||(this.validateResult=!1)}),this.validateResult){try{this.editObj.defaultParams&&JSON.parse(this.editObj.defaultParams)}catch(e){return void this.$message.error(this.$t("params_not_valid_json"))}this.loading=!0,this.editObj.brands=JSON.stringify(this.editObj.brands),"edit"==this.editType?_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].put("/workflow/update",this.editObj,e=>{this.editDialogVisible=!1,this.editObj.defaultParams=JSON.stringify(this.editObj.defaultParams),this.$message.success(this.$t("edit_success")),this.getData(),this.loading=!1}):_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/workflow/add",this.editObj,e=>{e.success?(this.editDialogVisible=!1,this.$message.success(this.$t("add_success")),this.getData(),this.loading=!1):this.$message.error(this.$t("add_fail"))})}},handleSelectionChange(e){this.multipleSelection=e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{this.loadingList=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/workflow/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData(),this.multipleSelection=[],this.loadingList=!1):this.$message.success(this.$t("delete_fail"))},e=>{this.$message.success(this.$t("delete_fail")),this.loadingList=!1})}):this.$message.error(this.$t("pls_select_workflow")+"!")},handleEdit(row,type){"edit"==type?(this.editDialogVisible=!0,this.editType=type,this.editObj=JSON.parse(JSON.stringify(row)),this.editObj.brands=eval(this.editObj.brands),this.editObj.settable=eval(this.editObj.settable),this.editObj.friendlyName=this.$t(this.editObj.friendlyName),this.resetFields()):"del"==type?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{this.loadingList=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].delete("/workflow/del/"+row.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!")),this.loadingList=!1},e=>{this.$message.error(this.$t("delete_fail!")),this.loadingList=!1})}):(this.editDialogVisible=!0,this.editType=type,this.resetFields(),this.editObj={injectableName:null,friendlyName:null,settable:!1,status:!1,brands:[],defaultParams:null})},resetFields(){this.$refs.form&&this.$refs.form.resetFields()},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}}},a83d:function(e,t,a){},abde:function(e,t,a){"use strict";a.r(t),a.d(t,"paramMap",(function(){return m})),a.d(t,"isInherit",(function(){return h}));var i=a("b2e4"),s=a("b854"),l=a("f83a"),o=a("af6c"),n=a("65c0"),r=a("c91c"),d=a("5f61"),c=a("e01a"),u=a("5ca6"),p=a("9109");const m={"Graph.InstallCentOS":i["default"],"Graph.InstallRHEL":s["default"],"Graph.InstallWindowsServer":l["default"],"Graph.InstallWindowsServer2016":o["default"],"Graph.Raid.Create.AdaptecRAID":n["default"],"Graph.Raid.Create.HpssaRAID":r["default"],"Graph.Raid.Create.PercRAID":d["default"],"Graph.InstallESXi":p["default"],"Graph.InstallUbuntu":c["default"],"Graph.InstallUbuntuLiveCD":u["default"]},_=["Graph.InstallWindowsServer2016"];function h(e){return-1!=_.indexOf(e)}},ae10:function(e,t,a){e.exports=a.p+"img/rackshift-04.b97648ff.png"},af6c:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("Graph-Install-Windows-Server",{attrs:{bareMetalId:e.bareMetalId,extraParamas:e.extraParams,params:e.params}})},s=[],l=a("f83a"),o={props:["bareMetalId","extraParams","params"],components:{GraphInstallWindowsServer:l["default"]}},n=o,r=a("2877"),d=Object(r["a"])(n,i,s,!1,null,null,null);t["default"]=d.exports},b277:function(e,t,a){},b2e4:function(e,t,a){"use strict";a.r(t);a("14d9");var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"form",attrs:{"label-width":"160px",rules:e.rules,model:e.payLoad.options.defaults,"label-position":"right"}},[t("el-row",[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:e.$t("hostname"),prop:"hostname"}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"20"},model:{value:e.payLoad.options.defaults.hostname,callback:function(t){e.$set(e.payLoad.options.defaults,"hostname",t)},expression:"payLoad.options.defaults.hostname"}})],1),t("el-form-item",{attrs:{label:e.$t("root_pwd"),prop:"rootPassword"}},[t("el-input",{attrs:{autocomplete:"off","show-password":"",maxlength:"20"},model:{value:e.payLoad.options.defaults.rootPassword,callback:function(t){e.$set(e.payLoad.options.defaults,"rootPassword",t)},expression:"payLoad.options.defaults.rootPassword"}})],1),t("el-form-item",{attrs:{label:e.$t("image"),prop:"repo"}},[t("el-select",{staticClass:"input-element",attrs:{filterable:"","allow-create":"","default-first-option":""},on:{change:e.changePT},model:{value:e.payLoad.options.defaults.repo,callback:function(t){e.$set(e.payLoad.options.defaults,"repo",t)},expression:"payLoad.options.defaults.repo"}},e._l(e.allImages,(function(e){return t("el-option",{attrs:{label:e.name,value:e.url}})})),1)],1),e.payLoad.options.defaults.profile?t("el-form-item",{attrs:{label:e.$t("profile"),prop:"repo"}},[t("el-link",{attrs:{target:"_blank"},on:{click:function(t){return e.showContent("profile")}}},[e._v(e._s(e.payLoad.options.defaults.profile))])],1):e._e(),e.payLoad.options.defaults.installScript?t("el-form-item",{attrs:{label:e.$t("InstallScript"),prop:"repo"}},[t("el-link",{attrs:{target:"_blank"},on:{click:function(t){return e.showContent("template")}}},[e._v(e._s(e.payLoad.options.defaults.installScript)+" ")])],1):e._e(),t("el-form-item",{attrs:{label:e.$t("custom_partition")}},[t("el-switch",{on:{change:e.changePartition},model:{value:e.extraParams.customPartition,callback:function(t){e.$set(e.extraParams,"customPartition",t)},expression:"extraParams.customPartition"}}),t("el-tooltip",{staticClass:"dark",attrs:{content:e.partitionTips}},[t("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"20px"}})]),t("table",{directives:[{name:"show",rawName:"v-show",value:e.extraParams.customPartition,expression:"extraParams.customPartition"}],staticClass:"detail-info-rack"},[t("thead",[t("tr",[t("th",[e._v(e._s(e.$t("mount_point")))]),t("th",{staticStyle:{width:"100px"}},[t("el-col",{attrs:{span:8}},[e._v(e._s(e.$t("capacity")))]),t("el-col",{attrs:{span:16}},[t("el-select",{model:{value:e.extraParams.unit,callback:function(t){e.$set(e.extraParams,"unit",t)},expression:"extraParams.unit"}},e._l(e.units,(function(e){return t("el-option",{key:e,attrs:{value:e}})})),1)],1)],1),t("th",[e._v(e._s(e.$t("fs_type")))]),t("th",[e._v(e._s(e.$t("device_type")))]),t("th",[e._v(e._s(e.$t("volume_group")))]),t("th",{staticStyle:{width:"80px"}},[e._v(e._s(e.$t("lvm_name")))]),t("th",[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(t){return e.payLoad.options.defaults.installPartitions.push({})}}})],1)])]),t("tbody",e._l(e.payLoad.options.defaults.installPartitions,(function(a,i){return t("tr",{directives:[{name:"show",rawName:"v-show",value:"biosboot"!=a.mountPoint&&"/boot/efi"!=a.mountPoint,expression:"partition.mountPoint != 'biosboot' && partition.mountPoint != '/boot/efi'"}]},[t("td",[t("el-input",{attrs:{disabled:"biosboot"==a.mountPoint},model:{value:a.mountPoint,callback:function(t){e.$set(a,"mountPoint",t)},expression:"partition.mountPoint"}})],1),t("td",[t("el-input",{attrs:{disabled:"biosboot"==a.mountPoint,title:"biosboot"==a.mountPoint?"MB":e.extraParams.unit},model:{value:a.size,callback:function(t){e.$set(a,"size",t)},expression:"partition.size"}})],1),t("td",[t("el-select",{attrs:{disabled:"biosboot"==a.mountPoint},model:{value:a.fsType,callback:function(t){e.$set(a,"fsType",t)},expression:"partition.fsType"}},e._l(e.fsType,(function(a){return t("el-option",{attrs:{value:a}},[t("span",[e._v(e._s(a))])])})),1)],1),t("td",[t("el-select",{attrs:{disabled:"biosboot"==a.mountPoint},model:{value:a.deviceType,callback:function(t){e.$set(a,"deviceType",t)},expression:"partition.deviceType"}},e._l(e.deviceType,(function(a){return t("el-option",{attrs:{value:a.value}},[t("span",[e._v(e._s(a.value))])])})),1)],1),t("td",[t("el-select",{attrs:{disabled:"biosboot"==a.mountPoint||"standard"==a.deviceType},model:{value:a.volumeGroup,callback:function(t){e.$set(a,"volumeGroup",t)},expression:"partition.volumeGroup"}},e._l(e.volumeGroup,(function(a){return t("el-option",{attrs:{value:a}},[t("span",[e._v(e._s(a))])])})),1)],1),t("td",[t("el-input",{attrs:{disabled:"biosboot"==a.mountPoint||"standard"==a.deviceType},model:{value:a.lvmName,callback:function(t){e.$set(a,"lvmName",t)},expression:"partition.lvmName"}})],1),t("td",[t("el-button",{attrs:{type:"primary",icon:"el-icon-minus",circle:""},on:{click:function(t){return e.payLoad.options.defaults.installPartitions.splice(i,1)}}})],1)])})),0)])],1),t("el-form-item",{attrs:{label:e.$t("uefi_boot")}},[t("el-switch",{on:{change:e.changeUefiBoot},model:{value:e.extraParams.uefi,callback:function(t){e.$set(e.extraParams,"uefi",t)},expression:"extraParams.uefi"}})],1),t("el-form-item",{attrs:{label:e.$t("post_install")}},[t("RSCodeMirror",{on:{receiveValue:e.receiveValue},model:{value:e.payLoad.options.defaults.postInstallCommands,callback:function(t){e.$set(e.payLoad.options.defaults,"postInstallCommands",t)},expression:"payLoad.options.defaults.postInstallCommands"}})],1)],1),t("el-col",{attrs:{span:13}},[t("el-form-item",{attrs:{label:e.$t("network_card")}},[t("RSButton",{attrs:{type:"add",tip:e.$t("add_network_card")},on:{click:e.addNet}}),t("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.payLoad.options.defaults.networkDevices,(function(a,i){return t("el-collapse-item",{attrs:{title:e.getNetworkName(a),name:i+""}},[t("RSButton",{attrs:{type:"del",tip:e.$t("del_network_card")},on:{click:function(t){return e.delNet(i)}}}),t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:a,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"device",label:e.$t("pls_select_")+e.$t("network_card")}},[t("el-select",{staticClass:"input-element",model:{value:a.device,callback:function(t){e.$set(a,"device",t)},expression:"d.device"}},e._l(e.nics,(function(a){return t("el-option",{attrs:{value:a.mac}},[t("span",[e._v(" "+e._s(a.number+"("+a.mac+")")+" "),a.pxe?t("span",{staticStyle:{color:"red"}},[e._v(e._s(" "+e.$t("is_pxe")))]):e._e()])])})),1)],1),t("el-form",{ref:"nic2Form",refInFor:!0,attrs:{model:a.ipv4,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"ipAddr",label:e.$t("ip_addr")}},[t("el-input",{model:{value:a.ipv4.ipAddr,callback:function(t){e.$set(a.ipv4,"ipAddr",t)},expression:"d.ipv4.ipAddr"}})],1),t("el-form-item",{attrs:{prop:"gateway",label:e.$t("gateway")}},[t("el-input",{model:{value:a.ipv4.gateway,callback:function(t){e.$set(a.ipv4,"gateway",t)},expression:"d.ipv4.gateway"}})],1),t("el-form-item",{attrs:{prop:"netmask",label:e.$t("netmask")}},[t("el-input",{model:{value:a.ipv4.netmask,callback:function(t){e.$set(a.ipv4,"netmask",t)},expression:"d.ipv4.netmask"}})],1),t("el-form-item",{attrs:{prop:"vlanIds",label:e.$t("vlan")}},[t("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:e.$t("pls_input_vlan")},on:{change:function(t){return e.changeInt(a)}},model:{value:a.ipv4.vlanIds,callback:function(t){e.$set(a.ipv4,"vlanIds",t)},expression:"d.ipv4.vlanIds"}})],1)],1)],1)],1)})),1)],1),t("el-form-item",{attrs:{label:e.$t("BOND4(802.3ad)")}},[t("RSButton",{attrs:{type:"add",tip:e.$t("add_bond")},on:{click:e.addBond}}),t("el-collapse",{model:{value:e.bondActiveNames,callback:function(t){e.bondActiveNames=t},expression:"bondActiveNames"}},e._l(e.payLoad.options.defaults.bonds,(function(a,i){return t("el-collapse-item",{attrs:{title:a.name,name:"bond"+i}},[t("RSButton",{attrs:{type:"del",tip:e.$t("del_bond")},on:{click:function(t){return e.delBond(i)}}}),t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:a,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"name",label:e.$t("deviceName")}},[t("el-input",{staticClass:"input-element",model:{value:a.name,callback:function(t){e.$set(a,"name",t)},expression:"d.name"}})],1),t("el-form-item",{attrs:{prop:"nics",label:e.$t("pls_select_")+e.$t("network_card")}},[t("el-select",{staticClass:"input-element",attrs:{multiple:""},model:{value:a.nics,callback:function(t){e.$set(a,"nics",t)},expression:"d.nics"}},e._l(e.nics,(function(a){return t("el-option",{attrs:{value:a.mac}},[t("span",[e._v(" "+e._s(a.number+"("+a.mac+")")+" "),a.pxe?t("span",{staticStyle:{color:"red"}},[e._v(e._s(" "+e.$t("is_pxe")))]):e._e()])])})),1)],1),t("el-form",{ref:"nic2Form",refInFor:!0,attrs:{model:a.ipv4,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"ipAddr",label:e.$t("ip_addr")}},[t("el-input",{model:{value:a.ipv4.ipAddr,callback:function(t){e.$set(a.ipv4,"ipAddr",t)},expression:"d.ipv4.ipAddr"}})],1),t("el-form-item",{attrs:{prop:"gateway",label:e.$t("gateway")}},[t("el-input",{model:{value:a.ipv4.gateway,callback:function(t){e.$set(a.ipv4,"gateway",t)},expression:"d.ipv4.gateway"}})],1),t("el-form-item",{attrs:{prop:"netmask",label:e.$t("netmask")}},[t("el-input",{model:{value:a.ipv4.netmask,callback:function(t){e.$set(a.ipv4,"netmask",t)},expression:"d.ipv4.netmask"}})],1)],1),t("el-form-item",{attrs:{prop:"bondvlaninterfaces",label:e.$t("vlan")}},[t("RSButton",{attrs:{type:"add",tip:e.$t("add_vlan")},on:{click:function(t){return e.addBondVlan(a)}}}),e._l(a.bondvlaninterfaces,(function(i,s){return t("el-collapse-item",[t("RSButton",{attrs:{type:"del",tip:e.$t("del_bond")},on:{click:function(t){return e.delBondVlan(a.bondvlaninterfaces,s)}}}),t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:i,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form",{ref:"nic2Form",refInFor:!0,attrs:{model:i.ipv4,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"ipAddr",label:e.$t("ip_addr")}},[t("el-input",{model:{value:i.ipv4.ipAddr,callback:function(t){e.$set(i.ipv4,"ipAddr",t)},expression:"db.ipv4.ipAddr"}})],1),t("el-form-item",{attrs:{prop:"gateway",label:e.$t("gateway")}},[t("el-input",{model:{value:i.ipv4.gateway,callback:function(t){e.$set(i.ipv4,"gateway",t)},expression:"db.ipv4.gateway"}})],1),t("el-form-item",{attrs:{prop:"netmask",label:e.$t("netmask")}},[t("el-input",{model:{value:i.ipv4.netmask,callback:function(t){e.$set(i.ipv4,"netmask",t)},expression:"db.ipv4.netmask"}})],1)],1),t("el-form-item",{attrs:{prop:"vlanid",label:e.$t("vlan")}},[t("el-input",{attrs:{type:"number"},on:{change:function(t){return e.changeVlanId(i)}},model:{value:i.vlanid,callback:function(t){e.$set(i,"vlanid",t)},expression:"db.vlanid"}})],1)],1)],1)}))],2)],1)],1)})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}}),t("el-col",{attrs:{span:12}})],1)],1),t("el-dialog",{attrs:{title:e.tip,visible:e.dialogVisible,"append-to-body":!0,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-input",{attrs:{type:"textarea",rows:"25",cols:"150"},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateScript()}}},[e._v(e._s(e.$t("confirm")))])],1)],1)],1)},s=[],l=a("b35c"),o=a("619f"),n=a("30d1"),r=a("37a3");let d=a("2ef0");var c={activated(){},created(){},deactivated(){},components:{RSCodeMirror:r["a"]},data(){return{tip:null,dialogVisible:!1,content:null,scriptType:null,options:{tabSize:4,styleActiveLine:!0,lineNumbers:!0,autoCloseTags:!0,line:!0,mode:"text/html",theme:"ambiance"},partitionTips:this.$t("partition_tips"),activeNames:"0",bondActiveNames:"bond0",rules:{hostname:[{validator:n["d"],trigger:"blur",vue:this}],rootPassword:[{validator:n["j"],trigger:"blur",vue:this}],repo:[{validator:n["h"],trigger:"blur",vue:this,name:"image"}]},nicRules:{device:[{validator:n["i"],trigger:"blur",vue:this,name:"device"}],ipAddr:[{validator:n["e"],trigger:"blur",vue:this}],netmask:[{validator:n["e"],trigger:"blur",vue:this}],gateway:[{validator:n["e"],trigger:"blur",vue:this}],vlanIds:[{validator:n["k"],trigger:"change",vue:this}],vlanid:[{validator:n["j"],trigger:"change",vue:this}]},uefi:!1,defaultPayLoad:{options:{defaults:{version:"7",repo:null,rootPassword:"RackShift",hostname:"rackshift-node",networkDevices:[{device:null,ipv4:{ipAddr:"192.168.1.10",gateway:"192.168.1.1",netmask:"255.255.255.0"}}],installDisk:"/dev/sda",installPartitions:[{mountPoint:"/",size:"auto",fsType:"ext3",deviceType:"standard"},{mountPoint:"swap",size:"4096",fsType:"swap",deviceType:"standard"},{mountPoint:"/boot",size:"4096",fsType:"ext3",deviceType:"standard"},{mountPoint:"biosboot",size:"1",fsType:"biosboot",deviceType:"standard"}],bonds:[]}}},payLoad:this.$attrs.params,extraParams:this.$attrs.extraParams?JSON.parse(JSON.stringify(this.$attrs.extraParams)):{unit:"MB"},allImages:[],cpus:[],memories:[],disks:[],nics:[],units:["GB","MB"],fsType:["ext3","ext4","swap","xfs","biosboot"],deviceType:[{name:this.$t("lvm"),value:"lvm"},{name:this.$t("standard_partition"),value:"standard"}],volumeGroup:["rootvg"],validateResult:!1}},mounted(){this.getAllImage(),this.getHardware(),this.$watch("extraParams.unit",(function(e,t){if("GB"==t&&"MB"==e)for(var a=0;a<this.payLoad.options.defaults.installPartitions.length&&"biosboot"!=this.payLoad.options.defaults.installPartitions[a].mountPoint;a++)/\d+/.test(this.payLoad.options.defaults.installPartitions[a].size)&&(this.payLoad.options.defaults.installPartitions[a].size=1024*this.payLoad.options.defaults.installPartitions[a].size+"");else if("MB"==t&&"GB"==e)for(a=0;a<this.payLoad.options.defaults.installPartitions.length&&"biosboot"!=this.payLoad.options.defaults.installPartitions[a].mountPoint;a++)/\d+/.test(this.payLoad.options.defaults.installPartitions[a].size)&&(this.payLoad.options.defaults.installPartitions[a].size=parseInt(this.payLoad.options.defaults.installPartitions[a].size/1024)+"");this.extraParams.unit=e,this.changePartition()}))},methods:{changePartition(){this.extraParams.customPartition?this.payLoad.options.defaults.installPartitions=[{mountPoint:"/",size:"auto",fsType:"ext3",deviceType:"standard"},{mountPoint:"swap",size:"4096",fsType:"swap",deviceType:"standard"},{mountPoint:"/boot",size:"4096",fsType:"ext3",deviceType:"standard"},{mountPoint:"biosboot",size:"1",fsType:"biosboot",deviceType:"standard"}]:delete this.payLoad.options.defaults.installPartitions},updateScript(){let e=d.find(this.allImages,e=>e.url==this.payLoad.options.defaults.repo);if(null==e)return;let t={},a=null;"profile"==this.scriptType?(t={id:e.pid,name:e.pName,content:this.content},a="/profile/update"):(t={id:e.tid,name:e.tName,content:this.content},a="/template/update");let i=this;l["a"].put(a,t,e=>{e.data?i.getAllImage():this.$message.error(this.$t("opt_fail"))}),this.dialogVisible=!1},showContent(e){this.scriptType=e;let t=d.find(this.allImages,e=>e.url==this.payLoad.options.defaults.repo);"profile"==e?(this.tip=this.payLoad.options.defaults.profile,this.content=t.pContent):(this.tip=this.payLoad.options.defaults.installScript,this.content=t.tContent),this.dialogVisible=!0},changePT(e){let t=d.find(this.allImages,t=>t.url==e),a=!1;t.pName?(this.payLoad.options.defaults.profile=t.pName,a=!0):delete this.payLoad.options.defaults.profile,t.tName?(this.payLoad.options.defaults.installScript=t.tName,a=!0):delete this.payLoad.options.defaults.installScript,a&&this.$message.info(this.$t("not_support_validate")),this.payLoad.options.defaults.repo=e},receiveValue(e){this.payLoad.options.defaults.postInstallCommands=e},addBond(){this.payLoad.options.defaults.bonds||this.$set(this.payLoad.options.defaults,"bonds",[]),this.payLoad.options.defaults.bonds.push({name:null,nics:[],ipv4:{},bondvlaninterfaces:[]})},addBondVlan(e){e.bondvlaninterfaces.push({vlanid:null,ipv4:{ipAddr:null,gateway:null,netmask:null}})},delBond(e){this.payLoad.options.defaults.bonds.splice(e,1)},delBondVlan(e,t){e.splice(t,1)},changeInt(e){let t=[];e.ipv4.vlanIds.forEach(e=>t.push(Number(e))),e.ipv4.vlanIds=t},changeVlanId(e){e.vlanid=Number(e.vlanid)},getNetworkName(e){return e.device?this.$t("network_card_mac")+" "+e.device:this.$t("network_card_mac")},delNet(e){(this.payLoad.options.defaults.bonds&&this.payLoad.options.defaults.bonds.length>0||this.payLoad.options.defaults.networkDevices.length-1>0)&&this.payLoad.options.defaults.networkDevices.splice(e,1)},addNet(){0!=this.nics.length?this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length==this.nics.length?this.$message.warning(this.$t("cannot_add_more")):this.payLoad.options.defaults.networkDevices.push({device:null,ipv4:{ipAddr:"192.168.1.10",gateway:"192.168.1.1",netmask:"255.255.255.0"}}):this.$message.warning(this.$t("nic_not_found"))},changeUefiBoot:function(){if(this.extraParams.uefi){if(this.payLoad.options.defaults.installPartitions){let e=d.findIndex(this.payLoad.options.defaults.installPartitions,(function(e){return"biosboot"==e.mountPoint}));-1!=e&&(this.payLoad.options.defaults.installPartitions.splice(e,1),this.payLoad.options.defaults.installPartitions.push({mountPoint:"/boot/efi",size:"200",fsType:"vfat"}))}}else{let e=d.findIndex(this.payLoad.options.defaults.installPartitions,(function(e){return"/boot/efi"==e.mountPoint}));-1!=e&&(this.payLoad.options.defaults.installPartitions.splice(e,1),this.payLoad.options.defaults.installPartitions.push({mountPoint:"biosboot",size:"1",fsType:"biosboot"}))}console.table(this.payLoad.options.defaults.installPartitions)},restoreParams:function(){this.restorePartition()},restorePartition:function(){this.payLoad=JSON.parse(JSON.stringify(this.defaultPayLoad)),this.extraParams.unit="MB",this.getAllImage()},valid:function(){this.validateResult=!0;let e=this;if(this.$refs["form"].validate(t=>{t?(e.$refs["nicForm"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})}),e.$refs["nic2Form"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})})):e.validateResult=!1}),!e.validateResult)return void this.$message.error(this.$t("param_check_error"));let t=this.payLoad.options.defaults.hostname,a=this.payLoad.options.defaults.rootPassword;if(this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length>0){let e=this.payLoad.options.defaults.networkDevices[0].device,t=this.payLoad.options.defaults.networkDevices[0].ipv4.ipAddr,a=this.payLoad.options.defaults.networkDevices[0].ipv4.gateway,i=this.payLoad.options.defaults.networkDevices[0].ipv4.netmask;if(Object(o["c"])(e,t,a,i))return this.$message.error(this.$t("param_cannot_be_null!")),!1}if(Object(o["c"])(t,a))return this.$message.error(this.$t("param_cannot_be_null!")),!1;if(/[^0-9a-zA-Z\-]+/.test(t))return this.$message.error(this.$t("hostname_must_not_have_invalid_word!")),!1;let i=0;for(let l=0;this.payLoad.options.defaults.installPartitions&&l<this.payLoad.options.defaults.installPartitions.length;l++){let e=this.payLoad.options.defaults.installPartitions[l];"lvm"!=e.deviceType||e.lvmName||(this.$message.error(this.$t("i18n_lvmname_null")),this.validateResult=!1),e.mountPoint||(this.$message.error(this.$t("i18n_mount_point_cant_be_null")),this.validateResult=!1),e.size||(this.$message.error(this.$t("i18n_capacity_cant_be_null")),this.validateResult=!1),e.fsType||(this.$message.error(this.$t("i18n_file_type_cant_be_null")),this.validateResult=!1),"biosboot"!=e.mountPoint&&("GB"==this.unit&&e.size<1||"MB"==this.unit&&e.size<1024)&&(this.$message.error(this.$t("i18n_all_greater_than_1_gb")),this.validateResult=!1),e.size&&!/^[0-9]*$/.test(e.size)&&"auto"!=e.size&&(this.$message.error(this.$t("i18n_auto_or_number_0_or_1")),this.validateResult=!1),"auto"==e.size||/\d+/.test(e.size)||(this.$message.error(this.$t("i18n_must_be_auto_or_number")),this.validateResult=!1),"/"!=e.mountPoint&&"/boot"!=e.mountPoint&&"swap"!=e.mountPoint&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint||(i++,"swap"==e.mountPoint&&"swap"!=e.fsType&&(this.$message.error(this.$t("i18n_swap_must")),this.validateResult=!1),("GB"==this.unit&&e.size<1&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint||"MB"==this.unit&&e.size<1024&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint)&&(this.$message.error(this.$t("i18n_must_be_root_swap_boot")),this.validateResult=!1))}this.extraParams.customPartition&&4!=i&&(this.$message.error(this.$t("i18n_mut_only_one")),this.validateResult=!1),this.extraParams.customPartition&&this.payLoad.options.defaults.installPartitions.length<4&&(this.$message.error(this.$t("i18n_must_be_root_swap_boot")),this.validateResult=!1);let s=[];if(this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length>0)for(let l=0;l<this.payLoad.options.defaults.networkDevices.length;l++)this.payLoad.options.defaults.networkDevices[l].device&&s.push(this.payLoad.options.defaults.networkDevices[l].device),this.payLoad.options.defaults.networkDevices[l].ipv4.vlanIds&&0==this.payLoad.options.defaults.networkDevices[l].ipv4.vlanIds.length&&delete this.payLoad.options.defaults.networkDevices[l].ipv4.vlanIds;return s=d.groupBy(s,(function(e){return e})),d.forEach(s,t=>{t.length>1&&(this.$message.error(this.$t("i18n_mac_dup")),e.validateResult=!1)}),this.payLoad.options.defaults.bonds&&0==this.payLoad.options.defaults.bonds.length&&delete this.payLoad.options.defaults.bonds,this.validateResult},getAllImage:function(){l["a"].post("/image/allImage",{},e=>{if(this.allImages=d.filter(e.data,e=>"centos"==e.os),this.allImages&&this.allImages.length)if(this.payLoad.options.defaults.repo){let e=this,t=d.find(e.allImages,t=>t.url==e.payLoad.options.defaults.repo);t?(this.payLoad.options.defaults.repo=t.url,t.pName?this.payLoad.options.defaults.profile=t.pName:delete this.payLoad.options.defaults.profile,t.tName?this.payLoad.options.defaults.installScript=t.tName:delete this.payLoad.options.defaults.installScript,(t.pName||t.tName)&&this.$message.info(this.$t("not_support_validate"))):this.payLoad.options.defaults.repo=null}else{let e=d.find(this.allImages,e=>e=>"centos"==e.os);e?(this.payLoad.options.defaults.repo=e.url,e.pName&&(this.payLoad.options.defaults.profile=e.pName),e.tName&&(this.payLoad.options.defaults.installScript=e.tName)):this.$message.error(this.$t("no_valid_image!"))}else this.$message.error(this.$t("no_valid_image!"))})},getHardware(){l["a"].get("/bare-metal/hardwares/"+this.$attrs.bareMetalId,null,e=>{this.cpus=e.data.cpus,this.memories=e.data.memories,this.disks=e.data.disks,this.nics=e.data.nics,this.payLoad.options.defaults.networkDevices&&"em1"==this.payLoad.options.defaults.networkDevices[0].device&&this.nics.length>0&&(this.payLoad.options.defaults.networkDevices[0].device=this.nics[0].mac)})}}},u=c,p=a("2877"),m=Object(p["a"])(u,i,s,!1,null,null,null);t["default"]=m.exports},b35c:function(e,t,a){"use strict";a("d9e2");var i=a("bc3a"),s=a.n(i),l=a("5c96"),o=a("0692");function n(e){this.message=e,this.name="LoginError",Error.captureStackTrace(this,n)}function r(){l["MessageBox"].alert(o["default"].t("login_timeout"),o["default"].t("tips"),{confirmButtonText:o["default"].t("confirm"),callback:e=>{localStorage.removeItem("login"),sessionStorage.removeItem("rsSocket"),window.location.href="/"}})}n.prototype=new Error,n.prototype.constructor=n,s.a.interceptors.response.use((function(e){if(e&&e.data&&"string"==typeof e.data&&-1!=e.data.indexOf("Authentication Status Invalid"))throw new n("login time out");return e}),(function(e){if(e.response&&e.response.data&&-1!=e.response.data.message.indexOf("Authentication Status Invalid"))throw new n("login time out");return Promise.reject(e)}));const d={get:function(e,t,a,i){s.a.get(e,t).then(e=>{e&&(e.data&&e.data.success?a(e.data):e.data?i?i(e.data):l["MessageBox"].alert(e.data):l["MessageBox"].alert(o["default"].t("network_error")))}).catch(e=>{n.prototype.isPrototypeOf(e)?r():l["MessageBox"].alert(o["default"].t("network_error"))})},delete:function(e,t,a,i){s.a.delete(e,t).then(e=>{e&&(e.data&&e.data.success?a(e.data):e.data?i?i(e.data):l["MessageBox"].alert(e.data):l["MessageBox"].alert(o["default"].t("network_error")))}).catch(e=>{n.prototype.isPrototypeOf(e)?r():l["MessageBox"].alert(o["default"].t("network_error"))})},getAsync:async function(e,t){return s.a.get(e,t)},post:(e,t,a,i)=>{s.a.post(e,t,{headers:{"Content-Type":"application/json"}}).then(e=>{a(e.data)}).catch(e=>{i?i(e):n.prototype.isPrototypeOf(e)?r():l["MessageBox"].alert(o["default"].t("network_error"))})},put:(e,t,a,i)=>{s.a.put(e,t,{headers:{"Content-Type":"application/json"}}).then(e=>{a(e.data)}).catch(e=>{i?i(e):n.prototype.isPrototypeOf(e)?r():l["MessageBox"].alert(o["default"].t("network_error"))})}};t["a"]=d},b398:function(e,t,a){"use strict";a("bb0c")},b669:function(e,t,a){},b727:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("14d9"),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("b35c"),_common_utils_CommonUtil__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("619f"),_obm_Obm__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("714f"),_discovery_Discovery__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("9bd2"),vue__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("2b0e"),_i18n_i18n__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("0692"),_common_utils_WebSocket__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("f395"),_common_powerstatus_Power_Status__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("f439"),axios__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("bc3a"),axios__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_9__),get_ip_range__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("6039"),get_ip_range__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(get_ip_range__WEBPACK_IMPORTED_MODULE_10__),_common_bus_bus__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("d7e7"),_rackparams_params__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("abde"),_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("30d1"),_common_script_RSCodeMirror__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("37a3"),_components_bare_metal_AddBareMetal__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("b8fd"),_components_bare_metal_Remark__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("4efa");vue__WEBPACK_IMPORTED_MODULE_5__["default"].filter("statusFilter",(function(e){return _i18n_i18n__WEBPACK_IMPORTED_MODULE_6__["default"].t("PXE")+" "+_i18n_i18n__WEBPACK_IMPORTED_MODULE_6__["default"].t(e.status)}));let _=__webpack_require__("2ef0");__webpack_exports__["a"]={data(){return{directCom:!0,ipmipwdLoading:!1,changeObm:!1,rules:{gateway:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_13__["e"],trigger:"blur",vue:this}],startIp:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_13__["e"],trigger:"blur",vue:this}],endIp:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_13__["e"],trigger:"blur",vue:this}],netmask:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_13__["f"],trigger:"blur",vue:this}],pwd:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_13__["j"],trigger:"blur",vue:this}],confirmPwd:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_13__["j"],trigger:"blur",vue:this}]},fillOBMMode:"single",activeNames:"commonOs",batchParamsLoading:!1,allNicNumber:[],batchParams:!1,bp:{hostname:null,increase:null,baseNumber:null,rootPassword:null,startIp:null,endIp:null,gateway:null,netmask:null,nicNumber:null,domain:null,username:null,smbRepo:null},accurate:!1,groupedSupportedWorkflow:[],discoveryVisible:!1,fillWfParams:!1,executionLogDrawer:!1,activeName:"bare-metal",logTitle:"",loadingLog:!1,currentMachine:{},form:{},logs:[],query:{address:"",name:"",pageIndex:1,pageSize:10},tableData:[],multipleSelection:[],delList:[],editVisible:!1,formLabelWidth:"160px",pageTotal:0,loading:!1,columns:[{label:"CPU",prop:"cpu"},{label:"memory",prop:"memory",expandLanguage:"en_US",custom:!0,formatter:function(e){return e?parseInt(e)+" GB":e}},{label:"disk",prop:"disk",custom:!0,formatter:function(e){return e?parseInt(e)/1e3+" TB":e}}],detailDrawer:!1,actionDrawer:!1,editType:"edit",editObj:{name:null,id:null,email:null,phone:null,roles:[],rolesIds:[]},allGraphDefinitions:[],supportedWorkflow:[],wfRequest:{},workflowParamList:[],paramEditable:!1,selectedWorkflow:[],selectedWorkflowComponent:{},fillOutObms:!1,curObm:{ip:null,userName:null,pwd:null,bareMetalId:null},obmLoading:!1,fillWfParamsLoading:!1,machine:{},detailShowName:"detail",cpuLoading:!1,cpus:[],memories:[],disks:[],nics:[],paramComponent:{},currentWfParamTemplate:{},editWorkflowIndex:-1,queryVO:{searchKey:null},logPoller:null,currentParamConfig:"",loadingList:!1,websocket:null,websocketInterval:null}},components:{RSCodeMirror:_common_script_RSCodeMirror__WEBPACK_IMPORTED_MODULE_14__["a"],OBM:_obm_Obm__WEBPACK_IMPORTED_MODULE_3__["a"],Discovery:_discovery_Discovery__WEBPACK_IMPORTED_MODULE_4__["a"],PowerStatus:_common_powerstatus_Power_Status__WEBPACK_IMPORTED_MODULE_8__["a"],AddBareMetal:_components_bare_metal_AddBareMetal__WEBPACK_IMPORTED_MODULE_15__["a"],Remark:_components_bare_metal_Remark__WEBPACK_IMPORTED_MODULE_16__["a"]},computed:{},destroyed(){this.websocket&&this.websocket.close(),this.websocketInterval&&clearInterval(this.websocketInterval)},mounted(){this.websocket||(this.websocket=new _common_utils_WebSocket__WEBPACK_IMPORTED_MODULE_7__["a"],this.websocket.openSocket("lifecycle",this.notify),this.getData()),this.getAllGraphDefinitions(),_common_bus_bus__WEBPACK_IMPORTED_MODULE_11__["a"].$on("refresh_workflow",this.refreshWorkflow)},methods:{openAdd(){this.$refs.addBareMetal.open()},receiveValue(e){this.bp.postInstallCommands=e},webKVM(e){this.loadingList=!0;let t=this;_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("/bare-metal/webkvm?id="+e.id+"&host="+window.location.origin,{},e=>{window.open(e.data),t.loadingList=!1},e=>{e.message&&t.$alert(e.message),t.loadingList=!1})},setPartition(e){if(e&&e.options&&e.options.defaults&&e.options.defaults.installPartitions&&e.options.defaults.installPartitions.length)for(let t=0;t<e.options.defaults.installPartitions.length;t++){let a=e.options.defaults.installPartitions[t];a.deviceType||(a.deviceType="standard")}},refreshWorkflow(){if(this.selectedWorkflow.length){let e=this;_.map(this.selectedWorkflow,t=>{t.friendlyNameInternational=e.$t(t.friendlyName)})}},handleChange(e){},setParam(e){switch(e){case"ip":let e=Object(get_ip_range__WEBPACK_IMPORTED_MODULE_10__["getIPRange"])(this.bp.startIp,this.bp.endIp),t=0;for(let a=0;a<this.selectedWorkflow.length;a++)this.selectedWorkflow[a].params&&this.selectedWorkflow[a].params.options.defaults&&this.selectedWorkflow[a].params.options.defaults.networkDevices&&e[t]&&this.$set(this.selectedWorkflow[a].params.options.defaults.networkDevices[0].ipv4,"ipAddr",e[t++]);break;case"gateway":this.setNetworkParam("gateway",this.bp.gateway);break;case"netmask":this.setNetworkParam("netmask",this.bp.netmask);break;case"hostname":for(let a=0;a<this.selectedWorkflow.length;a++)this.selectedWorkflow[a].params&&this.selectedWorkflow[a].params.options.defaults&&this.selectedWorkflow[a].params.options.defaults&&(this.bp.baseNumber?this.$set(this.selectedWorkflow[a].params.options.defaults,"hostname",this.bp.hostname+(parseInt(this.bp.baseNumber)+a)):this.$set(this.selectedWorkflow[a].params.options.defaults,"hostname",this.bp.hostname+(a+1)));break;default:break}},setNetworkParam(e,t){for(let a=0;a<this.selectedWorkflow.length;a++)this.selectedWorkflow[a].params&&this.selectedWorkflow[a].params.options.defaults&&this.selectedWorkflow[a].params.options.defaults.networkDevices&&this.bp[e]&&this.$set(this.selectedWorkflow[a].params.options.defaults.networkDevices[0].ipv4,e,t)},setCommonParam(e,t){for(let a=0;a<this.selectedWorkflow.length;a++)this.selectedWorkflow[a].params&&this.selectedWorkflow[a].params.options.defaults&&this.bp[e]&&this.$set(this.selectedWorkflow[a].params.options.defaults,e,t)},setNicNumber(){if(!this.bp.nicNumber)return;let e=this;for(let t=0;t<this.selectedWorkflow.length;t++)e.selectedWorkflow[t].params&&e.selectedWorkflow[t].params.options.defaults&&e.selectedWorkflow[t].params.options.defaults.networkDevices&&e.getHardWarePromise(e.selectedWorkflow[t].bareMetalId).then(a=>{a.data.data.nics.length&&_.find(a.data.data.nics,t=>t.number==e.bp.nicNumber)&&e.$set(e.selectedWorkflow[t].params.options.defaults.networkDevices[0],"device",_.find(a.data.data.nics,t=>t.number==e.bp.nicNumber).mac)})},confirmBatchParams(){this.validateResult=!0,this.$refs.batchParam.validate(e=>{e||(this.validateResult=!1)}),this.validateResult?(this.batchParamsLoading=!0,this.bp.startIp&&this.bp.endIp&&this.setParam("ip"),this.bp.gateway&&this.setParam("gateway",this.bp.gateway),this.bp.netmask&&this.setParam("netmask",this.bp.netmask),this.bp.nicNumber&&this.setNicNumber(),this.bp.postInstallCommands&&this.setCommonParam("postInstallCommands",this.bp.postInstallCommands),this.bp.hostname&&(this.bp.increase?this.setParam("hostname",this.bp.hostname):this.setCommonParam("hostname",this.bp.hostname)),this.bp.rootPassword&&this.setCommonParam("rootPassword",this.bp.rootPassword),this.bp.domain&&this.setCommonParam("domain",this.bp.domain),this.bp.username&&this.setCommonParam("username",this.bp.username),this.bp.smbUser&&this.setCommonParam("smbUser",this.bp.smbUser),this.bp.smbPassword&&this.setCommonParam("smbPassword",this.bp.smbPassword),this.bp.smbRepo&&this.setCommonParam("smbRepo",this.bp.smbRepo),this.batchParamsLoading=!1,this.batchParams=!1,localStorage.setItem("batchParams",JSON.stringify(this.bp))):this.$message.error(this.$t("opt_fail"))},getHardWarePromise(e){return axios__WEBPACK_IMPORTED_MODULE_9___default.a.get("/bare-metal/hardwares/"+e)},getMinNicNumber(){if(this.selectedWorkflow.length){let e=_.map(this.selectedWorkflow,e=>e.bareMetalId),t=[],a=this;e.forEach(e=>{t.push(a.getHardWarePromise(e))});let i=0;Promise.all(t).then((function(e){if(e.length>0){i=e[0].data.data.nics.length,e.forEach(e=>{e.data.data.nics.length&&e.data.data.nics.length<i&&(i=e.data.nics.length)});let t=[];for(let e=0;e<i;e++)t.push({name:"eth"+e,value:"eth"+e});a.allNicNumber=t}}))}},openBatchParams(){this.$refs.batchParam&&this.$refs.batchParam.resetFields(),this.batchParams=!0,localStorage.getItem("batchParams")&&(this.bp=JSON.parse(localStorage.getItem("batchParams"))),this.getMinNicNumber()},filterPower(e,t){return t.power==e},notify(e){this.getData(),""!=e&&this.$notify({title:this.$t("server_message"),message:e})},queryByRuleId(e){e&&(this.queryVO.searchKey=e,this.getData())},openDiscover(){this.discoveryVisible=!0,this.$refs.discoveryCom&&this.$refs.discoveryCom.getData()},statusFilter(e){return-1==e.status.indexOf("ing")?e.pxeMac?'<span style="display: inline-block;white-space: nowrap;">'+this.$t("PXE")+" "+this.$t(e.status)+'<i class="el-icon-check" style="color:#55BA23;margin-left:5px;"></i><br>'+this.$t("OBM")+" "+this.$t("info")+(e.outBandList.length>0?'<i class="el-icon-check" style="color:#55BA23;margin-left:5px;"></i>':'<i class="el-icon-close" style="margin-left:5px;color: red;"></i>')+"</span>":'<span style="display: inline-block;white-space: nowrap;">'+this.$t("PXE")+" "+this.$t("onrack")+"<br>"+this.$t("OBM")+" "+this.$t("info")+(e.outBandList.length>0?'<i class="el-icon-check" style="color:#55BA23;margin-left:5px;"></i>':'<i class="el-icon-close" style="margin-left:5px;color: red;"></i>')+"</span>":'<span style="display: inline-block;white-space: nowrap;">'+this.$t("PXE")+" "+this.$t(e.status)+"<br>"},resizeWith(e){return e.expandLanguage&&e.expandLanguage==localStorage.getItem("lang")?"100px":"90px"},restoreParams(){this.directCom?this.$refs.currentWfParamTemplate.restoreParams():this.$refs.currentWfParamTemplate.$children[0].restoreParams()},buildRequest(e){let t=JSON.parse(JSON.stringify(e));return delete t.componentId,delete t.machineModel,delete t.machineSn,delete t.settable,delete t.brands,delete t.friendlyName,delete t.friendlyNameInternational,t},saveParams(){let e=!0,t=this.directCom?this.$refs.currentWfParamTemplate.payLoad:this.$refs.currentWfParamTemplate.$children[0].payLoad;t&&t.options&&t.options.defaults&&(t.options.defaults.profile||t.options.defaults.installScript)||(this.directCom?this.$refs.currentWfParamTemplate.valid()||(e=!1):this.$refs.currentWfParamTemplate.$children[0].valid()||(e=!1)),e&&(this.selectedWorkflow[this.editWorkflowIndex].params=t,this.selectedWorkflow[this.editWorkflowIndex].extraParams=this.directCom?this.$refs.currentWfParamTemplate.extraParams:this.$refs.currentWfParamTemplate.$children[0].extraParams,this.fillWfParamsLoading=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/workflow/params",this.buildRequest(this.selectedWorkflow[this.editWorkflowIndex]),e=>{this.fillWfParamsLoading=!1,this.fillWfParams=!1}))},copy(e){return JSON.parse(JSON.stringify(e))},editWfParams(e){this.editWorkflowIndex=e;let t=this.selectedWorkflow[e].workflowName+this.selectedWorkflow[e].machineSn;_rackparams_params__WEBPACK_IMPORTED_MODULE_12__["paramMap"][this.selectedWorkflow[e].workflowName]&&(this.selectedWorkflowComponent[t]?this.currentWfParamTemplate=this.selectedWorkflowComponent[t]:(this.currentWfParamTemplate=_.cloneDeep(_rackparams_params__WEBPACK_IMPORTED_MODULE_12__["paramMap"][this.selectedWorkflow[e].workflowName]),this.selectedWorkflowComponent[t]=this.currentWfParamTemplate)),Object(_rackparams_params__WEBPACK_IMPORTED_MODULE_12__["isInherit"])(this.selectedWorkflow[e].workflowName)?this.directCom=!1:this.directCom=!0,this.currentParamConfig=this.selectedWorkflow[e].machineModel+" "+this.$t(this.selectedWorkflow[e].friendlyName)+" "+this.$t("param_config"),this.fillWfParams=!0},power(e,t){this.$confirm(this.$t("confirm")+this.$t("power_"+e)+"?",this.$t("tips"),{type:"warning"}).then(()=>{let a=this;a.loadingList=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("/bare-metal/power/"+t.id+"/"+e,null,e=>{e.success?(this.$message.success(this.$t("success")),this.getData()):this.$message.error(this.$t("error")),a.loadingList=!1},e=>{a.$alert(e),a.loadingList=!1})})},powerBatch(e){"obm"==e||this.$confirm(this.$t("confirm")+this.$t("power_"+e)+"?",this.$t("tips"),{type:"warning"}).then(()=>{let t=this,a=t.getSelectedIds();a.length?(t.loadingList=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/bare-metal/power/"+e,a,e=>{e.success?this.$message.success(this.$t("success")):this.$message.error(e.message),t.loadingList=!1},e=>{t.$alert(e),t.loadingList=!1})):this.$message.error(this.$t("pls_select_")+this.$t("Bare Metal Server")+"!")})},openChangeOBM(){this.getSelectedIds().length?(this.curObm={},this.changeObm=!0):this.$message.error(this.$t("pls_select_")+this.$t("Bare Metal Server")+"!")},changeOBM(e){this.validateResult=!0,this.$refs.ipmiForm.validate(e=>{e||(this.validateResult=!1)}),this.validateResult?this.$confirm(this.$t("confirm")+"?",this.$t("tips"),{type:"warning"}).then(()=>{let t=this,a=t.getSelectedIds();e&&(a=[].concat(e)),a.length?this.curObm.confirmPwd===this.curObm.pwd?(t.ipmipwdLoading=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/outband/changePwd?pwd="+this.curObm.pwd,a,e=>{e.success?(this.$message.info(e.data),this.curObm={}):this.$message.error(e.message),this.changeObm=!1,t.ipmipwdLoading=!1,t.getData()},e=>{t.$alert(e),t.ipmipwdLoading=!1})):this.$message.error(this.$t("twp_pwd_notsame")):this.$message.error(this.$t("pls_select_")+this.$t("Bare Metal Server")+"!")}):this.$message.error(this.$t("opt_fail"))},getHardware(){_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("/bare-metal/hardwares/"+this.machine.id,null,e=>{this.cpus=e.data.cpus,this.memories=e.data.memories,this.disks=e.data.disks,this.nics=e.data.nics})},showDetail(e){this.machine=e,this.detailDrawer=!0,this.getHardware()},fillOBM(e,t){if("batch"!=t)e.outBandList.length>0?this.curObm={ip:e.outBandList[0].ip,userName:e.outBandList[0].userName,pwd:e.outBandList[0].pwd,bareMetalId:e.id}:this.curObm={ip:e.managementIp,userName:null,pwd:null,bareMetalId:e.id};else{if(0==this.getSelectedIds().length)return void this.$message.error(this.$t("pls_select_")+this.$t("Bare Metal Server")+"!");this.curObm={userName:null,pwd:null}}this.fillOBMMode=t,this.fillOutObms=!0},submitOBM(){if(this.obmLoading=!0,"single"==this.fillOBMMode&&Object(_common_utils_CommonUtil__WEBPACK_IMPORTED_MODULE_2__["c"])(this.curObm.ip))return this.$message.error(this.$t("pls_fill_in_blanks")),void(this.obmLoading=!1);if(Object(_common_utils_CommonUtil__WEBPACK_IMPORTED_MODULE_2__["c"])(this.curObm.userName,this.curObm.pwd))return this.$message.error(this.$t("pls_fill_in_blanks")),void(this.obmLoading=!1);if("batch"!=this.fillOBMMode)_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/outband/save?bareMetalId="+this.curObm.bareMetalId,this.curObm,e=>{e.success?(this.obmLoading=!1,this.curObm={},this.fillOutObms=!1,this.$message.success(this.$t("opt_success")),this.getData()):this.$alert.error(this.$t("opt_fail_pxe"))},e=>{this.obmLoading=!1});else{let e={obm:this.curObm,ids:this.getSelectedIds()};_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/outband/saveBatch",e,e=>{e.success?(this.obmLoading=!1,this.curObm={},this.fillOutObms=!1,this.$message.success(this.$t("opt_success")),this.getData()):this.$alert.error(this.$t("opt_fail_pxe")),this.fillOBMMode="single"},e=>{this.obmLoading=!1,this.fillOBMMode="single"})}},sortChange(e){e.order?this.queryVO.sort=e.prop+" "+e.order.replace("ending",""):delete this.queryVO.sort,this.getData()},getData(){this.loadingList=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/bare-metal/list/"+this.query.pageIndex+"/"+this.query.pageSize,this.queryVO,e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.detailDrawer=!1,this.actionDrawer=!1,this.discoveryVisible=!1},handleCloseExecutionLog(){this.executionLogDrawer=!1,window.clearInterval(this.logPoller)},cancelForm(){this.loading=!1,this.detailDrawer=!1},confirmEdit(){this.loading=!0,"edit"==this.editType?_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/bare-metal/update",this.editObj,e=>{this.detailDrawer=!1,this.$message.success(this.$t("edit_success")),this.cancelForm(),this.getData()}):_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/bare-metal/add",this.editObj,e=>{this.detailDrawer=!1,this.$message.success(this.$t("add_success")),this.cancelForm(),this.getData()})},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=_.map(this.delList,e=>e.id);return e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{this.loadingList=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/bare-metal/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData(),this.multipleSelection=[],this.loadingList=!1):this.$message.success(this.$t("delete_fail"))},e=>{this.$message.success(this.$t("delete_fail")),this.loadingList=!1})}):this.$message.error(this.$t("pls_select_")+this.$t("Bare Metal Server")+"!")},handleEdit(e,t){"edit"==t?(this.detailDrawer=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e)),this.editObj.rolesIds=_.map(this.editObj.roles,e=>e.id)):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/bare-metal/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})}):(this.detailDrawer=!0,this.editType=t,this.editObj={})},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()},getAllGraphDefinitions(name){_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("/workflow/listall",{name:name},res=>{res.data&&res.data.length>0&&res.data.forEach(w=>{w.brands=eval(w.brands),w.settable=eval(w.settable),w.defaultParams&&(w.defaultParams=JSON.parse(w.defaultParams))}),this.supportedWorkflow=res.data,this.groupedSupportedWorkflow=this.groupWorkflow(res.data)})},groupWorkflow(e){let t=_.groupBy(e,"eventType"),a=[],i=this;return Object.keys(t).forEach(e=>{a.push({key:e,label:i.$t(e),items:t[e]})}),a},openRunWorkflow(){this.multipleSelection.length?this.actionDrawer=!0:this.$message.error(this.$t("pls_select_bare_metal")+"!")},runWorkflow(){if(!this.selectedWorkflow.length)return void this.$message.error(this.$t("pls_select_workflow")+"!");let e=this,t=_.map(this.copy(this.selectedWorkflow),t=>e.buildRequest(t));0!=t.length?-1==_.findIndex(t,e=>e.settable&&!e.params)?_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/workflow/run",t,e=>{e.success?(this.selectedWorkflow=[],this.$notify({title:this.$t("server_message"),message:this.$t("workflow_submitted")})):this.$notify({title:this.$t("server_message"),message:e.message})}):this.$message.error(this.$t("pls_set_params")+"!"):this.$message.error(this.$t("pls_select_node")+"!")},getWorkflowById(){return _.find(this.supportedWorkflow,e=>e.id==this.wfRequest.workflow)},getParamsTemplate(){_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("/workflow/params/"+this.getWorkflowById().injectableName,{},e=>{e.data[0]?this.workflowParamList=e.data:this.workflowParamList=[]})},createWorkflowParamComponent(e){if(!this.paramComponent[e.componentId]){const t=()=>({component:__webpack_require__("264c")("./"+e.workflowName),delay:200,timeout:3e3});let a=vue__WEBPACK_IMPORTED_MODULE_5__["default"].component(e.componentId,t);this.paramComponent[e.componentId]=a}},addToSelectedWorkflow(){let e=this;if(e.getWorkflowById()){let t=_.find(e.supportedWorkflow,t=>t.id==e.getWorkflowById().id);for(let a=0;a<e.multipleSelection.length;a++){if(!e.multipleSelection[a].pxeMac){e.$message.warning(e.multipleSelection[a].machineModel+" ["+e.multipleSelection[a].machineSn+"]"+e.$t("not_discoveryed"));continue}let i=!1,s=e.getWorkflowById().injectableName+"-"+e.multipleSelection[a].id;for(let t=0;t<e.selectedWorkflow.length;t++)e.selectedWorkflow[t].componentId==s&&(i=!0);if(i)continue;if(e.multipleSelection[a].machineBrand&&-1==_.findIndex(t.brands,t=>t==e.multipleSelection[a].machineBrand)){e.$message.error(t.friendlyName+e.$t("not_supported_brand!")+" "+e.multipleSelection[a].machineBrand);continue}let l={},o=null;if(e.workflowParamList.length){let i=_.find(e.workflowParamList,(function(t){return!!t.workflowId&&(t.bareMetalId==e.multipleSelection[a].id&&t.workflowId==e.getWorkflowById().id)}));null==i?l=_.cloneDeep(t.defaultParams):(l=JSON.parse(i.paramsTemplate),o=JSON.parse(i.extraParams))}else l=_.cloneDeep(t.defaultParams);this.setPartition(l),e.selectedWorkflow.push({componentId:e.getWorkflowById().injectableName+"-"+e.multipleSelection[a].id,bareMetalId:e.multipleSelection[a].id,machineModel:e.multipleSelection[a].machineModel,machineSn:e.multipleSelection[a].machineSn,workflowName:e.getWorkflowById().injectableName,workflowId:e.getWorkflowById().id,friendlyName:t.friendlyName,friendlyNameInternational:this.$t(t.friendlyName),settable:t.settable,params:l,extraParams:o})}}},deleteSelectedWorkflow(e){this.editWorkflowIndex=e,this.selectedWorkflow.splice(e,1)}}}},b854:function(e,t,a){"use strict";a.r(t);a("14d9");var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"form",attrs:{"label-width":"160px",rules:e.rules,model:e.payLoad.options.defaults,"label-position":"right"}},[t("el-row",[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:e.$t("hostname"),prop:"hostname"}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"20"},model:{value:e.payLoad.options.defaults.hostname,callback:function(t){e.$set(e.payLoad.options.defaults,"hostname",t)},expression:"payLoad.options.defaults.hostname"}})],1),t("el-form-item",{attrs:{label:e.$t("root_pwd"),prop:"rootPassword"}},[t("el-input",{attrs:{autocomplete:"off","show-password":"",maxlength:"20"},model:{value:e.payLoad.options.defaults.rootPassword,callback:function(t){e.$set(e.payLoad.options.defaults,"rootPassword",t)},expression:"payLoad.options.defaults.rootPassword"}})],1),t("el-form-item",{attrs:{label:e.$t("image"),prop:"repo"}},[t("el-select",{staticClass:"input-element",attrs:{filterable:"","allow-create":"","default-first-option":""},on:{change:e.changePT},model:{value:e.payLoad.options.defaults.repo,callback:function(t){e.$set(e.payLoad.options.defaults,"repo",t)},expression:"payLoad.options.defaults.repo"}},e._l(e.allImages,(function(e){return t("el-option",{attrs:{label:e.name,value:e.url}})})),1)],1),e.payLoad.options.defaults.profile?t("el-form-item",{attrs:{label:e.$t("profile"),prop:"repo"}},[t("el-link",{attrs:{target:"_blank"},on:{click:function(t){return e.showContent("profile")}}},[e._v(e._s(e.payLoad.options.defaults.profile))])],1):e._e(),e.payLoad.options.defaults.installScript?t("el-form-item",{attrs:{label:e.$t("InstallScript"),prop:"repo"}},[t("el-link",{attrs:{target:"_blank"},on:{click:function(t){return e.showContent("template")}}},[e._v(e._s(e.payLoad.options.defaults.installScript)+" ")])],1):e._e(),t("el-form-item",{attrs:{label:e.$t("custom_partition")}},[t("el-switch",{on:{change:e.changePartition},model:{value:e.extraParams.customPartition,callback:function(t){e.$set(e.extraParams,"customPartition",t)},expression:"extraParams.customPartition"}}),t("el-tooltip",{staticClass:"dark",attrs:{content:e.partitionTips}},[t("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"20px"}})]),t("table",{directives:[{name:"show",rawName:"v-show",value:e.extraParams.customPartition,expression:"extraParams.customPartition"}],staticClass:"detail-info-rack"},[t("thead",[t("tr",[t("th",[e._v(e._s(e.$t("mount_point")))]),t("th",{staticStyle:{width:"100px"}},[t("el-col",{attrs:{span:8}},[e._v(e._s(e.$t("capacity")))]),t("el-col",{attrs:{span:16}},[t("el-select",{model:{value:e.extraParams.unit,callback:function(t){e.$set(e.extraParams,"unit",t)},expression:"extraParams.unit"}},e._l(e.units,(function(e){return t("el-option",{key:e,attrs:{value:e}})})),1)],1)],1),t("th",[e._v(e._s(e.$t("fs_type")))]),t("th",[e._v(e._s(e.$t("device_type")))]),t("th",[e._v(e._s(e.$t("volume_group")))]),t("th",{staticStyle:{width:"80px"}},[e._v(e._s(e.$t("lvm_name")))]),t("th",[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(t){return e.payLoad.options.defaults.installPartitions.push({})}}})],1)])]),t("tbody",e._l(e.payLoad.options.defaults.installPartitions,(function(a,i){return t("tr",{directives:[{name:"show",rawName:"v-show",value:"biosboot"!=a.mountPoint&&"/boot/efi"!=a.mountPoint,expression:"partition.mountPoint != 'biosboot' && partition.mountPoint != '/boot/efi'"}]},[t("td",[t("el-input",{attrs:{disabled:"biosboot"==a.mountPoint},model:{value:a.mountPoint,callback:function(t){e.$set(a,"mountPoint",t)},expression:"partition.mountPoint"}})],1),t("td",[t("el-input",{attrs:{disabled:"biosboot"==a.mountPoint,title:"biosboot"==a.mountPoint?"MB":e.extraParams.unit},model:{value:a.size,callback:function(t){e.$set(a,"size",t)},expression:"partition.size"}})],1),t("td",[t("el-select",{attrs:{disabled:"biosboot"==a.mountPoint},model:{value:a.fsType,callback:function(t){e.$set(a,"fsType",t)},expression:"partition.fsType"}},e._l(e.fsType,(function(a){return t("el-option",{attrs:{value:a}},[t("span",[e._v(e._s(a))])])})),1)],1),t("td",[t("el-select",{attrs:{disabled:"biosboot"==a.mountPoint},model:{value:a.deviceType,callback:function(t){e.$set(a,"deviceType",t)},expression:"partition.deviceType"}},e._l(e.deviceType,(function(a){return t("el-option",{attrs:{value:a.value}},[t("span",[e._v(e._s(a.value))])])})),1)],1),t("td",[t("el-select",{attrs:{disabled:"biosboot"==a.mountPoint||"standard"==a.deviceType},model:{value:a.volumeGroup,callback:function(t){e.$set(a,"volumeGroup",t)},expression:"partition.volumeGroup"}},e._l(e.volumeGroup,(function(a){return t("el-option",{attrs:{value:a}},[t("span",[e._v(e._s(a))])])})),1)],1),t("td",[t("el-input",{attrs:{disabled:"biosboot"==a.mountPoint||"standard"==a.deviceType},model:{value:a.lvmName,callback:function(t){e.$set(a,"lvmName",t)},expression:"partition.lvmName"}})],1),t("td",[t("el-button",{attrs:{type:"primary",icon:"el-icon-minus",circle:""},on:{click:function(t){return e.payLoad.options.defaults.installPartitions.splice(i,1)}}})],1)])})),0)])],1),t("el-form-item",{attrs:{label:e.$t("uefi_boot")}},[t("el-switch",{on:{change:e.changeUefiBoot},model:{value:e.extraParams.uefi,callback:function(t){e.$set(e.extraParams,"uefi",t)},expression:"extraParams.uefi"}})],1),t("el-form-item",{attrs:{label:e.$t("post_install")}},[t("RSCodeMirror",{on:{receiveValue:e.receiveValue},model:{value:e.payLoad.options.defaults.postInstallCommands,callback:function(t){e.$set(e.payLoad.options.defaults,"postInstallCommands",t)},expression:"payLoad.options.defaults.postInstallCommands"}})],1)],1),t("el-col",{attrs:{span:13}},[t("el-form-item",{attrs:{label:e.$t("network_card")}},[t("RSButton",{attrs:{type:"add",tip:e.$t("add_network_card")},on:{click:e.addNet}}),t("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.payLoad.options.defaults.networkDevices,(function(a,i){return t("el-collapse-item",{attrs:{title:e.getNetworkName(a),name:i+""}},[t("RSButton",{attrs:{type:"del",tip:e.$t("del_network_card")},on:{click:function(t){return e.delNet(i)}}}),t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:a,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"device",label:e.$t("pls_select_")+e.$t("network_card")}},[t("el-select",{staticClass:"input-element",model:{value:a.device,callback:function(t){e.$set(a,"device",t)},expression:"d.device"}},e._l(e.nics,(function(a){return t("el-option",{attrs:{value:a.mac}},[t("span",[e._v(" "+e._s(a.number+"("+a.mac+")")+" "),a.pxe?t("span",{staticStyle:{color:"red"}},[e._v(e._s(" "+e.$t("is_pxe")))]):e._e()])])})),1)],1),t("el-form",{ref:"nic2Form",refInFor:!0,attrs:{model:a.ipv4,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"ipAddr",label:e.$t("ip_addr")}},[t("el-input",{model:{value:a.ipv4.ipAddr,callback:function(t){e.$set(a.ipv4,"ipAddr",t)},expression:"d.ipv4.ipAddr"}})],1),t("el-form-item",{attrs:{prop:"gateway",label:e.$t("gateway")}},[t("el-input",{model:{value:a.ipv4.gateway,callback:function(t){e.$set(a.ipv4,"gateway",t)},expression:"d.ipv4.gateway"}})],1),t("el-form-item",{attrs:{prop:"netmask",label:e.$t("netmask")}},[t("el-input",{model:{value:a.ipv4.netmask,callback:function(t){e.$set(a.ipv4,"netmask",t)},expression:"d.ipv4.netmask"}})],1),t("el-form-item",{attrs:{prop:"vlanIds",label:e.$t("vlan")}},[t("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:e.$t("pls_input_vlan")},on:{change:function(t){return e.changeInt(a)}},model:{value:a.ipv4.vlanIds,callback:function(t){e.$set(a.ipv4,"vlanIds",t)},expression:"d.ipv4.vlanIds"}})],1)],1)],1)],1)})),1)],1),t("el-form-item",{attrs:{label:e.$t("BOND4(802.3ad)")}},[t("RSButton",{attrs:{type:"add",tip:e.$t("add_bond")},on:{click:e.addBond}}),t("el-collapse",{model:{value:e.bondActiveNames,callback:function(t){e.bondActiveNames=t},expression:"bondActiveNames"}},e._l(e.payLoad.options.defaults.bonds,(function(a,i){return t("el-collapse-item",{attrs:{title:a.name,name:"bond"+i}},[t("RSButton",{attrs:{type:"del",tip:e.$t("del_bond")},on:{click:function(t){return e.delBond(i)}}}),t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:a,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"name",label:e.$t("deviceName")}},[t("el-input",{staticClass:"input-element",model:{value:a.name,callback:function(t){e.$set(a,"name",t)},expression:"d.name"}})],1),t("el-form-item",{attrs:{prop:"nics",label:e.$t("pls_select_")+e.$t("network_card")}},[t("el-select",{staticClass:"input-element",attrs:{multiple:""},model:{value:a.nics,callback:function(t){e.$set(a,"nics",t)},expression:"d.nics"}},e._l(e.nics,(function(a){return t("el-option",{attrs:{value:a.mac}},[t("span",[e._v(" "+e._s(a.number+"("+a.mac+")")+" "),a.pxe?t("span",{staticStyle:{color:"red"}},[e._v(e._s(" "+e.$t("is_pxe")))]):e._e()])])})),1)],1),t("el-form",{ref:"nic2Form",refInFor:!0,attrs:{model:a.ipv4,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"ipAddr",label:e.$t("ip_addr")}},[t("el-input",{model:{value:a.ipv4.ipAddr,callback:function(t){e.$set(a.ipv4,"ipAddr",t)},expression:"d.ipv4.ipAddr"}})],1),t("el-form-item",{attrs:{prop:"gateway",label:e.$t("gateway")}},[t("el-input",{model:{value:a.ipv4.gateway,callback:function(t){e.$set(a.ipv4,"gateway",t)},expression:"d.ipv4.gateway"}})],1),t("el-form-item",{attrs:{prop:"netmask",label:e.$t("netmask")}},[t("el-input",{model:{value:a.ipv4.netmask,callback:function(t){e.$set(a.ipv4,"netmask",t)},expression:"d.ipv4.netmask"}})],1)],1),t("el-form-item",{attrs:{prop:"bondvlaninterfaces",label:e.$t("vlan")}},[t("RSButton",{attrs:{type:"add",tip:e.$t("add_vlan")},on:{click:function(t){return e.addBondVlan(a)}}}),e._l(a.bondvlaninterfaces,(function(i,s){return t("el-collapse-item",[t("RSButton",{attrs:{type:"del",tip:e.$t("del_bond")},on:{click:function(t){return e.delBondVlan(a.bondvlaninterfaces,s)}}}),t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:i,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form",{ref:"nic2Form",refInFor:!0,attrs:{model:i.ipv4,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"ipAddr",label:e.$t("ip_addr")}},[t("el-input",{model:{value:i.ipv4.ipAddr,callback:function(t){e.$set(i.ipv4,"ipAddr",t)},expression:"db.ipv4.ipAddr"}})],1),t("el-form-item",{attrs:{prop:"gateway",label:e.$t("gateway")}},[t("el-input",{model:{value:i.ipv4.gateway,callback:function(t){e.$set(i.ipv4,"gateway",t)},expression:"db.ipv4.gateway"}})],1),t("el-form-item",{attrs:{prop:"netmask",label:e.$t("netmask")}},[t("el-input",{model:{value:i.ipv4.netmask,callback:function(t){e.$set(i.ipv4,"netmask",t)},expression:"db.ipv4.netmask"}})],1)],1),t("el-form-item",{attrs:{prop:"vlanid",label:e.$t("vlan")}},[t("el-input",{attrs:{type:"number"},on:{change:function(t){return e.changeVlanId(i)}},model:{value:i.vlanid,callback:function(t){e.$set(i,"vlanid",t)},expression:"db.vlanid"}})],1)],1)],1)}))],2)],1)],1)})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}}),t("el-col",{attrs:{span:12}})],1)],1),t("el-dialog",{attrs:{title:e.tip,visible:e.dialogVisible,"append-to-body":!0,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-input",{attrs:{type:"textarea",rows:"25",cols:"150"},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateScript()}}},[e._v(e._s(e.$t("confirm")))])],1)],1)],1)},s=[],l=a("b35c"),o=a("619f"),n=a("30d1"),r=a("37a3");let d=a("2ef0");var c={activated(){},created(){},deactivated(){},components:{RSCodeMirror:r["a"]},data(){return{tip:null,dialogVisible:!1,content:null,scriptType:null,options:{tabSize:4,styleActiveLine:!0,lineNumbers:!0,autoCloseTags:!0,line:!0,mode:"text/html",theme:"ambiance"},partitionTips:this.$t("partition_tips"),activeNames:"0",bondActiveNames:"bond0",rules:{hostname:[{validator:n["d"],trigger:"blur",vue:this}],rootPassword:[{validator:n["j"],trigger:"blur",vue:this}],repo:[{validator:n["h"],trigger:"blur",vue:this,name:"image"}]},nicRules:{device:[{validator:n["i"],trigger:"blur",vue:this,name:"device"}],ipAddr:[{validator:n["e"],trigger:"blur",vue:this}],netmask:[{validator:n["e"],trigger:"blur",vue:this}],gateway:[{validator:n["e"],trigger:"blur",vue:this}],vlanIds:[{validator:n["k"],trigger:"change",vue:this}],vlanid:[{validator:n["j"],trigger:"change",vue:this}]},uefi:!1,defaultPayLoad:{options:{defaults:{version:"7",repo:null,rootPassword:"RackShift",hostname:"rackshift-node",networkDevices:[{device:null,ipv4:{ipAddr:"192.168.1.10",gateway:"192.168.1.1",netmask:"255.255.255.0"}}],installDisk:"/dev/sda",installPartitions:[{mountPoint:"/",size:"auto",fsType:"ext3",deviceType:"standard"},{mountPoint:"swap",size:"4096",fsType:"swap",deviceType:"standard"},{mountPoint:"/boot",size:"4096",fsType:"ext3",deviceType:"standard"},{mountPoint:"biosboot",size:"1",fsType:"biosboot",deviceType:"standard"}],bonds:[]}}},payLoad:this.$attrs.params,extraParams:this.$attrs.extraParams?JSON.parse(JSON.stringify(this.$attrs.extraParams)):{unit:"MB"},allImages:[],cpus:[],memories:[],disks:[],nics:[],units:["GB","MB"],fsType:["ext3","ext4","swap","xfs","biosboot"],deviceType:[{name:this.$t("lvm"),value:"lvm"},{name:this.$t("standard_partition"),value:"standard"}],volumeGroup:["rootvg"],validateResult:!1}},mounted(){this.getAllImage(),this.getHardware(),this.$watch("extraParams.unit",(function(e,t){if("GB"==t&&"MB"==e)for(var a=0;a<this.payLoad.options.defaults.installPartitions.length&&"biosboot"!=this.payLoad.options.defaults.installPartitions[a].mountPoint;a++)/\d+/.test(this.payLoad.options.defaults.installPartitions[a].size)&&(this.payLoad.options.defaults.installPartitions[a].size=1024*this.payLoad.options.defaults.installPartitions[a].size+"");else if("MB"==t&&"GB"==e)for(a=0;a<this.payLoad.options.defaults.installPartitions.length&&"biosboot"!=this.payLoad.options.defaults.installPartitions[a].mountPoint;a++)/\d+/.test(this.payLoad.options.defaults.installPartitions[a].size)&&(this.payLoad.options.defaults.installPartitions[a].size=parseInt(this.payLoad.options.defaults.installPartitions[a].size/1024)+"");this.extraParams.unit=e,this.changePartition()}))},methods:{changePartition(){this.extraParams.customPartition?this.payLoad.options.defaults.installPartitions=[{mountPoint:"/",size:"auto",fsType:"ext3",deviceType:"standard"},{mountPoint:"swap",size:"4096",fsType:"swap",deviceType:"standard"},{mountPoint:"/boot",size:"4096",fsType:"ext3",deviceType:"standard"},{mountPoint:"biosboot",size:"1",fsType:"biosboot",deviceType:"standard"}]:delete this.payLoad.options.defaults.installPartitions},updateScript(){let e=d.find(this.allImages,e=>e.url==this.payLoad.options.defaults.repo);if(null==e)return;let t={},a=null;"profile"==this.scriptType?(t={id:e.pid,name:e.pName,content:this.content},a="/profile/update"):(t={id:e.tid,name:e.tName,content:this.content},a="/template/update");let i=this;l["a"].put(a,t,e=>{e.data?i.getAllImage():this.$message.error(this.$t("opt_fail"))}),this.dialogVisible=!1},showContent(e){this.scriptType=e;let t=d.find(this.allImages,e=>e.url==this.payLoad.options.defaults.repo);"profile"==e?(this.tip=this.payLoad.options.defaults.profile,this.content=t.pContent):(this.tip=this.payLoad.options.defaults.installScript,this.content=t.tContent),this.dialogVisible=!0},changePT(e){let t=d.find(this.allImages,t=>t.url==e),a=!1;t.pName?(this.payLoad.options.defaults.profile=t.pName,a=!0):delete this.payLoad.options.defaults.profile,t.tName?(this.payLoad.options.defaults.installScript=t.tName,a=!0):delete this.payLoad.options.defaults.installScript,a&&this.$message.info(this.$t("not_support_validate")),this.payLoad.options.defaults.repo=e},receiveValue(e){this.payLoad.options.defaults.postInstallCommands=e},addBond(){this.payLoad.options.defaults.bonds||this.$set(this.payLoad.options.defaults,"bonds",[]),this.payLoad.options.defaults.bonds.push({name:null,nics:[],ipv4:{},bondvlaninterfaces:[]})},addBondVlan(e){e.bondvlaninterfaces.push({vlanid:null,ipv4:{ipAddr:null,gateway:null,netmask:null}})},delBond(e){this.payLoad.options.defaults.bonds.splice(e,1)},delBondVlan(e,t){e.splice(t,1)},changeInt(e){let t=[];e.ipv4.vlanIds.forEach(e=>t.push(Number(e))),e.ipv4.vlanIds=t},changeVlanId(e){e.vlanid=Number(e.vlanid)},getNetworkName(e){return e.device?this.$t("network_card_mac")+" "+e.device:this.$t("network_card_mac")},delNet(e){(this.payLoad.options.defaults.bonds&&this.payLoad.options.defaults.bonds.length>0||this.payLoad.options.defaults.networkDevices.length-1>0)&&this.payLoad.options.defaults.networkDevices.splice(e,1)},addNet(){0!=this.nics.length?this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length==this.nics.length?this.$message.warning(this.$t("cannot_add_more")):this.payLoad.options.defaults.networkDevices.push({device:null,ipv4:{ipAddr:"192.168.1.10",gateway:"192.168.1.1",netmask:"255.255.255.0"}}):this.$message.warning(this.$t("nic_not_found"))},changeUefiBoot:function(){if(this.extraParams.uefi){if(this.payLoad.options.defaults.installPartitions){let e=d.findIndex(this.payLoad.options.defaults.installPartitions,(function(e){return"biosboot"==e.mountPoint}));-1!=e&&(this.payLoad.options.defaults.installPartitions.splice(e,1),this.payLoad.options.defaults.installPartitions.push({mountPoint:"/boot/efi",size:"200",fsType:"vfat"}))}}else{let e=d.findIndex(this.payLoad.options.defaults.installPartitions,(function(e){return"/boot/efi"==e.mountPoint}));-1!=e&&(this.payLoad.options.defaults.installPartitions.splice(e,1),this.payLoad.options.defaults.installPartitions.push({mountPoint:"biosboot",size:"1",fsType:"biosboot"}))}console.table(this.payLoad.options.defaults.installPartitions)},restoreParams:function(){this.restorePartition()},restorePartition:function(){this.payLoad=JSON.parse(JSON.stringify(this.defaultPayLoad)),this.extraParams.unit="MB",this.getAllImage()},valid:function(){this.validateResult=!0;let e=this;if(this.$refs["form"].validate(t=>{t?(e.$refs["nicForm"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})}),e.$refs["nic2Form"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})})):e.validateResult=!1}),!e.validateResult)return void this.$message.error(this.$t("param_check_error"));let t=this.payLoad.options.defaults.hostname,a=this.payLoad.options.defaults.rootPassword;if(this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length>0){let e=this.payLoad.options.defaults.networkDevices[0].device,t=this.payLoad.options.defaults.networkDevices[0].ipv4.ipAddr,a=this.payLoad.options.defaults.networkDevices[0].ipv4.gateway,i=this.payLoad.options.defaults.networkDevices[0].ipv4.netmask;if(Object(o["c"])(e,t,a,i))return this.$message.error(this.$t("param_cannot_be_null!")),!1}if(Object(o["c"])(t,a))return this.$message.error(this.$t("param_cannot_be_null!")),!1;if(/[^0-9a-zA-Z\-]+/.test(t))return this.$message.error(this.$t("hostname_must_not_have_invalid_word!")),!1;let i=0;for(let l=0;this.payLoad.options.defaults.installPartitions&&l<this.payLoad.options.defaults.installPartitions.length;l++){let e=this.payLoad.options.defaults.installPartitions[l];"lvm"!=e.deviceType||e.lvmName||(this.$message.error(this.$t("i18n_lvmname_null")),this.validateResult=!1),e.mountPoint||(this.$message.error(this.$t("i18n_mount_point_cant_be_null")),this.validateResult=!1),e.size||(this.$message.error(this.$t("i18n_capacity_cant_be_null")),this.validateResult=!1),e.fsType||(this.$message.error(this.$t("i18n_file_type_cant_be_null")),this.validateResult=!1),"biosboot"!=e.mountPoint&&("GB"==this.unit&&e.size<1||"MB"==this.unit&&e.size<1024)&&(this.$message.error(this.$t("i18n_all_greater_than_1_gb")),this.validateResult=!1),e.size&&!/^[0-9]*$/.test(e.size)&&"auto"!=e.size&&(this.$message.error(this.$t("i18n_auto_or_number_0_or_1")),this.validateResult=!1),"auto"==e.size||/\d+/.test(e.size)||(this.$message.error(this.$t("i18n_must_be_auto_or_number")),this.validateResult=!1),"/"!=e.mountPoint&&"/boot"!=e.mountPoint&&"swap"!=e.mountPoint&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint||(i++,"swap"==e.mountPoint&&"swap"!=e.fsType&&(this.$message.error(this.$t("i18n_swap_must")),this.validateResult=!1),("GB"==this.unit&&e.size<1&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint||"MB"==this.unit&&e.size<1024&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint)&&(this.$message.error(this.$t("i18n_must_be_root_swap_boot")),this.validateResult=!1))}this.extraParams.customPartition&&4!=i&&(this.$message.error(this.$t("i18n_mut_only_one")),this.validateResult=!1),this.extraParams.customPartition&&this.payLoad.options.defaults.installPartitions.length<4&&(this.$message.error(this.$t("i18n_must_be_root_swap_boot")),this.validateResult=!1);let s=[];if(this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length>0)for(let l=0;l<this.payLoad.options.defaults.networkDevices.length;l++)this.payLoad.options.defaults.networkDevices[l].device&&s.push(this.payLoad.options.defaults.networkDevices[l].device),this.payLoad.options.defaults.networkDevices[l].ipv4.vlanIds&&0==this.payLoad.options.defaults.networkDevices[l].ipv4.vlanIds.length&&delete this.payLoad.options.defaults.networkDevices[l].ipv4.vlanIds;return s=d.groupBy(s,(function(e){return e})),d.forEach(s,t=>{t.length>1&&(this.$message.error(this.$t("i18n_mac_dup")),e.validateResult=!1)}),this.payLoad.options.defaults.bonds&&0==this.payLoad.options.defaults.bonds.length&&delete this.payLoad.options.defaults.bonds,this.validateResult},getAllImage:function(){l["a"].post("/image/allImage",{},e=>{if(this.allImages=d.filter(e.data,e=>"redhat"==e.os),this.allImages&&this.allImages.length)if(this.payLoad.options.defaults.repo){let e=this,t=d.find(e.allImages,t=>t.url==e.payLoad.options.defaults.repo);t?(this.payLoad.options.defaults.repo=t.url,t.pName?this.payLoad.options.defaults.profile=t.pName:delete this.payLoad.options.defaults.profile,t.tName?this.payLoad.options.defaults.installScript=t.tName:delete this.payLoad.options.defaults.installScript,(t.pName||t.tName)&&this.$message.info(this.$t("not_support_validate"))):this.payLoad.options.defaults.repo=null}else{let e=d.find(this.allImages,e=>"redhat"==e.os);e?(this.payLoad.options.defaults.repo=e.url,e.pName&&(this.payLoad.options.defaults.profile=e.pName),e.tName&&(this.payLoad.options.defaults.installScript=e.tName)):this.$message.error(this.$t("no_valid_image!"))}else this.$message.error(this.$t("no_valid_image!"))})},getHardware(){l["a"].get("/bare-metal/hardwares/"+this.$attrs.bareMetalId,null,e=>{this.cpus=e.data.cpus,this.memories=e.data.memories,this.disks=e.data.disks,this.nics=e.data.nics,this.payLoad.options.defaults.networkDevices&&"em1"==this.payLoad.options.defaults.networkDevices[0].device&&this.nics.length>0&&(this.payLoad.options.defaults.networkDevices[0].device=this.nics[0].mac)})}}},u=c,p=a("2877"),m=Object(p["a"])(u,i,s,!1,null,null,null);t["default"]=m.exports},b8fd:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.$t("add"),visible:e.addBareMetal,width:"35vw","close-on-click-modal":!1},on:{"update:visible":function(t){e.addBareMetal=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(t){e.addBareMetal=!1}}},[e._v(e._s(e.$t("cancel")))]),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submitAdd}},[e._v(e._s(e.$t("confirm")))])],1)]},proxy:!0}])},[t("el-form",{attrs:{model:e.form}},[t("el-link",[t("el-tooltip",{staticClass:"dark",attrs:{content:e.$t("pxe_desc")}},[t("i",{staticClass:"el-icon-question"},[e._v(e._s(e.$t("why")))])])],1),t("el-form-item",{attrs:{label:e.$t("pxe_mac"),"label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.curObm.pxeMac,callback:function(t){e.$set(e.curObm,"pxeMac",t)},expression:"curObm.pxeMac"}})],1)],1)],1)},s=[],l=a("b35c"),o={data(){return{addBareMetal:!1,loading:!1,curObm:{},form:{},formLabelWidth:"100px"}},methods:{submitAdd(){l["a"].post("/bare-metal/add",this.curObm,e=>{e.success?(this.$message.success(this.$t("opt_success")),this.curObm={},this.close(),this.$emit("confirm")):this.$message.error(e.message)})},open(){this.addBareMetal=!0},close(){this.addBareMetal=!1}}},n=o,r=a("2877"),d=Object(r["a"])(n,i,s,!1,null,null,null);t["a"]=d.exports},b90d:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return dateFormat})),__webpack_require__.d(__webpack_exports__,"a",(function(){return brandsFormat})),__webpack_require__.d(__webpack_exports__,"c",(function(){return endpointFormat}));var _i18n_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("0692");let _=__webpack_require__("2ef0");function dateFormat(e){var t=new Date(e);function a(e){return e<10&&(e="0"+e),e}var i=t.getFullYear(),s=t.getMonth()+1,l=t.getDate(),o=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return i+"-"+a(s)+"-"+a(l)+" "+a(o)+":"+a(n)+":"+a(r)}function brandsFormat(brands){if(brands&&0!=brands.lenghth){let brandList=eval(brands),r="";return brandList.forEach(e=>r+=e+","),r.substr(0,r.length-1)}return""}function endpointFormat(e){let t=_.find(JSON.parse(localStorage.getItem("allEndPoints")),t=>t.id==e);return t?_i18n_i18n__WEBPACK_IMPORTED_MODULE_0__["default"].t(t.name):""}},b9b3:function(e,t,a){e.exports=a.p+"img/rackshift-02.ac4ebcc7.png"},bb0c:function(e,t,a){},c32b:function(module,__webpack_exports__,__webpack_require__){"use strict";var _common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("b35c"),vue__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("2b0e"),_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("30d1"),_i18n_i18n__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("0692");let _=__webpack_require__("2ef0");vue__WEBPACK_IMPORTED_MODULE_1__["default"].filter("endpointType",(function(e){let t=[];return localStorage.getItem("allEndpointTypes")?t=JSON.parse(localStorage.getItem("allEndpointTypes")):_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_0__["a"].get("endpoint/getAllEndPointType",null,e=>{localStorage.setItem("allEndpointTypes",JSON.stringify(e.data)),t=e.data}),_i18n_i18n__WEBPACK_IMPORTED_MODULE_3__["default"].t(_.find(t,t=>t.value==e).name)})),__webpack_exports__["a"]={data(){return{rules:{name:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_2__["j"],trigger:"blur",vue:this}],type:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_2__["j"],trigger:"blur",vue:this,msg:this.$t("pls_select")+this.$t("endpoint")}],ip:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_2__["e"],trigger:"blur",vue:this}]},activeName:"endpoint",query:{name:"",pageIndex:1,pageSize:10},tableData:[],multipleSelection:[],delList:[],editVisible:!1,pageTotal:0,form:{},idx:-1,id:-1,loading:!1,editDialogVisible:!1,editType:"edit",editObj:{name:null,description:null,type:null},allOs:[],allOsVersion:[],allEndPointType:[],loadingList:[]}},mounted(){this.getData(),this.getAllEndPointType()},methods:{onlySlave(e){return"main_endpoint"==e?[{name:this.$t("主节点"),value:"main_endpoint"}]:[{name:this.$t("从节点"),value:"slave_endpoint"}]},getData(){this.loadingList=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_0__["a"].post("/endpoint/list/"+this.query.pageIndex+"/"+this.query.pageSize,{},e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},getAllEndPointType(){_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_0__["a"].get("/endpoint/getAllEndPointType",{},e=>{this.allEndPointType=e.data,localStorage.setItem("allEndpointTypes",JSON.stringify(e.data))})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.editDialogVisible=!1},add(){this.editDialogVisible=!0,this.editType="add"},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=_.map(this.delList,e=>e.id);return e},confirmEdit(){this.validateResult=!0,this.$refs.editForm.validate(e=>{e||(this.validateResult=!1)}),this.validateResult&&(this.loading=!0,this.editObj.brands=JSON.stringify(this.editObj.brands),"edit"==this.editType?_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_0__["a"].put("/endpoint/update",this.editObj,e=>{e.data?(this.editDialogVisible=!1,this.editObj.defaultParams=JSON.stringify(this.editObj.defaultParams),this.$message.success(this.$t("edit_success")),this.getData(),this.loading=!1,this.getAllEndPointType()):(this.$message.error(this.$t("opt_fail")),this.loading=!1)}):_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_0__["a"].post("/endpoint/add",this.editObj,e=>{e.data?(this.$message.success(this.$t("add_success")),this.editDialogVisible=!1):this.$message.error(this.$t("add_fail")),this.getData(),this.loading=!1,this.getAllEndPointType()}))},handleSelectionChange(e){this.multipleSelection=e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del_endpoint"),this.$t("tips"),{type:"warning"}).then(()=>{_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_0__["a"].post("/endpoint/del",e,e=>{e.data?this.$message.success(this.$t("delete_success")):this.$message.error(this.$t("delete_fail")),this.getData()}),this.multipleSelection=[]}):this.$message.error(this.$t("pls_select_endpoint")+"!")},handleEdit(row,type){"edit"==type?(this.editDialogVisible=!0,this.editType=type,this.editObj=JSON.parse(JSON.stringify(row)),this.editObj.brands=eval(this.editObj.brands),this.editObj.settable=eval(this.editObj.settable),this.resetFields()):"del"==type?this.$confirm(this.$t("confirm_to_del_endpoint"),this.$t("tips"),{type:"warning"}).then(()=>{_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_0__["a"].delete("/endpoint/del/"+row.id,{},e=>{e.data?this.$message.success(this.$t("delete_success")):this.$message.error(this.$t("delete_fail")),this.getData()})}):"sync"==type?_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_0__["a"].get("/endpoint/sync",{},e=>{e.data?this.$message.success(this.$t("sync_success")):this.$message.success(this.$t("sync_fail")),this.getData()}):(this.editDialogVisible=!0,this.editType=type,this.resetFields(),this.editObj={status:"1"})},resetFields(){this.$refs.editForm&&this.$refs.editForm.resetFields()},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()}}}},c91c:function(e,t,a){"use strict";a.r(t);a("14d9");var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{attrs:{"label-width":"101px"}},[t("el-form-item",{attrs:{label:e.$t("custom_raid")}},[t("table",{staticClass:"detail-info"},[t("thead",[t("tr",[t("th",[e._v(e._s(e.$t("raid_type")))]),t("th",[e._v(e._s(e.$t("raid_disk")))]),t("th",[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(t){return e.payLoad.options["create-raid"].raidList.push({})}}})],1)])]),t("tbody",e._l(e.payLoad.options["create-raid"].raidList,(function(a,i){return t("tr",[t("td",[t("el-select",{model:{value:a.type,callback:function(t){e.$set(a,"type",t)},expression:"config.type"}},e._l(e.raidTypes,(function(a){return t("el-option",{attrs:{label:a,value:a}},[e._v(" "+e._s(a)+" ")])})),1)],1),t("td",[t("el-select",{attrs:{multiple:""},model:{value:a.drives,callback:function(t){e.$set(a,"drives",t)},expression:"config.drives"}},e._l(e.odisks,(function(a){return t("el-option",{attrs:{label:a.drives,value:a.drive}},[e._v(" "+e._s((a.type?a.type:e.$t("unknown"))+" raidLevel:"+(a.raid?a.raid:"无")+"-driveId:"+a.drive+"-"+a.size)+" ")])})),1)],1),t("td",[t("el-button",{attrs:{type:"primary",icon:"el-icon-minus",circle:""},on:{click:function(t){return e.payLoad.options["create-raid"]["raidList"].splice(i,1)}}})],1)])})),0)])])],1)],1)},s=[],l=a("b35c"),o=a("e8de");let n=a("2ef0");var r={activated(){},created(){},deactivated(){},data(){return{defaultPayLoad:{options:{"bootstrap-rancher":{dockerFile:"secure.erase.docker.tar.xz"},"create-raid":{createDefault:!1,controller:1,path:"/usr/sbin/hpssacli",raidList:[{type:null,drives:[]}]}}},raidTypes:["raid0","raid1","raid5","raid10","raid50"],payLoad:this.$attrs.params?JSON.parse(JSON.stringify(this.$attrs.params)):{options:{"bootstrap-rancher":{dockerFile:"secure.erase.docker.tar.xz"},"create-raid":{createDefault:!1,controller:1,path:"/usr/sbin/hpssacli",raidList:[{type:null,drives:[]}]}}},extraParams:this.$attrs.extraParams?JSON.parse(JSON.stringify(this.$attrs.extraParams)):{},cpus:[],memories:[],disks:[],diskMap:{},nics:[],validateResult:!1}},watch:{},computed:{odisks:function(){return n.orderBy(this.disks,["drive"],["asc"])}},mounted(){this.getHardware()},methods:{restoreParams:function(){this.restorePartition()},restorePartition:function(){this.payLoad=JSON.parse(JSON.stringify(this.defaultPayLoad))},valid:function(){let e=this.payLoad.options["create-raid"].raidList;if(0==e.length)return this.$message.error(this.$t("i18n_pls_os_must_choose_one_raid","请至少选择一组磁盘组建raid！")),!1;let t=[];for(let s=0;s<e.length;s++){let a=e[s],i=a.type,l=a.drives;if(Object(o["a"])(this.getSelectDisks(l)))return void this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_yigou_disk"));if(t=t.concat(l),!i)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu_de_raid_not_config")),!1;if(!l||0==l.length)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu_de_raid_not_config")),!1;switch(i){case"raid1":if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid1_must_be_2n")),!1;break;case"raid3":if(l.length<3)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid1_must_greater_than_3")),!1;break;case"raid5":if(l.length<3)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid5_must_greater_than_3")),!1;break;case"raid6":if(l.length<4)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid6_must_greater_than_4")),!1;break;case"raid10":if(l.length<4)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid10_must_greater_than_4")),!1;if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid10_must_be_2n")),!1;break;case"raid50":if(l.length<6)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid50_must_greater_than_6")),!1;if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid50_must_be_2n")),!1;break;case"raid60":if(l.length<8)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid56_must_be_greater_than_8")),!1;if(l.length%2!=0)return this.$message.error(this.$t("i18n_di")+(s+1)+this.$t("i18n_zu")+this.$t("i18n_raid60_must_be_2n")),!1;break}}if(0==t.length)return!1;let a=[],i=[];a=t;for(let s=0;s<a.length;s++){if(-1!=i.indexOf(a[s]))return this.$message.error(this.$t("i18n_disk")+a[s]+this.$t("i18n_duplicate_in_array")),!1;i.push(a[s])}return!0},getHardware(){l["a"].get("/bare-metal/hardwares/"+this.$attrs.bareMetalId,null,e=>{this.cpus=e.data.cpus,this.memories=e.data.memories,this.disks=e.data.disks;let t=this;e.data.disks&&e.data.disks.length>0&&(e.data.disks=n.orderBy(e.data.disks,["drive"],["asc"]),e.data.disks.forEach(e=>t.diskMap[e.drive]=e)),this.nics=e.data.nics})},getSelectDisks(e){let t=[];return e&&e.length&&e.forEach(e=>t.push(this.diskMap[e])),t}}},d=r,c=a("2877"),u=Object(c["a"])(d,i,s,!1,null,null,null);t["default"]=u.exports},d069:function(e,t,a){"use strict";a("3bc2")},d7e7:function(e,t,a){"use strict";var i=a("2b0e");t["a"]=new i["default"]},e01a:function(e,t,a){"use strict";a.r(t);a("14d9");var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"form",attrs:{"label-width":"130px",rules:e.rules,model:e.payLoad.options.defaults,"label-position":"right"}},[t("el-row",[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:e.$t("hostname"),prop:"hostname"}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"20"},model:{value:e.payLoad.options.defaults.hostname,callback:function(t){e.$set(e.payLoad.options.defaults,"hostname",t)},expression:"payLoad.options.defaults.hostname"}})],1),t("el-form-item",{attrs:{label:e.$t("domain"),prop:"domain"}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"20"},model:{value:e.payLoad.options.defaults.domain,callback:function(t){e.$set(e.payLoad.options.defaults,"domain",t)},expression:"payLoad.options.defaults.domain"}})],1),t("el-form-item",{attrs:{label:e.$t("root_pwd"),prop:"rootPassword"}},[t("el-input",{attrs:{autocomplete:"off","show-password":"",maxlength:"20"},model:{value:e.payLoad.options.defaults.rootPassword,callback:function(t){e.$set(e.payLoad.options.defaults,"rootPassword",t)},expression:"payLoad.options.defaults.rootPassword"}})],1),t("el-form-item",{attrs:{label:e.$t("image"),prop:"repo"}},[t("el-select",{staticClass:"input-element",attrs:{filterable:"","allow-create":"","default-first-option":""},on:{change:e.changePT},model:{value:e.payLoad.options.defaults.repo,callback:function(t){e.$set(e.payLoad.options.defaults,"repo",t)},expression:"payLoad.options.defaults.repo"}},e._l(e.allImages,(function(e){return t("el-option",{attrs:{label:e.name,value:e.url}})})),1)],1),e.payLoad.options.defaults.profile?t("el-form-item",{attrs:{label:e.$t("profile"),prop:"repo"}},[t("el-link",{attrs:{target:"_blank"},on:{click:function(t){return e.showContent("profile")}}},[e._v(e._s(e.payLoad.options.defaults.profile))])],1):e._e(),e.payLoad.options.defaults.installScript?t("el-form-item",{attrs:{label:e.$t("InstallScript"),prop:"repo"}},[t("el-link",{attrs:{target:"_blank"},on:{click:function(t){return e.showContent("template")}}},[e._v(e._s(e.payLoad.options.defaults.installScript)+" ")])],1):e._e(),t("el-form-item",{attrs:{label:e.$t("custom_partition")}},[t("el-switch",{model:{value:e.extraParams.customPartition,callback:function(t){e.$set(e.extraParams,"customPartition",t)},expression:"extraParams.customPartition"}}),t("table",{directives:[{name:"show",rawName:"v-show",value:e.extraParams.customPartition,expression:"extraParams.customPartition"}],staticClass:"detail-info-rack"},[t("thead",[t("tr",[t("th",[e._v(e._s(e.$t("mount_point")))]),t("th",[t("el-row",[t("el-col",{attrs:{span:12}},[e._v(e._s(e.$t("capacity")))]),t("el-col",{attrs:{span:12}},[t("el-select",{model:{value:e.extraParams.unit,callback:function(t){e.$set(e.extraParams,"unit",t)},expression:"extraParams.unit"}},e._l(e.units,(function(e){return t("el-option",{key:e,attrs:{value:e}})})),1)],1)],1)],1),t("th",[e._v(e._s(e.$t("fs_type")))]),t("th",[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(t){return e.payLoad.options.defaults.installPartitions.push({})}}})],1)])]),t("tbody",e._l(e.payLoad.options.defaults.installPartitions,(function(a,i){return t("tr",{directives:[{name:"show",rawName:"v-show",value:"biosboot"!=a.mountPoint&&"/boot/efi"!=a.mountPoint,expression:"partition.mountPoint != 'biosboot' && partition.mountPoint != '/boot/efi'"}]},[t("td",[t("el-input",{attrs:{disabled:"biosboot"==a.mountPoint},model:{value:a.mountPoint,callback:function(t){e.$set(a,"mountPoint",t)},expression:"partition.mountPoint"}})],1),t("td",[t("el-input",{attrs:{disabled:"biosboot"==a.mountPoint,title:"biosboot"==a.mountPoint?"MB":e.extraParams.unit},model:{value:a.size,callback:function(t){e.$set(a,"size",t)},expression:"partition.size"}})],1),t("td",[t("el-select",{attrs:{disabled:"biosboot"==a.mountPoint},model:{value:a.fsType,callback:function(t){e.$set(a,"fsType",t)},expression:"partition.fsType"}},e._l(e.fsType,(function(a){return t("el-option",{attrs:{value:a}},[t("span",[e._v(e._s(a))])])})),1)],1),t("td",[t("el-button",{attrs:{type:"primary",icon:"el-icon-minus",circle:""},on:{click:function(t){return e.payLoad.options.defaults.installPartitions.splice(i,1)}}})],1)])})),0)])],1),t("el-form-item",{attrs:{label:e.$t("uefi_boot")}},[t("el-switch",{on:{change:e.changeUefiBoot},model:{value:e.extraParams.uefi,callback:function(t){e.$set(e.extraParams,"uefi",t)},expression:"extraParams.uefi"}})],1)],1),t("el-col",{attrs:{span:13}},[t("el-form-item",{attrs:{label:e.$t("network_card")}},[t("RSButton",{attrs:{type:"add",tip:e.$t("add_network_card")},on:{click:e.addNet}}),t("el-collapse",{model:{value:e.nicActiveNames,callback:function(t){e.nicActiveNames=t},expression:"nicActiveNames"}},e._l(e.payLoad.options.defaults.networkDevices,(function(a,i){return t("el-collapse-item",{attrs:{title:e.getNetworkName(a),name:i+""}},[t("RSButton",{attrs:{type:"del",tip:e.$t("del_network_card")},on:{click:function(t){return e.delNet(i)}}}),t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:a,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"device",label:e.$t("pls_select_")+e.$t("network_card")}},[t("el-select",{staticClass:"input-element",model:{value:a.device,callback:function(t){e.$set(a,"device",t)},expression:"d.device"}},e._l(e.nics,(function(a){return t("el-option",{attrs:{value:a.mac}},[t("span",[e._v(" "+e._s(a.number+"("+a.mac+")")+" "),a.pxe?t("span",{staticStyle:{color:"red"}},[e._v(e._s(" "+e.$t("is_pxe")))]):e._e()])])})),1)],1),t("el-form",{ref:"nic2Form",refInFor:!0,attrs:{model:a.ipv4,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"ipAddr",label:e.$t("ip_addr")}},[t("el-input",{model:{value:a.ipv4.ipAddr,callback:function(t){e.$set(a.ipv4,"ipAddr",t)},expression:"d.ipv4.ipAddr"}})],1),t("el-form-item",{attrs:{prop:"gateway",label:e.$t("gateway")}},[t("el-input",{model:{value:a.ipv4.gateway,callback:function(t){e.$set(a.ipv4,"gateway",t)},expression:"d.ipv4.gateway"}})],1),t("el-form-item",{attrs:{prop:"netmask",label:e.$t("netmask")}},[t("el-input",{model:{value:a.ipv4.netmask,callback:function(t){e.$set(a.ipv4,"netmask",t)},expression:"d.ipv4.netmask"}})],1),t("el-form-item",{attrs:{prop:"vlanIds",label:e.$t("VLAN")}},[t("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:e.$t("pls_input_vlan")},on:{change:function(t){return e.changeInt(a)}},model:{value:a.ipv4.vlanIds,callback:function(t){e.$set(a.ipv4,"vlanIds",t)},expression:"d.ipv4.vlanIds"}},e._l(e.objs,(function(a){return t("el-option",{attrs:{label:e.$t(a.name),value:a.value}})})),1)],1)],1)],1)],1)})),1)],1),t("el-form-item",{attrs:{label:e.$t("DNS"),prop:"dnsServers"}},[t("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.payLoad.options.defaults.dnsServers,callback:function(t){e.$set(e.payLoad.options.defaults,"dnsServers",t)},expression:"payLoad.options.defaults.dnsServers"}})],1),t("el-form-item",{attrs:{label:e.$t("NTP"),prop:"ntp"}},[t("el-input",{model:{value:e.payLoad.options.defaults.ntp,callback:function(t){e.$set(e.payLoad.options.defaults,"ntp",t)},expression:"payLoad.options.defaults.ntp"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}}),t("el-col",{attrs:{span:12}})],1)],1),t("el-dialog",{attrs:{title:e.tip,visible:e.dialogVisible,"append-to-body":!0,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-input",{attrs:{type:"textarea",rows:"25",cols:"150"},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateScript()}}},[e._v(e._s(e.$t("confirm")))])],1)],1)],1)},s=[],l=a("b35c"),o=a("619f"),n=a("30d1");let r=a("2ef0");var d={activated(){},created(){},deactivated(){},data(){return{tip:null,dialogVisible:!1,content:null,scriptType:null,objs:[],nicActiveNames:"0",switchActiveNames:"switch0",rules:{hostname:[{validator:n["d"],trigger:"blur",vue:this}],dnsServers:[{validator:n["a"],trigger:"change",vue:this}],ntp:[{validator:n["a"],trigger:"blur",vue:this}],rootPassword:[{validator:n["j"],trigger:"blur",vue:this}],repo:[{validator:n["h"],trigger:"blur",vue:this,name:"image"}]},nicRules:{device:[{validator:n["i"],trigger:"blur",vue:this,name:"device"}],ipAddr:[{validator:n["e"],trigger:"blur",vue:this}],netmask:[{validator:n["e"],trigger:"blur",vue:this}],gateway:[{validator:n["e"],trigger:"blur",vue:this}],vlanIds:[{validator:n["k"],trigger:"change",vue:this,require:!1}]},uefi:!1,defaultPayLoad:{options:{defaults:{version:"bionic",osName:"ubuntu",repo:null,baseUrl:"install/netboot/ubuntu-installer/amd64",rootPassword:"RackHDRocks!",hostname:"rackhd-node",domain:"example.com",dnsServers:["172.12.88.91","192.168.20.77"],networkDevices:[{device:null,ipv4:{ipAddr:"192.168.1.29",gateway:"192.168.1.1",netmask:"255.255.255.0",vlanIds:[104,105]}}],kvm:!0,timezone:"UTC",ntp:"192.168.1.21",installDisk:"/dev/sda",installPartitions:[{mountPoint:"/",size:"auto",fsType:"ext3"},{mountPoint:"swap",size:"4096",fsType:"swap"},{mountPoint:"/boot",size:"4096",fsType:"ext3"}]}}},payLoad:this.$attrs.params,extraParams:this.$attrs.extraParams?JSON.parse(JSON.stringify(this.$attrs.extraParams)):{unit:"MB"},allImages:[],cpus:[],memories:[],disks:[],nics:[],units:["GB","MB"],fsType:["ext3","ext4","swap","xfs","biosboot"],validateResult:!1}},mounted(){this.getAllImage(),this.getHardware(),this.$watch("extraParams.unit",(function(e,t){if("GB"==t&&"MB"==e)for(var a=0;a<this.payLoad.options.defaults.installPartitions.length&&"biosboot"!=this.payLoad.options.defaults.installPartitions[a].mountPoint;a++)/\d+/.test(this.payLoad.options.defaults.installPartitions[a].size)&&(this.payLoad.options.defaults.installPartitions[a].size=1024*this.payLoad.options.defaults.installPartitions[a].size+"");else if("MB"==t&&"GB"==e)for(a=0;a<this.payLoad.options.defaults.installPartitions.length&&"biosboot"!=this.payLoad.options.defaults.installPartitions[a].mountPoint;a++)/\d+/.test(this.payLoad.options.defaults.installPartitions[a].size)&&(this.payLoad.options.defaults.installPartitions[a].size=parseInt(this.payLoad.options.defaults.installPartitions[a].size/1024)+"");this.extraParams.unit=e}))},methods:{updateScript(){let e=r.find(this.allImages,e=>e.url==this.payLoad.options.defaults.repo);if(null==e)return;let t={},a=null;"profile"==this.scriptType?(t={id:e.pid,name:e.pName,content:this.content},a="/profile/update"):(t={id:e.tid,name:e.tName,content:this.content},a="/template/update");let i=this;l["a"].put(a,t,e=>{e.data?i.getAllImage():this.$message.error(this.$t("opt_fail"))}),this.dialogVisible=!1},showContent(e){this.scriptType=e;let t=r.find(this.allImages,e=>e.url==this.payLoad.options.defaults.repo);"profile"==e?(this.tip=this.payLoad.options.defaults.profile,this.content=t.pContent):(this.tip=this.payLoad.options.defaults.installScript,this.content=t.tContent),this.dialogVisible=!0},changePT(e){let t=r.find(this.allImages,t=>t.url==e),a=!1;t.pName?(this.payLoad.options.defaults.profile=t.pName,a=!0):delete this.payLoad.options.defaults.profile,t.tName?(this.payLoad.options.defaults.installScript=t.tName,a=!0):delete this.payLoad.options.defaults.installScript,a&&this.$message.info(this.$t("not_support_validate"))},changeUefiBoot:function(){if(this.extraParams.uefi){if(this.payLoad.options.defaults.installPartitions){let e=r.findIndex(this.payLoad.options.defaults.installPartitions,(function(e){return"/boot/efi"==e.mountPoint}));-1==e&&this.payLoad.options.defaults.installPartitions.push({mountPoint:"/boot/efi",size:"200",fsType:"vfat"}),e=r.findIndex(this.payLoad.options.defaults.installPartitions,(function(e){return"biosboot"==e.mountPoint})),-1!==e&&this.payLoad.options.defaults.installPartitions.splice(e,1)}}else{let e=r.findIndex(this.payLoad.options.defaults.installPartitions,(function(e){return"/boot/efi"==e.mountPoint}));-1!=e&&this.payLoad.options.defaults.installPartitions.splice(e,1)}console.table(this.payLoad.options.defaults.installPartitions)},changeInt(e){let t=[];e.ipv4.vlanIds.forEach(e=>t.push(Number(e))),e.ipv4.vlanIds=t},getNetworkName(e){return e.device?this.$t("network_card_mac")+" "+e.device:this.$t("network_card_mac")},delNet(e){this.payLoad.options.defaults.networkDevices.length-1>0&&this.payLoad.options.defaults.networkDevices.splice(e,1)},addNet(){0!=this.nics.length?this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length==this.nics.length?this.$message.warning(this.$t("cannot_add_more")):this.payLoad.options.defaults.networkDevices.push({device:null,ipv4:{ipAddr:"192.168.1.10",gateway:"192.168.1.1",netmask:"255.255.255.0"}}):this.$message.warning(this.$t("nic_not_found"))},restoreParams:function(){this.restorePartition()},restorePartition:function(){this.payLoad=JSON.parse(JSON.stringify(this.defaultPayLoad)),this.getAllImage()},valid:function(){this.validateResult=!0;let e=this;if(this.$refs["form"].validate(t=>{t?(e.$refs["nicForm"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})}),e.$refs["nic2Form"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})})):e.validateResult=!1}),!e.validateResult)return void this.$message.error(this.$t("param_check_error"));let t=this.payLoad.options.defaults.hostname,a=this.payLoad.options.defaults.rootPassword,i=this.payLoad.options.defaults.networkDevices[0].device,s=this.payLoad.options.defaults.networkDevices[0].ipv4.ipAddr,l=this.payLoad.options.defaults.networkDevices[0].ipv4.gateway,n=this.payLoad.options.defaults.networkDevices[0].ipv4.netmask;if(Object(o["c"])(t,a,i,s,l,n))return this.$message.error(this.$t("param_cannot_be_null!")),!1;if(/[^0-9a-zA-Z\-]+/.test(t))return this.$message.error(this.$t("hostname_must_not_have_invalid_word!")),!1;let d=0;for(let o=0;o<this.payLoad.options.defaults.installPartitions.length;o++){let e=this.payLoad.options.defaults.installPartitions[o];e.mountPoint||(this.$message.error(this.$t("i18n_mount_point_cant_be_null")),this.validateResult=!1),e.size||(this.$message.error(this.$t("i18n_capacity_cant_be_null")),this.validateResult=!1),e.fsType||(this.$message.error(this.$t("i18n_file_type_cant_be_null")),this.validateResult=!1),"biosboot"!=e.mountPoint&&("GB"==this.unit&&e.size<1||"MB"==this.unit&&e.size<1024)&&(this.$message.error(this.$t("i18n_all_greater_than_1_gb")),this.validateResult=!1),e.size&&!/^[0-9]*$/.test(e.size)&&"auto"!=e.size&&(this.$message.error(this.$t("i18n_auto_or_number_0_or_1")),this.validateResult=!1),"auto"==e.size||/\d+/.test(e.size)||(this.$message.error(this.$t("i18n_must_be_auto_or_number")),this.validateResult=!1),"/"!=e.mountPoint&&"/boot"!=e.mountPoint&&"swap"!=e.mountPoint&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint||(d++,"swap"==e.mountPoint&&"swap"!=e.fsType&&(this.$message.error(this.$t("i18n_swap_must")),this.validateResult=!1),("GB"==this.unit&&e.size<1&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint||"MB"==this.unit&&e.size<1024&&"biosboot"!=e.mountPoint&&"/boot/efi"!=e.mountPoint)&&(this.$message.error(this.$t("i18n_must_be_root_swap_boot")),this.validateResult=!1))}if(3!=d)return this.$message.error(this.$t("i18n_mut_only_one")),void(this.validateResult=!1);if(this.payLoad.options.defaults.installPartitions.length<3)return this.$message.error(this.$t("i18n_must_be_root_swap_boot")),void(this.validateResult=!1);let c=[];if(this.payLoad.options.defaults.networkDevices&&this.payLoad.options.defaults.networkDevices.length>0)for(let o=0;o<this.payLoad.options.defaults.networkDevices.length;o++)this.payLoad.options.defaults.networkDevices[o].device&&c.push(this.payLoad.options.defaults.networkDevices[o].device),this.payLoad.options.defaults.networkDevices[o].ipv4.vlanIds&&0==this.payLoad.options.defaults.networkDevices[o].ipv4.vlanIds.length&&delete this.payLoad.options.defaults.networkDevices[o].ipv4.vlanIds;if(c=r.groupBy(c,(function(e){return e})),r.forEach(c,t=>{t.length>1&&(this.$message.error(this.$t("i18n_mac_dup")),e.validateResult=!1)}),this.payLoad.options.defaults.switchDevices&&this.payLoad.options.defaults.switchDevices.length>0){let t={},a={};r.forEach(this.payLoad.options.defaults.switchDevices,e=>t[e.switchName]?t[e.switchName]=t[e.switchName]+1:t[e.switchName]=1),Object.keys(t).forEach(a=>{if(t[a]>1)return e.$message.error(a+e.$t("multiple")),void(e.validateResult=!1)}),r.forEach(this.payLoad.options.defaults.switchDevices,e=>{r.forEach(e.uplinks,e=>a[e]?a[e]=a[e]+1:a[e]=1)}),Object.keys(a).forEach(t=>{if(a[t]>1)return e.$message.error(t+e.$t("multiple")),void(e.validateResult=!1)})}return this.payLoad.options.defaults.switchDevices&&this.payLoad.options.defaults.switchDevices.length>0&&0==r.filter(this.payLoad.options.defaults.switchDevices,e=>"vSwitch0"==e.switchName).length&&(this.$message.error(this.$t("i18n_at_least_sw0")),e.validateResult=!1),this.payLoad.options.defaults.dnsServers&&0==this.payLoad.options.defaults.dnsServers.length&&(this.$message.error(this.$t("i18n_at_least_dns")),e.validateResult=!1),this.payLoad.options.defaults.ntp&&0!==this.payLoad.options.defaults.ntp.length||(this.$message.error(this.$t("i18n_at_least_ntp")),e.validateResult=!1),this.payLoad.options.defaults.kargs="",this.validateResult},getAllImage:function(){l["a"].post("/image/allImage",{},e=>{if(this.allImages=r.filter(e.data,e=>"ubuntu"==e.os&&"18.04 Legacy"==e.osVersion),this.allImages&&this.allImages.length)if(this.payLoad.options.defaults.repo){let e=this,t=r.find(e.allImages,t=>t.url==e.payLoad.options.defaults.repo);t?(this.payLoad.options.defaults.repo=t.url,t.pName&&(this.payLoad.options.defaults.profile=t.pName),t.tName&&(this.payLoad.options.defaults.installScript=t.tName),(t.pName||t.tName)&&this.$message.info(this.$t("not_support_validate"))):this.payLoad.options.defaults.repo=null}else{let e=r.find(this.allImages,e=>"ubuntu"==e.os&&"18.04 Legacy"==e.osVersion);e?(this.payLoad.options.defaults.repo=e.url,e.pName&&(this.payLoad.options.defaults.profile=e.pName),e.tName&&(this.payLoad.options.defaults.installScript=e.tName)):this.$message.error(this.$t("no_valid_image!"))}else this.$message.error(this.$t("no_valid_image!"))})},getHardware(){l["a"].get("/bare-metal/hardwares/"+this.$attrs.bareMetalId,null,e=>{this.cpus=e.data.cpus,this.memories=e.data.memories,this.disks=e.data.disks,this.nics=e.data.nics,"em1"==this.payLoad.options.defaults.networkDevices[0].device&&this.nics.length>0&&(this.payLoad.options.defaults.networkDevices[0].device=this.nics[0].mac)})}}},c=d,u=a("2877"),p=Object(u["a"])(c,i,s,!1,null,null,null);t["default"]=p.exports},e16b:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("14d9"),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("b35c"),_obm_Obm__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("714f"),_switch_discovery_SwitchDiscovery__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("18de"),vue__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("2b0e"),_common_powerstatus_Power_Status__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("f439"),_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("30d1");let _=__webpack_require__("2ef0");__webpack_exports__["a"]={data(){return{switchPorts:[],currentVendor:null,showVendorVisible:!1,directCom:!0,ipmipwdLoading:!1,changeObm:!1,rules:{gateway:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_6__["e"],trigger:"blur",vue:this}],startIp:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_6__["e"],trigger:"blur",vue:this}],endIp:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_6__["e"],trigger:"blur",vue:this}],netmask:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_6__["f"],trigger:"blur",vue:this}],pwd:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_6__["j"],trigger:"blur",vue:this}],confirmPwd:[{validator:_common_validator_CommonValidator__WEBPACK_IMPORTED_MODULE_6__["j"],trigger:"blur",vue:this}]},fillOBMMode:"single",activeNames:"commonOs",batchParamsLoading:!1,allNicNumber:[],batchParams:!1,bp:{hostname:null,increase:null,baseNumber:null,rootPassword:null,startIp:null,endIp:null,gateway:null,netmask:null,nicNumber:null,domain:null,username:null,smbRepo:null},accurate:!1,groupedSupportedWorkflow:[],discoveryVisible:!1,fillWfParams:!1,executionLogDrawer:!1,activeName:"switch",logTitle:"",loadingLog:!1,currentMachine:{},form:{},logs:[],query:{address:"",name:"",pageIndex:1,pageSize:10},tableData:[],multipleSelection:[],delList:[],editVisible:!1,formLabelWidth:"160px",pageTotal:0,loading:!1,columns:[{label:"ip",prop:"ip"},{label:"name",prop:"name"},{label:"snmp_community",prop:"snmpCommunity"},{label:"snmp_port",prop:"snmpPort"}],detailDrawer:!1,actionDrawer:!1,editType:"edit",editObj:{name:null,id:null,email:null,phone:null,roles:[],rolesIds:[]},allGraphDefinitions:[],supportedWorkflow:[],wfRequest:{},workflowParamList:[],paramEditable:!1,selectedWorkflow:[],selectedWorkflowComponent:{},fillOutObms:!1,curObm:{ip:null,userName:null,pwd:null,bareMetalId:null},obmLoading:!1,fillWfParamsLoading:!1,machine:{},detailShowName:"portDetail",cpuLoading:!1,cpus:[],memories:[],disks:[],nics:[],paramComponent:{},currentWfParamTemplate:{},editWorkflowIndex:-1,queryVO:{searchKey:null},logPoller:null,currentParamConfig:"",loadingList:!1,websocket:null,websocketInterval:null}},components:{OBM:_obm_Obm__WEBPACK_IMPORTED_MODULE_2__["a"],Discovery:_switch_discovery_SwitchDiscovery__WEBPACK_IMPORTED_MODULE_3__["a"],PowerStatus:_common_powerstatus_Power_Status__WEBPACK_IMPORTED_MODULE_5__["a"]},computed:{},destroyed(){this.websocket&&this.websocket.close(),this.websocketInterval&&clearInterval(this.websocketInterval)},mounted(){this.getData()},methods:{queryByRuleId(e){e&&(this.queryVO.searchKey=e,this.getData())},openDiscover(){this.discoveryVisible=!0,this.$refs.discoveryCom&&this.$refs.discoveryCom.getData()},showVendor(e){this.showVendorVisible=!0,this.currentVendor=e},getSwitchPorts(e){_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("/switch/"+e+"/ports/",null,e=>{this.switchPorts=e.data})},showActivePorts(e){this.detailDrawer=!0,this.getSwitchPorts(e)},handleChange(e){},resizeWith(e){return e.expandLanguage&&e.expandLanguage==localStorage.getItem("lang")?"130px":"140px"},sortChange(e){e.order?this.queryVO.sort=e.prop+" "+e.order.replace("ending",""):delete this.queryVO.sort,this.getData()},getData(){this.loadingList=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/switch/list/"+this.query.pageIndex+"/"+this.query.pageSize,this.queryVO,e=>{this.tableData=e.data.listObject,this.pageTotal=e.data.itemCount,this.loadingList=!1})},handleSizeChange(e){this.query.pageSize=e,this.handlePageChange(this.query.pageIndex)},handleClose(){this.detailDrawer=!1,this.actionDrawer=!1,this.discoveryVisible=!1,this.showVendorVisible=!1},handleCloseExecutionLog(){this.executionLogDrawer=!1,window.clearInterval(this.logPoller)},cancelForm(){this.loading=!1,this.detailDrawer=!1},handleSelectionChange(e){this.multipleSelection=e},getSelectedIds:function(){this.delList=[].concat(this.multipleSelection);let e=_.map(this.delList,e=>e.id);return e},delAllSelection(){let e=this.getSelectedIds();e&&0!=e.length?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{this.loadingList=!0,_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/switch/del",e,e=>{e.success?(this.$message.success(this.$t("delete_success")),this.getData(),this.multipleSelection=[],this.loadingList=!1):this.$message.success(this.$t("delete_fail"))},e=>{this.$message.success(this.$t("delete_fail")),this.loadingList=!1})}):this.$message.error(this.$t("pls_select_")+this.$t("Bare Metal Server")+"!")},handleEdit(e,t){"edit"==t?(this.detailDrawer=!0,this.editType=t,this.editObj=JSON.parse(JSON.stringify(e)),this.editObj.rolesIds=_.map(this.editObj.roles,e=>e.id)):"del"==t?this.$confirm(this.$t("confirm_to_del"),this.$t("tips"),{type:"warning"}).then(()=>{_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/switch/del/"+e.id,{},e=>{this.getData(),this.$message.success(this.$t("delete_success!"))})}):(this.detailDrawer=!0,this.editType=t,this.editObj={})},handlePageChange(e){this.$set(this.query,"pageIndex",e),this.getData()},getAllGraphDefinitions(name){_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("/workflow/listall",{name:name},res=>{res.data&&res.data.length>0&&res.data.forEach(w=>{w.brands=eval(w.brands),w.settable=eval(w.settable),w.defaultParams&&(w.defaultParams=JSON.parse(w.defaultParams))}),this.supportedWorkflow=res.data,this.groupedSupportedWorkflow=this.groupWorkflow(res.data)})},groupWorkflow(e){let t=_.groupBy(e,"eventType"),a=[],i=this;return Object.keys(t).forEach(e=>{a.push({key:e,label:i.$t(e),items:t[e]})}),a},openRunWorkflow(){this.multipleSelection.length?this.actionDrawer=!0:this.$message.error(this.$t("pls_select_bare_metal")+"!")},runWorkflow(){if(!this.selectedWorkflow.length)return void this.$message.error(this.$t("pls_select_workflow")+"!");for(let a=0;a<this.selectedWorkflow.length;a++){let e=_.find(this.tableData,e=>e.id==this.selectedWorkflow[a].bareMetalId);if(!e.outBandList.length)return void this.$message.error(e.machineModel+""+e.machineSn+" "+this.$t("obm_not_exists")+"!")}let e=this,t=_.map(this.copy(this.selectedWorkflow),t=>e.buildRequest(t));0!=t.length?-1==_.findIndex(t,e=>e.settable&&!e.params)?_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].post("/workflow/run",t,e=>{e.success&&(this.selectedWorkflow=[],this.$notify({title:this.$t("server_message"),message:this.$t("workflow_submitted")}))}):this.$message.error(this.$t("pls_set_params")+"!"):this.$message.error(this.$t("pls_select_node")+"!")},getWorkflowById(){return _.find(this.supportedWorkflow,e=>e.id==this.wfRequest.workflow)},getParamsTemplate(){_common_utils_HttpUtil__WEBPACK_IMPORTED_MODULE_1__["a"].get("/workflow/params/"+this.getWorkflowById().injectableName,{},e=>{e.data[0]?this.workflowParamList=e.data:this.workflowParamList=[]})},createWorkflowParamComponent(e){if(!this.paramComponent[e.componentId]){const t=()=>({component:__webpack_require__("264c")("./"+e.workflowName),delay:200,timeout:3e3});let a=vue__WEBPACK_IMPORTED_MODULE_4__["default"].component(e.componentId,t);this.paramComponent[e.componentId]=a}},addToSelectedWorkflow(){let e=this;if(e.getWorkflowById().injectableName){let t=_.find(e.supportedWorkflow,t=>t.injectableName==e.getWorkflowById().injectableName);for(let a=0;a<e.multipleSelection.length;a++){if(!e.multipleSelection[a].serverId){e.$message.warning(e.multipleSelection[a].machineModel+" ["+e.multipleSelection[a].machineSn+"]"+e.$t("not_discoveryed"));continue}let i=!1,s=e.getWorkflowById().injectableName+"-"+e.multipleSelection[a].id;for(let t=0;t<e.selectedWorkflow.length;t++)e.selectedWorkflow[t].componentId==s&&(i=!0);if(i)continue;if(-1==_.findIndex(t.brands,t=>t==e.multipleSelection[a].machineBrand)){e.$message.error(t.friendlyName+e.$t("not_supported_brand!")+" "+e.multipleSelection[a].machineBrand);continue}let l={},o=null;if(e.workflowParamList.length){let i=_.find(e.workflowParamList,(function(t){return t.bareMetalId==e.multipleSelection[a].id}));null==i?l=_.cloneDeep(t.defaultParams):(l=JSON.parse(i.paramsTemplate),o=JSON.parse(i.extraParams))}else l=_.cloneDeep(t.defaultParams);e.selectedWorkflow.push({componentId:e.getWorkflowById().injectableName+"-"+e.multipleSelection[a].id,bareMetalId:e.multipleSelection[a].id,machineModel:e.multipleSelection[a].machineModel,machineSn:e.multipleSelection[a].machineSn,workflowName:e.getWorkflowById().injectableName,workflowId:e.getWorkflowById().id,friendlyName:t.friendlyName,friendlyNameInternational:this.$t(t.friendlyName),settable:t.settable,params:l,extraParams:o})}}},deleteSelectedWorkflow(e){this.editWorkflowIndex=e,this.selectedWorkflow.splice(e,1)}}}},e690:function(e,t,a){"use strict";a("3064")},e8de:function(e,t,a){"use strict";function i(e){let t={};if(e&&e.length)for(let a=0;a<e.length;a++)e[a].type?t[e[a].type]||(t[e[a].type]=1):t["unknown"]=1;return Object.keys(t).length>1}a.d(t,"a",(function(){return i}))},ed57:function(e,t,a){},edc7:function(e,t,a){},f196:function(e,t,a){"use strict";a("4bbf")},f395:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));let i=a("cc7d"),s=a("74d1"),l=function(){return{stompClient:null,openSocket:function(e,t){if(!sessionStorage.getItem("rsSocket")||""==sessionStorage.getItem("rsSocket")){let l=this,o=t;var a=new i("/rs-websocket");this.stompClient=s.over(a),this.stompClient.connect({},(function(t){try{l.stompClient.subscribe("/topic/"+e,(function(e){o&&o(e.body)}))}catch(a){console.log("订阅/topic/"+e+" 失败！"),sessionStorage.removeItem("rsSocket")}})),sessionStorage.setItem("rsSocket","exist")}return this.stompClient},close:function(){this.stompClient&&(this.stompClient.disconnect(),sessionStorage.removeItem("rsSocket"))},sendMessage:function(e){this.stompClient.send("/app/hello",{},e)}}}},f439:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",[t("span",[t("el-tooltip",{attrs:{content:e.$t("refresh")}},[t("el-link",{on:{click:e.refreshPower}},[t("span",{class:{green:"on"==e.status,red:"off"==e.status,grey:"unknown"==e.status}},[e._v(e._s(e.$t(e.status)))])])],1)],1),t("el-tooltip",{staticClass:"dark",attrs:{content:e.content}},["unknown"==e.status?t("i",{staticClass:"el-icon-question"}):e._e()])],1)},s=[],l=a("b35c"),o={props:["content","status","bareMetalId","callback"],methods:{refreshPower(){l["a"].get("/bare-metal/refreshPower/"+this.bareMetalId+"/",{},e=>{this.callback&&this.callback()},e=>{this.$message.error(e.message)})}}},n=o,r=(a("0765"),a("2877")),d=Object(r["a"])(n,i,s,!1,null,"37757584",null);t["a"]=d.exports},f7c7:function(e,t,a){"use strict";a("0404")},f83a:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"form",attrs:{"label-width":"130px",rules:e.rules,model:e.payLoad.options.defaults,"label-position":"right"}},[t("el-row",[t("el-col",{attrs:{span:11}},[t("el-form-item",{attrs:{label:e.$t("hostname"),prop:"hostname"}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"20"},model:{value:e.payLoad.options.defaults.hostname,callback:function(t){e.$set(e.payLoad.options.defaults,"hostname",t)},expression:"payLoad.options.defaults.hostname"}})],1),t("el-form-item",{attrs:{label:e.$t("domain"),prop:"domain"}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"20"},model:{value:e.payLoad.options.defaults.domain,callback:function(t){e.$set(e.payLoad.options.defaults,"domain",t)},expression:"payLoad.options.defaults.domain"}})],1),t("el-form-item",{attrs:{label:e.$t("username"),prop:"username"}},[t("el-input",{attrs:{autocomplete:"off","aria-required":"true",maxlength:"20"},model:{value:e.payLoad.options.defaults.username,callback:function(t){e.$set(e.payLoad.options.defaults,"username",t)},expression:"payLoad.options.defaults.username"}})],1),t("el-form-item",{attrs:{label:e.$t("root_pwd"),prop:"password"}},[t("el-input",{attrs:{autocomplete:"off","show-password":"",maxlength:"20"},model:{value:e.payLoad.options.defaults.password,callback:function(t){e.$set(e.payLoad.options.defaults,"password",t)},expression:"payLoad.options.defaults.password"}})],1),t("el-form-item",{attrs:{label:e.$t("samba"),prop:"smbRepo"}},[t("el-input",{attrs:{placeholder:"\\\\172.31.128.1\\windowsServer2012"},model:{value:e.payLoad.options.defaults.smbRepo,callback:function(t){e.$set(e.payLoad.options.defaults,"smbRepo",t)},expression:"payLoad.options.defaults.smbRepo"}})],1),t("el-form-item",{attrs:{label:e.$t("productkey"),prop:"productkey"}},[t("el-input",{attrs:{placeholder:"XXXX-XXXX-XXXX-XXXX-XXXX"},model:{value:e.payLoad.options.defaults.productkey,callback:function(t){e.$set(e.payLoad.options.defaults,"productkey",t)},expression:"payLoad.options.defaults.productkey"}})],1),t("el-form-item",{attrs:{label:e.$t("smb_user"),prop:"smbUser"}},[t("el-input",{model:{value:e.payLoad.options.defaults.smbUser,callback:function(t){e.$set(e.payLoad.options.defaults,"smbUser",t)},expression:"payLoad.options.defaults.smbUser"}})],1),t("el-form-item",{attrs:{label:e.$t("smb_password"),prop:"smbPassword"}},[t("el-input",{attrs:{"show-password":""},model:{value:e.payLoad.options.defaults.smbPassword,callback:function(t){e.$set(e.payLoad.options.defaults,"smbPassword",t)},expression:"payLoad.options.defaults.smbPassword"}})],1)],1),t("el-col",{attrs:{span:13}},e._l(e.payLoad.options.defaults.networkDevices,(function(a){return t("el-form",{ref:"nicForm",refInFor:!0,attrs:{model:a,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"device",label:e.$t("network_card_mac")}},[t("el-select",{staticClass:"input-element",model:{value:a.device,callback:function(t){e.$set(a,"device",t)},expression:"d.device"}},e._l(e.nics,(function(a){return t("el-option",{attrs:{value:a.mac}},[t("span",[e._v(" "+e._s(a.number+"("+a.mac+")")+" "),a.pxe?t("span",{staticStyle:{color:"red"}},[e._v(e._s(" "+e.$t("is_pxe")))]):e._e()])])})),1)],1),t("el-form",{ref:"nic2Form",refInFor:!0,attrs:{model:a.ipv4,rules:e.nicRules,"label-position":"right","label-width":"185px"}},[t("el-form-item",{attrs:{prop:"ipAddr",label:e.$t("ip_addr")}},[t("el-input",{model:{value:a.ipv4.ipAddr,callback:function(t){e.$set(a.ipv4,"ipAddr",t)},expression:"d.ipv4.ipAddr"}})],1),t("el-form-item",{attrs:{prop:"gateway",label:e.$t("gateway")}},[t("el-input",{model:{value:a.ipv4.gateway,callback:function(t){e.$set(a.ipv4,"gateway",t)},expression:"d.ipv4.gateway"}})],1),t("el-form-item",{attrs:{prop:"netmask",label:e.$t("netmask")}},[t("el-input",{model:{value:a.ipv4.netmask,callback:function(t){e.$set(a.ipv4,"netmask",t)},expression:"d.ipv4.netmask"}})],1)],1)],1)})),1)],1),t("el-row",[t("el-col",{attrs:{span:12}}),t("el-col",{attrs:{span:12}})],1)],1)],1)},s=[],l=a("b35c"),o=a("619f"),n=a("30d1");let r=a("2ef0");var d={activated(){},created(){},deactivated(){},data(){return{rules:{hostname:[{validator:n["d"],trigger:"blur",vue:this}],password:[{validator:n["j"],trigger:"blur",vue:this}],domain:[{validator:n["b"],trigger:"blur",vue:this}],username:[{validator:n["j"],trigger:"blur",vue:this}],smbRepo:[{validator:n["j"],trigger:"blur",vue:this}],productkey:[{validator:n["j"],trigger:"blur",vue:this}]},nicRules:{device:[{validator:n["i"],trigger:"blur",vue:this,name:"device"}],ipAddr:[{validator:n["e"],trigger:"blur",vue:this}],netmask:[{validator:n["e"],trigger:"blur",vue:this}],gateway:[{validator:n["e"],trigger:"blur",vue:this}]},uefi:!1,defaultPayLoad:{options:{defaults:{hostname:"localhost",domain:"rackhd",password:"RackHDRocks!",username:"onrack",firewallDisable:!0,networkDevices:[{device:null,ipv4:{ipAddr:"172.31.128.152",gateway:"172.31.128.5",netmask:"255.255.255.0"}}],productkey:null,smbUser:"onrack",smbPassword:"onrack",smbRepo:"\\\\172.31.128.1\\windowsServer2012",repo:null}}},payLoad:this.$attrs.params,extraParams:this.$attrs.extraParams?JSON.parse(JSON.stringify(this.$attrs.extraParams)):{unit:"MB"},allImages:[],cpus:[],memories:[],disks:[],nics:[],units:["GB","MB"],fsType:["ext3","ext4","swap","xfs","biosboot"],validateResult:!1}},mounted(){this.getHardware(),this.getWinpeURL()},methods:{restoreParams:function(){this.restorePartition()},restorePartition:function(){this.payLoad=JSON.parse(JSON.stringify(this.defaultPayLoad))},valid:function(){this.validateResult=!0;let e=this;if(this.$refs["form"].validate(t=>{t?(e.$refs["nicForm"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})}),e.$refs["nic2Form"].forEach(t=>{t.validate(t=>{t||(e.validateResult=!1)})})):e.validateResult=!1}),!e.validateResult)return void this.$message.error(this.$t("param_check_error"));let t=this.payLoad.options.defaults.hostname,a=this.payLoad.options.defaults.password,i=this.payLoad.options.defaults.networkDevices[0].device,s=this.payLoad.options.defaults.networkDevices[0].ipv4.ipAddr,l=this.payLoad.options.defaults.networkDevices[0].ipv4.gateway,n=this.payLoad.options.defaults.networkDevices[0].ipv4.netmask;return Object(o["c"])(t,a,i,s,l,n)?(this.$message.error(this.$t("param_cannot_be_null!")),!1):/[^0-9a-zA-Z\-]+/.test(t)?(this.$message.error(this.$t("hostname_must_not_have_invalid_word!")),!1):this.validateResult},getAllImage:function(){l["a"].post("/image/allImage",{},e=>{if(this.allImages=r.filter(e.data,e=>"windows_server"==e.os),this.allImages&&this.allImages.length){if(!this.payLoad.options.defaults.repo){let e=r.find(this.allImages,e=>"windows_server"==e.os);e?this.payLoad.options.defaults.repo=e.url:this.$message.error(this.$t("no_valid_image!"))}}else this.$message.error(this.$t("no_valid_image!"))})},getHardware(){l["a"].get("/bare-metal/hardwares/"+this.$attrs.bareMetalId,null,e=>{this.cpus=e.data.cpus,this.memories=e.data.memories,this.disks=e.data.disks,this.nics=e.data.nics,this.nics&&this.nics.length&&r.map(this.nics,(function(e){return e.mac.replace(":","-")})),"em1"==this.payLoad.options.defaults.networkDevices[0].device&&this.nics.length>0&&(this.payLoad.options.defaults.networkDevices[0].device=this.nics[0].mac)})},getWinpeURL(){let e=this;l["a"].get("/api/current/winpeURL",null,t=>{e.payLoad.options.defaults.repo=t.data})}}},c=d,u=a("2877"),p=Object(u["a"])(c,i,s,!1,null,null,null);t["default"]=p.exports},fb1d:function(e,t,a){"use strict";a("0c4f")}});
//# sourceMappingURL=index.ffe1f70d.js.map